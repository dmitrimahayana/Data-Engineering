

============================== 20:04:24.662956 | a905a5af-cae1-4b0b-8d1f-ff732cd9203f ==============================
[0m20:04:24.662956 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:04:24.668524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:04:24.809159 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:04:24.819190 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:04:24.822208 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:04:25.831201 [info ] [MainThread]: Found 11 models, 1 snapshot, 13 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:04:25.834740 [info ] [MainThread]: 
[0m20:04:25.835703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:25.839742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:04:25.851227 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:04:25.852228 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:04:25.852228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:25.895227 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:04:25.897225 [debug] [ThreadPool]: On list_my_database: Close
[0m20:04:25.899229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now create_my_database_publicx)
[0m20:04:25.901225 [debug] [ThreadPool]: Creating schema "database: "my_database"
schema: "publicx"
"
[0m20:04:25.906265 [debug] [ThreadPool]: Using postgres connection "create_my_database_publicx"
[0m20:04:25.907269 [debug] [ThreadPool]: On create_my_database_publicx: BEGIN
[0m20:04:25.907269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:25.930741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:25.931709 [debug] [ThreadPool]: Using postgres connection "create_my_database_publicx"
[0m20:04:25.931709 [debug] [ThreadPool]: On create_my_database_publicx: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_my_database_publicx"} */
create schema if not exists "publicx"
[0m20:04:25.935226 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:04:25.937241 [debug] [ThreadPool]: On create_my_database_publicx: COMMIT
[0m20:04:25.937241 [debug] [ThreadPool]: Using postgres connection "create_my_database_publicx"
[0m20:04:25.938241 [debug] [ThreadPool]: On create_my_database_publicx: COMMIT
[0m20:04:25.943252 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:04:25.944254 [debug] [ThreadPool]: On create_my_database_publicx: Close
[0m20:04:25.950248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_publicx'
[0m20:04:25.957241 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:04:25.958241 [debug] [ThreadPool]: On list_my_database_publicx: BEGIN
[0m20:04:25.959241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:25.981079 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:25.982064 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:04:25.982064 [debug] [ThreadPool]: On list_my_database_publicx: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_publicx"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'publicx'
  
[0m20:04:25.987065 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:04:25.988100 [debug] [ThreadPool]: On list_my_database_publicx: ROLLBACK
[0m20:04:25.990065 [debug] [ThreadPool]: On list_my_database_publicx: Close
[0m20:04:25.992071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_publicx, now list_public_snapshots)
[0m20:04:25.996090 [debug] [ThreadPool]: Using postgres connection "list_public_snapshots"
[0m20:04:25.996090 [debug] [ThreadPool]: On list_public_snapshots: BEGIN
[0m20:04:25.997095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:26.018246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:26.019278 [debug] [ThreadPool]: Using postgres connection "list_public_snapshots"
[0m20:04:26.020253 [debug] [ThreadPool]: On list_public_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_public_snapshots"} */
select
      'public' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'public' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'public' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:04:26.024250 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:04:26.025292 [debug] [ThreadPool]: On list_public_snapshots: ROLLBACK
[0m20:04:26.027400 [debug] [ThreadPool]: On list_public_snapshots: Close
[0m20:04:26.030408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:26.031464 [debug] [MainThread]: Connection 'create_my_database_publicx' was properly closed.
[0m20:04:26.032407 [debug] [MainThread]: Connection 'list_public_snapshots' was properly closed.
[0m20:04:26.033410 [info ] [MainThread]: 
[0m20:04:26.033945 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:04:26.034951 [error] [MainThread]: Encountered an error:
ERROR: Cross-db references not allowed in postgres (public vs my_database)
[0m20:04:26.035989 [debug] [MainThread]: Command `dbt run` failed at 20:04:26.035989 after 1.42 seconds
[0m20:04:26.036957 [debug] [MainThread]: Flushing usage events


============================== 20:06:13.111864 | 5c5dc27f-cf36-4669-aec1-29978a497651 ==============================
[0m20:06:13.111864 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:06:13.116854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:06:13.278430 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:06:13.292430 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:06:13.469267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:06:13.471266 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\src_eltool.yml
[0m20:06:13.472268 [debug] [MainThread]: Partial parsing: updated file: dbt_project://snapshots\customers.sql
[0m20:06:13.774855 [info ] [MainThread]: Found 11 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:06:13.777856 [info ] [MainThread]: 
[0m20:06:13.778364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:13.782391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:06:13.794409 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:06:13.794409 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:06:13.795410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:13.831019 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:06:13.833016 [debug] [ThreadPool]: On list_my_database: Close
[0m20:06:13.837016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_publicx'
[0m20:06:13.844072 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:06:13.844072 [debug] [ThreadPool]: On list_my_database_publicx: BEGIN
[0m20:06:13.845038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:13.869180 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:13.870219 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:06:13.871198 [debug] [ThreadPool]: On list_my_database_publicx: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_publicx"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'publicx'
  
[0m20:06:13.876188 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:13.878210 [debug] [ThreadPool]: On list_my_database_publicx: ROLLBACK
[0m20:06:13.881177 [debug] [ThreadPool]: On list_my_database_publicx: Close
[0m20:06:13.883184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_publicx, now list_my_database_snapshots)
[0m20:06:13.886209 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:06:13.887214 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:06:13.887214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:13.908667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:13.909716 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:06:13.909716 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:06:13.914253 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:13.915265 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:06:13.917265 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:06:13.923299 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.924298 [debug] [MainThread]: On master: BEGIN
[0m20:06:13.925268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:13.945679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:13.946679 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.947678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:06:13.955684 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:13.957680 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:13.959466 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.960482 [debug] [MainThread]: On master: BEGIN
[0m20:06:13.963538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:13.963538 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.964576 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.964576 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.966562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:13.967577 [debug] [MainThread]: On master: Close
[0m20:06:13.968547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:13.970574 [info ] [MainThread]: 
[0m20:06:13.978548 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:06:13.979549 [info ] [Thread-1 (]: 1 of 11 START sql view model publicx.stg_eltool__company ....................... [RUN]
[0m20:06:13.980550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:06:13.981549 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:06:13.991555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:06:14.001553 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:06:13.981549 => 20:06:14.000570
[0m20:06:14.002550 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:06:14.051481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:06:14.058988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:14.060999 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:06:14.061995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:06:14.092981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.094014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:14.094979 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."publicx"."stg_eltool__company__dbt_tmp"
    
    
  as (
    -- with source as (select *
--                 from "my_database"."public"."ksql-company-stream"),
--      renamed as (select id,
--                         ticker,
--                         name,
--                         logo
--                  from source)
-- select *
-- from renamed
  );
[0m20:06:14.098001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 16:   );
           ^

[0m20:06:14.100011 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: ROLLBACK
[0m20:06:14.103001 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:06:14.002550 => 20:06:14.103001
[0m20:06:14.103882 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:06:14.161116 [debug] [Thread-1 (]: Database Error in model stg_eltool__company (models\staging\stg_eltool__company.sql)
  syntax error at or near ")"
  LINE 16:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__company.sql
[0m20:06:14.162080 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model publicx.stg_eltool__company .............. [[31mERROR[0m in 0.18s]
[0m20:06:14.164079 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:06:14.165119 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:06:14.166087 [info ] [Thread-1 (]: 2 of 11 START sql view model publicx.stg_eltool__customers ..................... [RUN]
[0m20:06:14.169077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:06:14.170079 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:06:14.174082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:06:14.180077 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:06:14.171085 => 20:06:14.179137
[0m20:06:14.181101 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:06:14.188077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:06:14.194076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:14.196084 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:06:14.197079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.231161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.233177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:14.234162 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."publicx"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    -- with source as (select *
--                 from "my_database"."public"."customers"),
--      renamed as (select
--                      customer_id,
--                     'This is Dummy' as dummy
--                  from source
--                  where customer_id = 1234567890)
-- select *
-- from renamed
  );
[0m20:06:14.239182 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 16:   );
           ^

[0m20:06:14.240166 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: ROLLBACK
[0m20:06:14.244215 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:06:14.181101 => 20:06:14.243159
[0m20:06:14.245223 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:06:14.252222 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)
  syntax error at or near ")"
  LINE 16:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers.sql
[0m20:06:14.253251 [error] [Thread-1 (]: 2 of 11 ERROR creating sql view model publicx.stg_eltool__customers ............ [[31mERROR[0m in 0.09s]
[0m20:06:14.255223 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:06:14.256227 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:14.258224 [info ] [Thread-1 (]: 3 of 11 START sql view model publicx.stg_eltool__customers_snapshots ........... [RUN]
[0m20:06:14.260739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:06:14.261739 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:14.264739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:14.270751 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:06:14.261739 => 20:06:14.270751
[0m20:06:14.272745 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:14.280085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:14.287317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:14.288844 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:06:14.289871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.322810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.323809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:14.324808 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."publicx"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    -- with source as (select *
--                 from "my_database"."snapshots"."customers_snapshot"),
--      renamed as (select customer_id,
--                         zipcode,
--                         city,
--                         state_code,
--                         datetime_created::TIMESTAMP AS datetime_created,
--                         datetime_updated::TIMESTAMP AS datetime_updated,
--                         dbt_valid_from,
--                         dbt_valid_to
--                  from source)
-- select *
-- from renamed
  );
[0m20:06:14.327808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 20:   );
           ^

[0m20:06:14.328842 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: ROLLBACK
[0m20:06:14.331805 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:06:14.273742 => 20:06:14.331805
[0m20:06:14.333805 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:06:14.342853 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)
  syntax error at or near ")"
  LINE 20:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:06:14.344902 [error] [Thread-1 (]: 3 of 11 ERROR creating sql view model publicx.stg_eltool__customers_snapshots .. [[31mERROR[0m in 0.08s]
[0m20:06:14.345851 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:14.347851 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:06:14.348853 [info ] [Thread-1 (]: 4 of 11 START sql view model publicx.stg_eltool__orders ........................ [RUN]
[0m20:06:14.351859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:06:14.353603 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:06:14.357241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:06:14.369579 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:06:14.353603 => 20:06:14.368566
[0m20:06:14.371569 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:06:14.380566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:06:14.401597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:14.403864 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:06:14.404869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.428101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.429106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:14.429106 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."publicx"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    -- with source as (select *
--                 from "my_database"."public"."orders"),
--      renamed as (select order_id,
--                         cust_id AS customer_id,
--                         order_status,
--                         order_purchase_timestamp::TIMESTAMP,
--                         order_approved_at::TIMESTAMP,
--                         order_delivered_carrier_date::TIMESTAMP,
--                         order_delivered_customer_date::TIMESTAMP,
--                         order_estimated_delivery_date::TIMESTAMP
--                  from source)
-- select *
-- from renamed
  );
[0m20:06:14.432104 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 20:   );
           ^

[0m20:06:14.433122 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: ROLLBACK
[0m20:06:14.435116 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:06:14.372566 => 20:06:14.435116
[0m20:06:14.436101 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:06:14.441137 [debug] [Thread-1 (]: Database Error in model stg_eltool__orders (models\staging\stg_eltool__orders.sql)
  syntax error at or near ")"
  LINE 20:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__orders.sql
[0m20:06:14.442106 [error] [Thread-1 (]: 4 of 11 ERROR creating sql view model publicx.stg_eltool__orders ............... [[31mERROR[0m in 0.09s]
[0m20:06:14.443102 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:06:14.444101 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:06:14.445111 [info ] [Thread-1 (]: 5 of 11 START sql view model publicx.stg_eltool__state ......................... [RUN]
[0m20:06:14.446108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:06:14.447144 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:06:14.450144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:06:14.454142 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:06:14.448164 => 20:06:14.454142
[0m20:06:14.455143 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:06:14.460634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:06:14.464626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:06:14.465658 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:06:14.466624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.487630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.488644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:06:14.489625 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."publicx"."stg_eltool__state__dbt_tmp"
    
    
  as (
    -- with source as (select *
--                 from "my_database"."public"."state"),
--      renamed as (select state_identifier::INT AS state_id,
--                          state_code::VARCHAR(2) AS state_code,
--                          st_name::VARCHAR(30) AS state_name
--                  from source)
-- select *
-- from renamed
  );
[0m20:06:14.492080 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 15:   );
           ^

[0m20:06:14.493071 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: ROLLBACK
[0m20:06:14.495069 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:06:14.456110 => 20:06:14.495069
[0m20:06:14.496067 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:06:14.501066 [debug] [Thread-1 (]: Database Error in model stg_eltool__state (models\staging\stg_eltool__state.sql)
  syntax error at or near ")"
  LINE 15:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__state.sql
[0m20:06:14.503068 [error] [Thread-1 (]: 5 of 11 ERROR creating sql view model publicx.stg_eltool__state ................ [[31mERROR[0m in 0.06s]
[0m20:06:14.504064 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:06:14.505070 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:06:14.506066 [info ] [Thread-1 (]: 6 of 11 START sql view model publicx.stg_eltool__stock ......................... [RUN]
[0m20:06:14.507065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:06:14.508067 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:06:14.512102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:06:14.515503 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:06:14.509110 => 20:06:14.515503
[0m20:06:14.516535 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:06:14.522499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:06:14.527513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:06:14.528501 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:06:14.529502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.552506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.553506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:06:14.553506 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."publicx"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    -- with source as (select DISTINCT *
--                 from "my_database"."public"."ksql-stock-stream"),
--      renamed as (select *
--                  from source)
-- select *
-- from renamed
  );
[0m20:06:14.556187 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 13:   );
           ^

[0m20:06:14.557186 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: ROLLBACK
[0m20:06:14.559741 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:06:14.517503 => 20:06:14.559741
[0m20:06:14.560785 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:06:14.566750 [debug] [Thread-1 (]: Database Error in model stg_eltool__stock (models\staging\stg_eltool__stock.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__stock.sql
[0m20:06:14.567765 [error] [Thread-1 (]: 6 of 11 ERROR creating sql view model publicx.stg_eltool__stock ................ [[31mERROR[0m in 0.06s]
[0m20:06:14.568799 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:06:14.569782 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:06:14.570800 [info ] [Thread-1 (]: 7 of 11 SKIP relation publicx.fact_orders ...................................... [[33mSKIP[0m]
[0m20:06:14.571756 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:06:14.572782 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:06:14.573787 [info ] [Thread-1 (]: 8 of 11 SKIP relation publicx.dim_customers .................................... [[33mSKIP[0m]
[0m20:06:14.574715 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:06:14.575760 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:06:14.576797 [info ] [Thread-1 (]: 9 of 11 SKIP relation publicx.fact_stocks ...................................... [[33mSKIP[0m]
[0m20:06:14.577725 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:06:14.579768 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:06:14.579768 [info ] [Thread-1 (]: 10 of 11 SKIP relation publicx.customer_orders_status .......................... [[33mSKIP[0m]
[0m20:06:14.581728 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:06:14.582742 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:06:14.583727 [info ] [Thread-1 (]: 11 of 11 SKIP relation publicx.stock_update_status ............................. [[33mSKIP[0m]
[0m20:06:14.584799 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:06:14.586753 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:14.587761 [debug] [MainThread]: On master: BEGIN
[0m20:06:14.588797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:14.613374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:14.614375 [debug] [MainThread]: On master: COMMIT
[0m20:06:14.615396 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:14.616381 [debug] [MainThread]: On master: COMMIT
[0m20:06:14.618601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:14.619633 [debug] [MainThread]: On master: Close
[0m20:06:14.621609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:14.622618 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:06:14.623630 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:06:14.625618 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__stock' was properly closed.
[0m20:06:14.626606 [info ] [MainThread]: 
[0m20:06:14.627613 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m20:06:14.630597 [debug] [MainThread]: Command end result
[0m20:06:14.658301 [info ] [MainThread]: 
[0m20:06:14.660818 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m20:06:14.661820 [info ] [MainThread]: 
[0m20:06:14.662823 [error] [MainThread]: [33mDatabase Error in model stg_eltool__company (models\staging\stg_eltool__company.sql)[0m
[0m20:06:14.664822 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.665824 [error] [MainThread]:   LINE 16:   );
[0m20:06:14.666835 [error] [MainThread]:              ^
[0m20:06:14.668822 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__company.sql
[0m20:06:14.669817 [info ] [MainThread]: 
[0m20:06:14.670821 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)[0m
[0m20:06:14.672824 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.674838 [error] [MainThread]:   LINE 16:   );
[0m20:06:14.676838 [error] [MainThread]:              ^
[0m20:06:14.678817 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers.sql
[0m20:06:14.679830 [info ] [MainThread]: 
[0m20:06:14.680825 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)[0m
[0m20:06:14.681851 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.682739 [error] [MainThread]:   LINE 20:   );
[0m20:06:14.684753 [error] [MainThread]:              ^
[0m20:06:14.685280 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:06:14.686294 [info ] [MainThread]: 
[0m20:06:14.688315 [error] [MainThread]: [33mDatabase Error in model stg_eltool__orders (models\staging\stg_eltool__orders.sql)[0m
[0m20:06:14.689293 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.691294 [error] [MainThread]:   LINE 20:   );
[0m20:06:14.692295 [error] [MainThread]:              ^
[0m20:06:14.693295 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__orders.sql
[0m20:06:14.695292 [info ] [MainThread]: 
[0m20:06:14.696292 [error] [MainThread]: [33mDatabase Error in model stg_eltool__state (models\staging\stg_eltool__state.sql)[0m
[0m20:06:14.697293 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.698299 [error] [MainThread]:   LINE 15:   );
[0m20:06:14.699293 [error] [MainThread]:              ^
[0m20:06:14.700297 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__state.sql
[0m20:06:14.701291 [info ] [MainThread]: 
[0m20:06:14.703297 [error] [MainThread]: [33mDatabase Error in model stg_eltool__stock (models\staging\stg_eltool__stock.sql)[0m
[0m20:06:14.704296 [error] [MainThread]:   syntax error at or near ")"
[0m20:06:14.705296 [error] [MainThread]:   LINE 13:   );
[0m20:06:14.706289 [error] [MainThread]:              ^
[0m20:06:14.708783 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__stock.sql
[0m20:06:14.709776 [info ] [MainThread]: 
[0m20:06:14.710789 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=5 TOTAL=11
[0m20:06:14.711769 [debug] [MainThread]: Command `dbt run` failed at 20:06:14.711769 after 1.64 seconds
[0m20:06:14.712770 [debug] [MainThread]: Flushing usage events


============================== 20:06:58.131309 | 781c873b-c7bc-4445-831e-04559539aed2 ==============================
[0m20:06:58.131309 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:06:58.141833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:06:58.409331 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:06:58.437765 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:06:58.790582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m20:06:58.793578 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool.yml
[0m20:06:58.795577 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__orders.sql
[0m20:06:58.797582 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__stock.sql
[0m20:06:58.801123 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__company.sql
[0m20:06:58.804103 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__customers_snapshots.sql
[0m20:06:58.806107 [debug] [MainThread]: Partial parsing: updated file: dbt_project://tests\assert_customer_dimension_has_no_row_loss.sql
[0m20:06:58.807622 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__state.sql
[0m20:06:58.809638 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_eltool__customers.sql
[0m20:06:59.107473 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:06:59.110492 [info ] [MainThread]: 
[0m20:06:59.112579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:59.116492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:06:59.134607 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:06:59.135620 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:06:59.137613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:59.178651 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:06:59.180645 [debug] [ThreadPool]: On list_my_database: Close
[0m20:06:59.186681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_publicx'
[0m20:06:59.197691 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:06:59.200223 [debug] [ThreadPool]: On list_my_database_publicx: BEGIN
[0m20:06:59.201228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:59.225817 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.226330 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:06:59.227347 [debug] [ThreadPool]: On list_my_database_publicx: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_publicx"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'publicx'
  
[0m20:06:59.233346 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:59.235340 [debug] [ThreadPool]: On list_my_database_publicx: ROLLBACK
[0m20:06:59.237457 [debug] [ThreadPool]: On list_my_database_publicx: Close
[0m20:06:59.240456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_publicx, now list_my_database_snapshots)
[0m20:06:59.244964 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:06:59.244964 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:06:59.245973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:59.269734 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.271714 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:06:59.273223 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:06:59.278900 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:59.281755 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:06:59.283756 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:06:59.293816 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:59.293816 [debug] [MainThread]: On master: BEGIN
[0m20:06:59.295384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:59.319427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.320423 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:59.321427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:06:59.327733 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:59.329525 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:59.333104 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:59.334108 [debug] [MainThread]: On master: BEGIN
[0m20:06:59.337107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.338106 [debug] [MainThread]: On master: COMMIT
[0m20:06:59.339106 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:59.340109 [debug] [MainThread]: On master: COMMIT
[0m20:06:59.342107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:59.342107 [debug] [MainThread]: On master: Close
[0m20:06:59.344628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:59.345631 [info ] [MainThread]: 
[0m20:06:59.350622 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:06:59.352674 [info ] [Thread-1 (]: 1 of 11 START sql view model publicx.stg_eltool__company ....................... [RUN]
[0m20:06:59.353676 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:06:59.354674 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:06:59.367127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:06:59.380192 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:06:59.355674 => 20:06:59.380192
[0m20:06:59.382192 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:06:59.455605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:06:59.463126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:59.464127 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:06:59.465127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:06:59.494392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.495389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:59.495389 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."publicx"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:06:59.508021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:06:59.520567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:59.522105 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."publicx"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:06:59.526117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:59.550024 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:06:59.551027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:59.551027 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:06:59.556022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:59.574066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:06:59.576590 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."publicx"."stg_eltool__company__dbt_backup" cascade
[0m20:06:59.580594 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:06:59.584111 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:06:59.383193 => 20:06:59.584111
[0m20:06:59.585121 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:06:59.587906 [info ] [Thread-1 (]: 1 of 11 OK created sql view model publicx.stg_eltool__company .................. [[32mCREATE VIEW[0m in 0.23s]
[0m20:06:59.590904 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:06:59.592907 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:06:59.593908 [info ] [Thread-1 (]: 2 of 11 START sql view model publicx.stg_eltool__customers ..................... [RUN]
[0m20:06:59.594903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:06:59.596414 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:06:59.600955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:06:59.609476 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:06:59.597422 => 20:06:59.609476
[0m20:06:59.610474 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:06:59.617659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:06:59.625440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:59.626449 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:06:59.627450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:59.679669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.680678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:59.682681 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."publicx"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:06:59.691194 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:06:59.701239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:59.702251 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."publicx"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:06:59.708248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:59.713770 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:06:59.714770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:59.716772 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:06:59.723825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:59.730828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:06:59.732833 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."publicx"."stg_eltool__customers__dbt_backup" cascade
[0m20:06:59.735828 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:06:59.739362 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:06:59.611477 => 20:06:59.738364
[0m20:06:59.739362 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:06:59.742894 [info ] [Thread-1 (]: 2 of 11 OK created sql view model publicx.stg_eltool__customers ................ [[32mCREATE VIEW[0m in 0.15s]
[0m20:06:59.745895 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:06:59.746892 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:59.748890 [info ] [Thread-1 (]: 3 of 11 START sql view model publicx.stg_eltool__customers_snapshots ........... [RUN]
[0m20:06:59.750894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:06:59.751896 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:59.755893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:59.763949 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:06:59.752893 => 20:06:59.763949
[0m20:06:59.764948 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:59.772632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:59.780602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:59.781601 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:06:59.783226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:59.810714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.812224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:06:59.813231 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."publicx"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:06:59.816239 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "snapshots.customers_snapshot" does not exist
LINE 8:                 from "my_database"."snapshots"."customers_sn...
                             ^

[0m20:06:59.817367 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: ROLLBACK
[0m20:06:59.820367 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:06:59.765948 => 20:06:59.819369
[0m20:06:59.821369 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:06:59.837591 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)
  relation "snapshots.customers_snapshot" does not exist
  LINE 8:                 from "my_database"."snapshots"."customers_sn...
                               ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:06:59.839603 [error] [Thread-1 (]: 3 of 11 ERROR creating sql view model publicx.stg_eltool__customers_snapshots .. [[31mERROR[0m in 0.09s]
[0m20:06:59.841600 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:06:59.843600 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:06:59.845601 [info ] [Thread-1 (]: 4 of 11 START sql view model publicx.stg_eltool__orders ........................ [RUN]
[0m20:06:59.848601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:06:59.849601 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:06:59.853905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:06:59.870958 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:06:59.850600 => 20:06:59.869982
[0m20:06:59.872377 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:06:59.885375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:06:59.903472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:59.904481 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:06:59.905488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:59.936748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:59.938752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:59.939753 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."publicx"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:06:59.946089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:06:59.951161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:59.953178 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."publicx"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:06:59.956167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:59.960170 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:06:59.960678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:59.961689 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:06:59.966202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:59.974731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:06:59.976730 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."publicx"."stg_eltool__orders__dbt_backup" cascade
[0m20:06:59.978737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:06:59.982781 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:06:59.874373 => 20:06:59.981769
[0m20:06:59.983777 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:06:59.985787 [info ] [Thread-1 (]: 4 of 11 OK created sql view model publicx.stg_eltool__orders ................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:06:59.988789 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:06:59.989785 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:06:59.991783 [info ] [Thread-1 (]: 5 of 11 START sql view model publicx.stg_eltool__state ......................... [RUN]
[0m20:06:59.993785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:06:59.993785 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:06:59.998788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:07:00.005820 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:06:59.994785 => 20:07:00.004822
[0m20:07:00.006820 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:07:00.011820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:07:00.026871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:07:00.027869 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:07:00.029989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:00.086977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:00.087974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:07:00.088974 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."publicx"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:07:00.094496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:07:00.105552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:07:00.106548 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."publicx"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:07:00.110059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:07:00.115074 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:07:00.117077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:07:00.119629 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:07:00.124737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:07:00.132703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:07:00.133705 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."publicx"."stg_eltool__state__dbt_backup" cascade
[0m20:07:00.136705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:07:00.141230 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:07:00.006820 => 20:07:00.141230
[0m20:07:00.143234 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:07:00.146229 [info ] [Thread-1 (]: 5 of 11 OK created sql view model publicx.stg_eltool__state .................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:07:00.148775 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:07:00.150775 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:07:00.152780 [info ] [Thread-1 (]: 6 of 11 START sql view model publicx.stg_eltool__stock ......................... [RUN]
[0m20:07:00.154776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:07:00.155778 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:07:00.163318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:07:00.173835 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:07:00.155778 => 20:07:00.172834
[0m20:07:00.176359 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:07:00.186382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:07:00.194422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:07:00.195433 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:07:00.196432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:00.225329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:00.226327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:07:00.227347 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."publicx"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:07:00.233025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:07:00.240069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:07:00.241068 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."publicx"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:07:00.244066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:07:00.248450 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:07:00.249454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:07:00.250545 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:07:00.254454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:07:00.263977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:07:00.266486 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."publicx"."stg_eltool__stock__dbt_backup" cascade
[0m20:07:00.269981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:07:00.273497 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:07:00.177373 => 20:07:00.273497
[0m20:07:00.275501 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:07:00.278494 [info ] [Thread-1 (]: 6 of 11 OK created sql view model publicx.stg_eltool__stock .................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:07:00.282019 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:07:00.284020 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:07:00.286540 [info ] [Thread-1 (]: 7 of 11 START sql view model publicx.fact_orders ............................... [RUN]
[0m20:07:00.289541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:07:00.290541 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:07:00.299087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:07:00.307142 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:07:00.292541 => 20:07:00.306627
[0m20:07:00.310154 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:07:00.326694 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:07:00.334637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:07:00.336633 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:07:00.338141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:00.366755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:00.367755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:07:00.368753 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."publicx"."fact_orders__dbt_tmp"
    
    
  as (
    -- with orders as (
--     select *
--     from "my_database"."publicx"."stg_eltool__orders"
-- )
-- select * from orders
  );
[0m20:07:00.372753 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 12:   );
           ^

[0m20:07:00.374756 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: ROLLBACK
[0m20:07:00.379288 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:07:00.312154 => 20:07:00.378271
[0m20:07:00.380802 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:07:00.389806 [debug] [Thread-1 (]: Database Error in model fact_orders (models\marts\core\fact_orders.sql)
  syntax error at or near ")"
  LINE 12:   );
             ^
  compiled Code at target\run\dbt_project\models\marts\core\fact_orders.sql
[0m20:07:00.391810 [error] [Thread-1 (]: 7 of 11 ERROR creating sql view model publicx.fact_orders ...................... [[31mERROR[0m in 0.10s]
[0m20:07:00.395807 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:07:00.397329 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:07:00.399328 [info ] [Thread-1 (]: 8 of 11 SKIP relation publicx.dim_customers .................................... [[33mSKIP[0m]
[0m20:07:00.401487 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:07:00.403498 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:07:00.404496 [info ] [Thread-1 (]: 9 of 11 START sql view model publicx.fact_stocks ............................... [RUN]
[0m20:07:00.407497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.fact_stocks)
[0m20:07:00.408498 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:07:00.413501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:07:00.419536 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:07:00.409495 => 20:07:00.418535
[0m20:07:00.421534 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:07:00.432536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:07:00.438595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:07:00.440594 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:07:00.441592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:00.472039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:00.473034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:07:00.475547 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."publicx"."fact_stocks__dbt_tmp"
    
    
  as (
    -- -- noinspection SqlDialectInspectionForFile
--
-- with stock as (
--     select *
--     from "my_database"."publicx"."stg_eltool__stock"
--     ),
--      company as (
--          select *
--          from "my_database"."publicx"."stg_eltool__company"
--      )
-- select a.id,
--        a.ticker,
--        b.name,
--        a.date,
--        a.open,
--        a.high,
--        a.low,
--        a.close,
--        a.volume,
--        b.logo
-- from stock a
--     join company b on a.ticker = b.ticker
  );
[0m20:07:00.478578 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:   );
           ^

[0m20:07:00.479579 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: ROLLBACK
[0m20:07:00.483577 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:07:00.422534 => 20:07:00.482578
[0m20:07:00.485568 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:07:00.492583 [debug] [Thread-1 (]: Database Error in model fact_stocks (models\marts\core\fact_stocks.sql)
  syntax error at or near ")"
  LINE 29:   );
             ^
  compiled Code at target\run\dbt_project\models\marts\core\fact_stocks.sql
[0m20:07:00.493586 [error] [Thread-1 (]: 9 of 11 ERROR creating sql view model publicx.fact_stocks ...................... [[31mERROR[0m in 0.09s]
[0m20:07:00.496102 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:07:00.498284 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:07:00.500278 [info ] [Thread-1 (]: 10 of 11 SKIP relation publicx.customer_orders_status .......................... [[33mSKIP[0m]
[0m20:07:00.502383 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:07:00.503382 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:07:00.504381 [info ] [Thread-1 (]: 11 of 11 SKIP relation publicx.stock_update_status ............................. [[33mSKIP[0m]
[0m20:07:00.506383 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:07:00.510382 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:00.511381 [debug] [MainThread]: On master: BEGIN
[0m20:07:00.512382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:00.544972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:00.546973 [debug] [MainThread]: On master: COMMIT
[0m20:07:00.548378 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:00.549901 [debug] [MainThread]: On master: COMMIT
[0m20:07:00.552417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:00.553426 [debug] [MainThread]: On master: Close
[0m20:07:00.555431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:00.556443 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:07:00.558961 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:07:00.560969 [debug] [MainThread]: Connection 'model.dbt_project.fact_stocks' was properly closed.
[0m20:07:00.561964 [info ] [MainThread]: 
[0m20:07:00.563962 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m20:07:00.569967 [debug] [MainThread]: Command end result
[0m20:07:00.620216 [info ] [MainThread]: 
[0m20:07:00.622209 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:07:00.624205 [info ] [MainThread]: 
[0m20:07:00.626211 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)[0m
[0m20:07:00.628718 [error] [MainThread]:   relation "snapshots.customers_snapshot" does not exist
[0m20:07:00.629714 [error] [MainThread]:   LINE 8:                 from "my_database"."snapshots"."customers_sn...
[0m20:07:00.631736 [error] [MainThread]:                                ^
[0m20:07:00.634035 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:07:00.635842 [info ] [MainThread]: 
[0m20:07:00.637842 [error] [MainThread]: [33mDatabase Error in model fact_orders (models\marts\core\fact_orders.sql)[0m
[0m20:07:00.638841 [error] [MainThread]:   syntax error at or near ")"
[0m20:07:00.640842 [error] [MainThread]:   LINE 12:   );
[0m20:07:00.641842 [error] [MainThread]:              ^
[0m20:07:00.643854 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\fact_orders.sql
[0m20:07:00.645366 [info ] [MainThread]: 
[0m20:07:00.647376 [error] [MainThread]: [33mDatabase Error in model fact_stocks (models\marts\core\fact_stocks.sql)[0m
[0m20:07:00.648378 [error] [MainThread]:   syntax error at or near ")"
[0m20:07:00.650381 [error] [MainThread]:   LINE 29:   );
[0m20:07:00.651380 [error] [MainThread]:              ^
[0m20:07:00.653378 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\fact_stocks.sql
[0m20:07:00.654910 [info ] [MainThread]: 
[0m20:07:00.656920 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=3 TOTAL=11
[0m20:07:00.659911 [debug] [MainThread]: Command `dbt run` failed at 20:07:00.658926 after 2.59 seconds
[0m20:07:00.661439 [debug] [MainThread]: Flushing usage events


============================== 20:07:34.941298 | 2167bc9b-a340-410c-9c3c-7f858037800d ==============================
[0m20:07:34.941298 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:07:34.946852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m20:07:35.093602 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:07:35.103638 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:07:35.288011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m20:07:35.289009 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\core\fact_orders.sql
[0m20:07:35.289009 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\core\dim_customers.sql
[0m20:07:35.290515 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\stock\stock_update_status.sql
[0m20:07:35.291520 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\marketing\customer_orders_status.sql
[0m20:07:35.291520 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\core\fact_stocks.sql
[0m20:07:35.292521 [debug] [MainThread]: Partial parsing: updated file: dbt_project://tests\assert_stock_fact_has_no_row_loss.sql
[0m20:07:35.431068 [info ] [MainThread]: Found 1 snapshot, 17 tests, 11 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:07:35.434070 [info ] [MainThread]: 
[0m20:07:35.435033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:35.440265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_publicx'
[0m20:07:35.450264 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:07:35.451227 [debug] [ThreadPool]: On list_my_database_publicx: BEGIN
[0m20:07:35.452228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:35.482232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.483229 [debug] [ThreadPool]: Using postgres connection "list_my_database_publicx"
[0m20:07:35.483229 [debug] [ThreadPool]: On list_my_database_publicx: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_publicx"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'publicx'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'publicx'
  
[0m20:07:35.488338 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:07:35.489350 [debug] [ThreadPool]: On list_my_database_publicx: ROLLBACK
[0m20:07:35.492049 [debug] [ThreadPool]: On list_my_database_publicx: Close
[0m20:07:35.494060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_publicx, now list_my_database_snapshots)
[0m20:07:35.499061 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:07:35.500062 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:07:35.500062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:35.522140 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.522140 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:07:35.523146 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:07:35.527151 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:07:35.530151 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:07:35.532206 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:07:35.538763 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:35.539767 [debug] [MainThread]: On master: BEGIN
[0m20:07:35.540763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:35.561805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.562803 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:35.562803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:35.568843 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m20:07:35.570837 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:35.572844 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:35.572844 [debug] [MainThread]: On master: BEGIN
[0m20:07:35.575884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.576895 [debug] [MainThread]: On master: COMMIT
[0m20:07:35.577896 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:35.577896 [debug] [MainThread]: On master: COMMIT
[0m20:07:35.580267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:35.580267 [debug] [MainThread]: On master: Close
[0m20:07:35.582304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:35.583283 [info ] [MainThread]: 
[0m20:07:35.588305 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:35.589279 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m20:07:35.592281 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m20:07:35.593291 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:35.603313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:35.607277 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 20:07:35.594284 => 20:07:35.607277
[0m20:07:35.608303 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:35.623364 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:35.627410 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:35.628454 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m20:07:35.629414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:35.652922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.653943 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:35.654946 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "my_database"."publicx"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m20:07:35.657909 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.customer_orders_status" does not exist
LINE 17:     from "my_database"."publicx"."customer_orders_status"
                  ^

[0m20:07:35.657909 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m20:07:35.659909 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 20:07:35.608303 => 20:07:35.659909
[0m20:07:35.660935 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m20:07:35.675868 [debug] [Thread-1 (]: Database Error in test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable (models\marts\marketing\marketing.yml)
  relation "publicx.customer_orders_status" does not exist
  LINE 17:     from "my_database"."publicx"."customer_orders_status"
                    ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\accepted_values_customer_order_ff3347afd9206869995c975a52036ab8.sql
[0m20:07:35.676839 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[31mERROR[0m in 0.09s]
[0m20:07:35.677855 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:35.678839 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:35.679867 [info ] [Thread-1 (]: 2 of 17 START test assert_customer_dimension_has_no_row_loss ................... [RUN]
[0m20:07:35.681868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_project.assert_customer_dimension_has_no_row_loss)
[0m20:07:35.681868 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:35.686838 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:35.691879 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (compile): 20:07:35.682864 => 20:07:35.691879
[0m20:07:35.692840 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:35.695839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:35.700840 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:35.701873 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: BEGIN
[0m20:07:35.701873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:35.725897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.726924 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:35.727897 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_customer_dimension_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "my_database"."publicx"."dim_customers" dim_cust
        left join "my_database"."publicx"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "my_database"."publicx"."stg_eltool__customers_snapshots" stg_cust
      left join "my_database"."publicx"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m20:07:35.729963 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.dim_customers" does not exist
LINE 12:     from "my_database"."publicx"."dim_customers" dim_cust
                  ^

[0m20:07:35.731917 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: ROLLBACK
[0m20:07:35.734915 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (execute): 20:07:35.693838 => 20:07:35.734915
[0m20:07:35.735898 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: Close
[0m20:07:35.743420 [debug] [Thread-1 (]: Database Error in test assert_customer_dimension_has_no_row_loss (tests\assert_customer_dimension_has_no_row_loss.sql)
  relation "publicx.dim_customers" does not exist
  LINE 12:     from "my_database"."publicx"."dim_customers" dim_cust
                    ^
  compiled Code at target\run\dbt_project\tests\assert_customer_dimension_has_no_row_loss.sql
[0m20:07:35.744451 [error] [Thread-1 (]: 2 of 17 ERROR assert_customer_dimension_has_no_row_loss ........................ [[31mERROR[0m in 0.06s]
[0m20:07:35.746432 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:35.747415 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:35.748416 [info ] [Thread-1 (]: 3 of 17 START test assert_stock_fact_has_no_row_loss ........................... [RUN]
[0m20:07:35.750120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_customer_dimension_has_no_row_loss, now test.dbt_project.assert_stock_fact_has_no_row_loss)
[0m20:07:35.751118 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:35.753117 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:35.757150 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (compile): 20:07:35.751118 => 20:07:35.757150
[0m20:07:35.758132 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:35.760148 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:35.765116 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:35.766179 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: BEGIN
[0m20:07:35.766179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:35.789509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.790495 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:35.791495 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_stock_fact_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "my_database"."publicx"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m20:07:35.794529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.fact_stocks" does not exist
LINE 12:     from "my_database"."publicx"."fact_stocks" stock
                  ^

[0m20:07:35.795494 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: ROLLBACK
[0m20:07:35.797510 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (execute): 20:07:35.758132 => 20:07:35.797510
[0m20:07:35.798522 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: Close
[0m20:07:35.804520 [debug] [Thread-1 (]: Database Error in test assert_stock_fact_has_no_row_loss (tests\assert_stock_fact_has_no_row_loss.sql)
  relation "publicx.fact_stocks" does not exist
  LINE 12:     from "my_database"."publicx"."fact_stocks" stock
                    ^
  compiled Code at target\run\dbt_project\tests\assert_stock_fact_has_no_row_loss.sql
[0m20:07:35.805493 [error] [Thread-1 (]: 3 of 17 ERROR assert_stock_fact_has_no_row_loss ................................ [[31mERROR[0m in 0.06s]
[0m20:07:35.807493 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:35.808496 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:35.809494 [info ] [Thread-1 (]: 4 of 17 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m20:07:35.810493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_stock_fact_has_no_row_loss, now test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb)
[0m20:07:35.811521 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:35.819493 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:35.823524 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (compile): 20:07:35.812494 => 20:07:35.823524
[0m20:07:35.824526 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:35.827554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:35.831554 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:35.832552 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m20:07:35.833545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:35.855610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.856622 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:35.856622 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."publicx"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:35.859628 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.customer_orders_status" does not exist
LINE 14: from "my_database"."publicx"."customer_orders_status"
              ^

[0m20:07:35.860639 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m20:07:35.862471 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (execute): 20:07:35.825531 => 20:07:35.862471
[0m20:07:35.863469 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m20:07:35.868497 [debug] [Thread-1 (]: Database Error in test not_null_customer_orders_status_customer_id (models\marts\marketing\marketing.yml)
  relation "publicx.customer_orders_status" does not exist
  LINE 14: from "my_database"."publicx"."customer_orders_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\not_null_customer_orders_status_customer_id.sql
[0m20:07:35.869468 [error] [Thread-1 (]: 4 of 17 ERROR not_null_customer_orders_status_customer_id ...................... [[31mERROR[0m in 0.06s]
[0m20:07:35.871470 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:35.871470 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:35.872469 [info ] [Thread-1 (]: 5 of 17 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m20:07:35.873469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:07:35.874495 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:35.878506 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:35.882495 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 20:07:35.875483 => 20:07:35.882495
[0m20:07:35.883482 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:35.886495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:35.891471 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:35.892508 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m20:07:35.893529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:35.916396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.917416 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:35.918380 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."publicx"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:35.920401 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.dim_customers" does not exist
LINE 14: from "my_database"."publicx"."dim_customers"
              ^

[0m20:07:35.921415 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m20:07:35.923394 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 20:07:35.883482 => 20:07:35.923394
[0m20:07:35.924387 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m20:07:35.929387 [debug] [Thread-1 (]: Database Error in test not_null_dim_customers_customer_id (models\marts\core\core.yml)
  relation "publicx.dim_customers" does not exist
  LINE 14: from "my_database"."publicx"."dim_customers"
                ^
  compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_dim_customers_customer_id.sql
[0m20:07:35.930387 [error] [Thread-1 (]: 5 of 17 ERROR not_null_dim_customers_customer_id ............................... [[31mERROR[0m in 0.06s]
[0m20:07:35.932387 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:35.933393 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:35.933393 [info ] [Thread-1 (]: 6 of 17 START test not_null_fact_stocks_id ..................................... [RUN]
[0m20:07:35.935413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_fact_stocks_id.e7b7e788fa)
[0m20:07:35.935413 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:35.939982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:35.943957 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (compile): 20:07:35.936417 => 20:07:35.943957
[0m20:07:35.944962 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:35.946960 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:35.950956 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:35.951957 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m20:07:35.952962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:35.977336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:35.978349 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:35.979337 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."publicx"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m20:07:35.982333 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.fact_stocks" does not exist
LINE 14: from "my_database"."publicx"."fact_stocks"
              ^

[0m20:07:35.983366 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m20:07:35.985923 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (execute): 20:07:35.944962 => 20:07:35.985923
[0m20:07:35.986959 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: Close
[0m20:07:35.991924 [debug] [Thread-1 (]: Database Error in test not_null_fact_stocks_id (models\marts\core\core.yml)
  relation "publicx.fact_stocks" does not exist
  LINE 14: from "my_database"."publicx"."fact_stocks"
                ^
  compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_fact_stocks_id.sql
[0m20:07:35.992924 [error] [Thread-1 (]: 6 of 17 ERROR not_null_fact_stocks_id .......................................... [[31mERROR[0m in 0.06s]
[0m20:07:35.993924 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:35.995929 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:35.996941 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m20:07:35.998921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_project.not_null_stg_eltool__company_id.632831b79c)
[0m20:07:36.000929 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:36.004924 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:36.009922 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (compile): 20:07:36.000929 => 20:07:36.008960
[0m20:07:36.010992 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:36.013962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:36.017962 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:36.018927 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m20:07:36.019967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.043592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.044603 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:36.044603 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."publicx"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m20:07:36.048142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.051176 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (execute): 20:07:36.011958 => 20:07:36.050176
[0m20:07:36.051176 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m20:07:36.053160 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: Close
[0m20:07:36.055140 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.06s]
[0m20:07:36.057173 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:36.058149 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:36.059179 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m20:07:36.060177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__company_id.632831b79c, now test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m20:07:36.061145 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:36.065176 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:36.069145 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 20:07:36.062144 => 20:07:36.069145
[0m20:07:36.070158 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:36.073159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:36.078182 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:36.079179 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m20:07:36.080145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.101073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.102072 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:36.103062 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."publicx"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:36.106038 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.stg_eltool__customers_snapshots" does not exist
LINE 14: from "my_database"."publicx"."stg_eltool__customers_snapshot...
              ^

[0m20:07:36.107037 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m20:07:36.108939 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 20:07:36.070158 => 20:07:36.107894
[0m20:07:36.109908 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m20:07:36.114932 [debug] [Thread-1 (]: Database Error in test not_null_stg_eltool__customers_snapshots_customer_id (models\staging\stg_eltool.yml)
  relation "publicx.stg_eltool__customers_snapshots" does not exist
  LINE 14: from "my_database"."publicx"."stg_eltool__customers_snapshot...
                ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__customers_snapshots_customer_id.sql
[0m20:07:36.115947 [error] [Thread-1 (]: 8 of 17 ERROR not_null_stg_eltool__customers_snapshots_customer_id ............. [[31mERROR[0m in 0.06s]
[0m20:07:36.116904 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:36.117930 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:36.118904 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m20:07:36.119904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m20:07:36.120930 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:36.124940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:36.128977 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 20:07:36.121908 => 20:07:36.128977
[0m20:07:36.129918 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:36.131948 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:36.135925 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:36.138475 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m20:07:36.139466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.162470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.163467 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:36.164464 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."publicx"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m20:07:36.197013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.199014 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 20:07:36.129918 => 20:07:36.199014
[0m20:07:36.200049 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m20:07:36.202059 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m20:07:36.203137 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.08s]
[0m20:07:36.206073 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:36.207072 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:36.208068 [info ] [Thread-1 (]: 10 of 17 START test not_null_stock_update_status_id ............................ [RUN]
[0m20:07:36.209077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_project.not_null_stock_update_status_id.633bc8afe3)
[0m20:07:36.210071 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:36.215105 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:36.219072 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (compile): 20:07:36.211074 => 20:07:36.219072
[0m20:07:36.220081 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:36.224075 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:36.229098 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:36.230104 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m20:07:36.231082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.256445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.257458 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:36.257458 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."publicx"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m20:07:36.261436 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.stock_update_status" does not exist
LINE 14: from "my_database"."publicx"."stock_update_status"
              ^

[0m20:07:36.262437 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m20:07:36.265439 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (execute): 20:07:36.220081 => 20:07:36.265439
[0m20:07:36.266462 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: Close
[0m20:07:36.272440 [debug] [Thread-1 (]: Database Error in test not_null_stock_update_status_id (models\marts\stock\stock.yml)
  relation "publicx.stock_update_status" does not exist
  LINE 14: from "my_database"."publicx"."stock_update_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\stock\stock.yml\not_null_stock_update_status_id.sql
[0m20:07:36.273469 [error] [Thread-1 (]: 10 of 17 ERROR not_null_stock_update_status_id ................................. [[31mERROR[0m in 0.06s]
[0m20:07:36.275441 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:36.276466 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:36.277485 [info ] [Thread-1 (]: 11 of 17 START test source_not_null_public_customers_customer_id ............... [RUN]
[0m20:07:36.278473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stock_update_status_id.633bc8afe3, now test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f)
[0m20:07:36.279438 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:36.283472 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:36.287471 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (compile): 20:07:36.280443 => 20:07:36.287471
[0m20:07:36.288483 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:36.292491 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:36.296464 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:36.297435 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: BEGIN
[0m20:07:36.298435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.322972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.323973 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:36.324975 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:36.327971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.330977 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (execute): 20:07:36.289437 => 20:07:36.330010
[0m20:07:36.331974 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: ROLLBACK
[0m20:07:36.333978 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: Close
[0m20:07:36.336065 [info ] [Thread-1 (]: 11 of 17 PASS source_not_null_public_customers_customer_id ..................... [[32mPASS[0m in 0.06s]
[0m20:07:36.337573 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:36.338603 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:36.339601 [info ] [Thread-1 (]: 12 of 17 START test source_not_null_public_ksql-company-stream_id .............. [RUN]
[0m20:07:36.340580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f, now test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0)
[0m20:07:36.341580 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:36.345615 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:36.349615 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (compile): 20:07:36.341580 => 20:07:36.349615
[0m20:07:36.350579 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:36.354580 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:36.358578 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:36.359579 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: BEGIN
[0m20:07:36.359579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.381658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.382638 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:36.383672 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m20:07:36.386637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.388664 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (execute): 20:07:36.351598 => 20:07:36.387664
[0m20:07:36.388664 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: ROLLBACK
[0m20:07:36.391637 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: Close
[0m20:07:36.392664 [info ] [Thread-1 (]: 12 of 17 PASS source_not_null_public_ksql-company-stream_id .................... [[32mPASS[0m in 0.05s]
[0m20:07:36.394653 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:36.395648 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:36.396641 [info ] [Thread-1 (]: 13 of 17 START test source_not_null_public_ksql-stock-stream_id ................ [RUN]
[0m20:07:36.397637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0, now test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8)
[0m20:07:36.398666 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:36.403662 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:36.407668 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (compile): 20:07:36.399664 => 20:07:36.407668
[0m20:07:36.408638 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:36.411662 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:36.415638 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:36.416667 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: BEGIN
[0m20:07:36.417693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.439032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.440019 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:36.441019 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m20:07:36.447436 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.449422 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (execute): 20:07:36.409667 => 20:07:36.449422
[0m20:07:36.450456 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: ROLLBACK
[0m20:07:36.452421 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: Close
[0m20:07:36.454427 [info ] [Thread-1 (]: 13 of 17 PASS source_not_null_public_ksql-stock-stream_id ...................... [[32mPASS[0m in 0.06s]
[0m20:07:36.455424 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:36.457425 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:36.458421 [info ] [Thread-1 (]: 14 of 17 START test source_not_null_public_orders_order_id ..................... [RUN]
[0m20:07:36.459421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8, now test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee)
[0m20:07:36.460421 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:36.465457 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:36.470004 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (compile): 20:07:36.461425 => 20:07:36.470004
[0m20:07:36.471066 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:36.474041 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:36.480006 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:36.481005 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: BEGIN
[0m20:07:36.482005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.504123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.505135 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:36.506131 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "my_database"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m20:07:36.512097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.515135 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (execute): 20:07:36.471066 => 20:07:36.514135
[0m20:07:36.515135 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: ROLLBACK
[0m20:07:36.517098 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: Close
[0m20:07:36.519098 [info ] [Thread-1 (]: 14 of 17 PASS source_not_null_public_orders_order_id ........................... [[32mPASS[0m in 0.06s]
[0m20:07:36.521100 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:36.522115 [debug] [Thread-1 (]: Began running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:36.523133 [info ] [Thread-1 (]: 15 of 17 START test source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [RUN]
[0m20:07:36.524123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee, now test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5)
[0m20:07:36.525134 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:36.533159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:36.536122 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (compile): 20:07:36.525134 => 20:07:36.536122
[0m20:07:36.537664 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:36.541704 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:36.545712 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:36.546675 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: BEGIN
[0m20:07:36.547676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.570110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.571110 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:36.571110 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "my_database"."public"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "my_database"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:07:36.575467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.576504 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (execute): 20:07:36.538710 => 20:07:36.576504
[0m20:07:36.577505 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: ROLLBACK
[0m20:07:36.580467 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: Close
[0m20:07:36.582476 [info ] [Thread-1 (]: 15 of 17 PASS source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [[32mPASS[0m in 0.06s]
[0m20:07:36.584485 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:36.585468 [debug] [Thread-1 (]: Began running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:36.586467 [info ] [Thread-1 (]: 16 of 17 START test source_unique_public_orders_order_id ....................... [RUN]
[0m20:07:36.587469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5, now test.dbt_project.source_unique_public_orders_order_id.95035364f0)
[0m20:07:36.588505 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:36.595502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:36.599467 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (compile): 20:07:36.589467 => 20:07:36.599467
[0m20:07:36.600504 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:36.603529 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:36.607503 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:36.608467 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: BEGIN
[0m20:07:36.609466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.630491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.632508 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:36.633501 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_unique_public_orders_order_id.95035364f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:07:36.638000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:36.642026 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (execute): 20:07:36.601482 => 20:07:36.641012
[0m20:07:36.643057 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: ROLLBACK
[0m20:07:36.645012 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: Close
[0m20:07:36.646010 [info ] [Thread-1 (]: 16 of 17 PASS source_unique_public_orders_order_id ............................. [[32mPASS[0m in 0.06s]
[0m20:07:36.649026 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:36.650009 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:36.651008 [info ] [Thread-1 (]: 17 of 17 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m20:07:36.652007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_unique_public_orders_order_id.95035364f0, now test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee)
[0m20:07:36.653010 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:36.657033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:36.660855 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (compile): 20:07:36.653010 => 20:07:36.659890
[0m20:07:36.660855 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:36.666853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:36.670888 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:36.671862 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m20:07:36.671862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:36.694795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.695824 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:36.696789 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."publicx"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:07:36.698792 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publicx.customer_orders_status" does not exist
LINE 15: from "my_database"."publicx"."customer_orders_status"
              ^

[0m20:07:36.699825 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m20:07:36.701790 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (execute): 20:07:36.661891 => 20:07:36.701790
[0m20:07:36.702791 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m20:07:36.707825 [debug] [Thread-1 (]: Database Error in test unique_customer_orders_status_order_id (models\marts\marketing\marketing.yml)
  relation "publicx.customer_orders_status" does not exist
  LINE 15: from "my_database"."publicx"."customer_orders_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\unique_customer_orders_status_order_id.sql
[0m20:07:36.708810 [error] [Thread-1 (]: 17 of 17 ERROR unique_customer_orders_status_order_id .......................... [[31mERROR[0m in 0.06s]
[0m20:07:36.710826 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:36.712791 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:36.713813 [debug] [MainThread]: On master: BEGIN
[0m20:07:36.713813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:36.736043 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:36.737076 [debug] [MainThread]: On master: COMMIT
[0m20:07:36.738081 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:36.739181 [debug] [MainThread]: On master: COMMIT
[0m20:07:36.741205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:36.742188 [debug] [MainThread]: On master: Close
[0m20:07:36.744194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:36.746185 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:07:36.747196 [debug] [MainThread]: Connection 'test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m20:07:36.748181 [info ] [MainThread]: 
[0m20:07:36.749218 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m20:07:36.753212 [debug] [MainThread]: Command end result
[0m20:07:36.814776 [info ] [MainThread]: 
[0m20:07:36.815741 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m20:07:36.816742 [info ] [MainThread]: 
[0m20:07:36.817740 [error] [MainThread]: [33mDatabase Error in test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable (models\marts\marketing\marketing.yml)[0m
[0m20:07:36.818742 [error] [MainThread]:   relation "publicx.customer_orders_status" does not exist
[0m20:07:36.819763 [error] [MainThread]:   LINE 17:     from "my_database"."publicx"."customer_orders_status"
[0m20:07:36.819763 [error] [MainThread]:                     ^
[0m20:07:36.821743 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\accepted_values_customer_order_ff3347afd9206869995c975a52036ab8.sql
[0m20:07:36.821743 [info ] [MainThread]: 
[0m20:07:36.822741 [error] [MainThread]: [33mDatabase Error in test assert_customer_dimension_has_no_row_loss (tests\assert_customer_dimension_has_no_row_loss.sql)[0m
[0m20:07:36.823746 [error] [MainThread]:   relation "publicx.dim_customers" does not exist
[0m20:07:36.824748 [error] [MainThread]:   LINE 12:     from "my_database"."publicx"."dim_customers" dim_cust
[0m20:07:36.825757 [error] [MainThread]:                     ^
[0m20:07:36.826773 [error] [MainThread]:   compiled Code at target\run\dbt_project\tests\assert_customer_dimension_has_no_row_loss.sql
[0m20:07:36.827771 [info ] [MainThread]: 
[0m20:07:36.829768 [error] [MainThread]: [33mDatabase Error in test assert_stock_fact_has_no_row_loss (tests\assert_stock_fact_has_no_row_loss.sql)[0m
[0m20:07:36.830167 [error] [MainThread]:   relation "publicx.fact_stocks" does not exist
[0m20:07:36.831183 [error] [MainThread]:   LINE 12:     from "my_database"."publicx"."fact_stocks" stock
[0m20:07:36.832178 [error] [MainThread]:                     ^
[0m20:07:36.832178 [error] [MainThread]:   compiled Code at target\run\dbt_project\tests\assert_stock_fact_has_no_row_loss.sql
[0m20:07:36.833182 [info ] [MainThread]: 
[0m20:07:36.834184 [error] [MainThread]: [33mDatabase Error in test not_null_customer_orders_status_customer_id (models\marts\marketing\marketing.yml)[0m
[0m20:07:36.835183 [error] [MainThread]:   relation "publicx.customer_orders_status" does not exist
[0m20:07:36.836183 [error] [MainThread]:   LINE 14: from "my_database"."publicx"."customer_orders_status"
[0m20:07:36.837184 [error] [MainThread]:                 ^
[0m20:07:36.838695 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\not_null_customer_orders_status_customer_id.sql
[0m20:07:36.838695 [info ] [MainThread]: 
[0m20:07:36.839707 [error] [MainThread]: [33mDatabase Error in test not_null_dim_customers_customer_id (models\marts\core\core.yml)[0m
[0m20:07:36.840703 [error] [MainThread]:   relation "publicx.dim_customers" does not exist
[0m20:07:36.841702 [error] [MainThread]:   LINE 14: from "my_database"."publicx"."dim_customers"
[0m20:07:36.842738 [error] [MainThread]:                 ^
[0m20:07:36.843703 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_dim_customers_customer_id.sql
[0m20:07:36.843703 [info ] [MainThread]: 
[0m20:07:36.844728 [error] [MainThread]: [33mDatabase Error in test not_null_fact_stocks_id (models\marts\core\core.yml)[0m
[0m20:07:36.845719 [error] [MainThread]:   relation "publicx.fact_stocks" does not exist
[0m20:07:36.846707 [error] [MainThread]:   LINE 14: from "my_database"."publicx"."fact_stocks"
[0m20:07:36.847707 [error] [MainThread]:                 ^
[0m20:07:36.848706 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_fact_stocks_id.sql
[0m20:07:36.849707 [info ] [MainThread]: 
[0m20:07:36.849707 [error] [MainThread]: [33mDatabase Error in test not_null_stg_eltool__customers_snapshots_customer_id (models\staging\stg_eltool.yml)[0m
[0m20:07:36.850708 [error] [MainThread]:   relation "publicx.stg_eltool__customers_snapshots" does not exist
[0m20:07:36.852719 [error] [MainThread]:   LINE 14: from "my_database"."publicx"."stg_eltool__customers_snapshot...
[0m20:07:36.853719 [error] [MainThread]:                 ^
[0m20:07:36.854763 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__customers_snapshots_customer_id.sql
[0m20:07:36.855706 [info ] [MainThread]: 
[0m20:07:36.856704 [error] [MainThread]: [33mDatabase Error in test not_null_stock_update_status_id (models\marts\stock\stock.yml)[0m
[0m20:07:36.857837 [error] [MainThread]:   relation "publicx.stock_update_status" does not exist
[0m20:07:36.858869 [error] [MainThread]:   LINE 14: from "my_database"."publicx"."stock_update_status"
[0m20:07:36.859849 [error] [MainThread]:                 ^
[0m20:07:36.859849 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\stock\stock.yml\not_null_stock_update_status_id.sql
[0m20:07:36.860849 [info ] [MainThread]: 
[0m20:07:36.862850 [error] [MainThread]: [33mDatabase Error in test unique_customer_orders_status_order_id (models\marts\marketing\marketing.yml)[0m
[0m20:07:36.863851 [error] [MainThread]:   relation "publicx.customer_orders_status" does not exist
[0m20:07:36.864848 [error] [MainThread]:   LINE 15: from "my_database"."publicx"."customer_orders_status"
[0m20:07:36.864848 [error] [MainThread]:                 ^
[0m20:07:36.865886 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\unique_customer_orders_status_order_id.sql
[0m20:07:36.866848 [info ] [MainThread]: 
[0m20:07:36.868850 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=9 SKIP=0 TOTAL=17
[0m20:07:36.869850 [debug] [MainThread]: Command `dbt test` failed at 20:07:36.869850 after 1.97 seconds
[0m20:07:36.870849 [debug] [MainThread]: Flushing usage events


============================== 20:07:51.043222 | 79fa4b9b-bf99-4e4e-9fc5-dd7e032b1f1a ==============================
[0m20:07:51.043222 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:07:51.050896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'False'}
[0m20:07:51.182586 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:07:51.190611 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:07:51.210586 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:07:52.233111 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:07:52.236064 [info ] [MainThread]: 
[0m20:07:52.238065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:52.241066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:07:52.253106 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:07:52.254110 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:07:52.255106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:52.288500 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.289502 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:07:52.290526 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:07:52.296502 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:07:52.297503 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:07:52.300513 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:07:52.302522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:07:52.306536 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:07:52.307510 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:07:52.308522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:52.331250 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.332265 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:07:52.333234 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:07:52.337953 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:07:52.339990 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:07:52.341905 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:07:52.348951 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:52.349952 [debug] [MainThread]: On master: BEGIN
[0m20:07:52.349952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:52.372685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.373650 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:52.373650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:52.379682 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m20:07:52.383677 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:52.385676 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:52.386650 [debug] [MainThread]: On master: BEGIN
[0m20:07:52.389834 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.389834 [debug] [MainThread]: On master: COMMIT
[0m20:07:52.390833 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:52.391833 [debug] [MainThread]: On master: COMMIT
[0m20:07:52.392834 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:52.393862 [debug] [MainThread]: On master: Close
[0m20:07:52.394833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:52.396851 [info ] [MainThread]: 
[0m20:07:52.402837 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:52.403843 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m20:07:52.404838 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m20:07:52.405846 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:52.414832 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:52.421603 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 20:07:52.405846 => 20:07:52.421603
[0m20:07:52.422643 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:52.437615 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:52.444007 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:52.444970 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m20:07:52.445970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:52.467685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.468686 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:07:52.468686 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "my_database"."public"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m20:07:52.471684 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customer_orders_status" does not exist
LINE 17:     from "my_database"."public"."customer_orders_status"
                  ^

[0m20:07:52.472685 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m20:07:52.474841 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 20:07:52.422643 => 20:07:52.473710
[0m20:07:52.476393 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m20:07:52.492424 [debug] [Thread-1 (]: Database Error in test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable (models\marts\marketing\marketing.yml)
  relation "public.customer_orders_status" does not exist
  LINE 17:     from "my_database"."public"."customer_orders_status"
                    ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\accepted_values_customer_order_ff3347afd9206869995c975a52036ab8.sql
[0m20:07:52.493395 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[31mERROR[0m in 0.09s]
[0m20:07:52.494392 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:07:52.495421 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:52.497392 [info ] [Thread-1 (]: 2 of 17 START test assert_customer_dimension_has_no_row_loss ................... [RUN]
[0m20:07:52.498427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_project.assert_customer_dimension_has_no_row_loss)
[0m20:07:52.499394 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:52.503452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:52.509738 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (compile): 20:07:52.500392 => 20:07:52.509738
[0m20:07:52.510874 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:52.513861 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:52.521406 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:52.523402 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: BEGIN
[0m20:07:52.523402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.548799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.549797 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:07:52.551766 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_customer_dimension_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "my_database"."public"."dim_customers" dim_cust
        left join "my_database"."public"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "my_database"."public"."stg_eltool__customers_snapshots" stg_cust
      left join "my_database"."public"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m20:07:52.554765 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_customers" does not exist
LINE 12:     from "my_database"."public"."dim_customers" dim_cust
                  ^

[0m20:07:52.555770 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: ROLLBACK
[0m20:07:52.558312 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (execute): 20:07:52.511862 => 20:07:52.558312
[0m20:07:52.559302 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: Close
[0m20:07:52.565327 [debug] [Thread-1 (]: Database Error in test assert_customer_dimension_has_no_row_loss (tests\assert_customer_dimension_has_no_row_loss.sql)
  relation "public.dim_customers" does not exist
  LINE 12:     from "my_database"."public"."dim_customers" dim_cust
                    ^
  compiled Code at target\run\dbt_project\tests\assert_customer_dimension_has_no_row_loss.sql
[0m20:07:52.566301 [error] [Thread-1 (]: 2 of 17 ERROR assert_customer_dimension_has_no_row_loss ........................ [[31mERROR[0m in 0.07s]
[0m20:07:52.567317 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:07:52.568301 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:52.568301 [info ] [Thread-1 (]: 3 of 17 START test assert_stock_fact_has_no_row_loss ........................... [RUN]
[0m20:07:52.570328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_customer_dimension_has_no_row_loss, now test.dbt_project.assert_stock_fact_has_no_row_loss)
[0m20:07:52.571305 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:52.573306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:52.580574 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (compile): 20:07:52.571305 => 20:07:52.579611
[0m20:07:52.580574 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:52.583610 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:52.590612 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:52.591595 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: BEGIN
[0m20:07:52.592574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.614699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.616729 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:07:52.617724 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_stock_fact_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "my_database"."public"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m20:07:52.619700 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_stocks" does not exist
LINE 12:     from "my_database"."public"."fact_stocks" stock
                  ^

[0m20:07:52.620724 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: ROLLBACK
[0m20:07:52.622696 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (execute): 20:07:52.581610 => 20:07:52.622696
[0m20:07:52.623697 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: Close
[0m20:07:52.629727 [debug] [Thread-1 (]: Database Error in test assert_stock_fact_has_no_row_loss (tests\assert_stock_fact_has_no_row_loss.sql)
  relation "public.fact_stocks" does not exist
  LINE 12:     from "my_database"."public"."fact_stocks" stock
                    ^
  compiled Code at target\run\dbt_project\tests\assert_stock_fact_has_no_row_loss.sql
[0m20:07:52.630726 [error] [Thread-1 (]: 3 of 17 ERROR assert_stock_fact_has_no_row_loss ................................ [[31mERROR[0m in 0.06s]
[0m20:07:52.632698 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:07:52.633713 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:52.634712 [info ] [Thread-1 (]: 4 of 17 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m20:07:52.635696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_stock_fact_has_no_row_loss, now test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb)
[0m20:07:52.636738 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:52.643732 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:52.652768 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (compile): 20:07:52.636738 => 20:07:52.652768
[0m20:07:52.653766 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:52.658324 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:52.665323 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:52.666324 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m20:07:52.667327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.691325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.692349 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:07:52.693343 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:52.697326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customer_orders_status" does not exist
LINE 14: from "my_database"."public"."customer_orders_status"
              ^

[0m20:07:52.698849 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m20:07:52.702850 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (execute): 20:07:52.654767 => 20:07:52.702850
[0m20:07:52.703856 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m20:07:52.710847 [debug] [Thread-1 (]: Database Error in test not_null_customer_orders_status_customer_id (models\marts\marketing\marketing.yml)
  relation "public.customer_orders_status" does not exist
  LINE 14: from "my_database"."public"."customer_orders_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\not_null_customer_orders_status_customer_id.sql
[0m20:07:52.711847 [error] [Thread-1 (]: 4 of 17 ERROR not_null_customer_orders_status_customer_id ...................... [[31mERROR[0m in 0.08s]
[0m20:07:52.713850 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:07:52.714849 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:52.715849 [info ] [Thread-1 (]: 5 of 17 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m20:07:52.716855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:07:52.717867 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:52.722885 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:52.730851 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 20:07:52.718862 => 20:07:52.729884
[0m20:07:52.731883 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:52.733848 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:52.740448 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:52.742414 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m20:07:52.743423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.768558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.768558 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:07:52.770069 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:52.773100 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_customers" does not exist
LINE 14: from "my_database"."public"."dim_customers"
              ^

[0m20:07:52.774118 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m20:07:52.777115 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 20:07:52.731883 => 20:07:52.776101
[0m20:07:52.778080 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m20:07:52.783076 [debug] [Thread-1 (]: Database Error in test not_null_dim_customers_customer_id (models\marts\core\core.yml)
  relation "public.dim_customers" does not exist
  LINE 14: from "my_database"."public"."dim_customers"
                ^
  compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_dim_customers_customer_id.sql
[0m20:07:52.784118 [error] [Thread-1 (]: 5 of 17 ERROR not_null_dim_customers_customer_id ............................... [[31mERROR[0m in 0.07s]
[0m20:07:52.786077 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:07:52.786621 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:52.787640 [info ] [Thread-1 (]: 6 of 17 START test not_null_fact_stocks_id ..................................... [RUN]
[0m20:07:52.788628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_fact_stocks_id.e7b7e788fa)
[0m20:07:52.789662 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:52.794633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:52.801663 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (compile): 20:07:52.790662 => 20:07:52.801118
[0m20:07:52.801663 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:52.805664 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:52.813221 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:52.814194 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m20:07:52.815193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.840775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.841805 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:07:52.842846 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m20:07:52.847810 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_stocks" does not exist
LINE 14: from "my_database"."public"."fact_stocks"
              ^

[0m20:07:52.848811 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m20:07:52.851815 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (execute): 20:07:52.802664 => 20:07:52.851815
[0m20:07:52.852841 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: Close
[0m20:07:52.860890 [debug] [Thread-1 (]: Database Error in test not_null_fact_stocks_id (models\marts\core\core.yml)
  relation "public.fact_stocks" does not exist
  LINE 14: from "my_database"."public"."fact_stocks"
                ^
  compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_fact_stocks_id.sql
[0m20:07:52.861892 [error] [Thread-1 (]: 6 of 17 ERROR not_null_fact_stocks_id .......................................... [[31mERROR[0m in 0.07s]
[0m20:07:52.863863 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:07:52.864879 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:52.865859 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m20:07:52.867860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_project.not_null_stg_eltool__company_id.632831b79c)
[0m20:07:52.868861 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:52.875894 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:52.883733 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (compile): 20:07:52.869877 => 20:07:52.883733
[0m20:07:52.884745 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:52.887745 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:52.894750 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:52.895747 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m20:07:52.896744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:52.925761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:52.926750 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:07:52.926750 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m20:07:52.930591 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_eltool__company" does not exist
LINE 14: from "my_database"."public"."stg_eltool__company"
              ^

[0m20:07:52.931604 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m20:07:52.933598 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (execute): 20:07:52.885753 => 20:07:52.933598
[0m20:07:52.934634 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: Close
[0m20:07:52.940153 [debug] [Thread-1 (]: Database Error in test not_null_stg_eltool__company_id (models\staging\stg_eltool.yml)
  relation "public.stg_eltool__company" does not exist
  LINE 14: from "my_database"."public"."stg_eltool__company"
                ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__company_id.sql
[0m20:07:52.941155 [error] [Thread-1 (]: 7 of 17 ERROR not_null_stg_eltool__company_id .................................. [[31mERROR[0m in 0.07s]
[0m20:07:52.943164 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:07:52.945142 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:52.945142 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m20:07:52.947126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__company_id.632831b79c, now test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m20:07:52.948126 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:52.953159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:52.961152 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 20:07:52.948126 => 20:07:52.960643
[0m20:07:52.963165 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:52.969164 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:52.977765 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:52.979763 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m20:07:52.981271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.009851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.010866 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:07:53.011868 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:53.014866 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_eltool__customers_snapshots" does not exist
LINE 14: from "my_database"."public"."stg_eltool__customers_snapshots...
              ^

[0m20:07:53.015597 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m20:07:53.017608 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 20:07:52.964162 => 20:07:53.017608
[0m20:07:53.018609 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m20:07:53.024727 [debug] [Thread-1 (]: Database Error in test not_null_stg_eltool__customers_snapshots_customer_id (models\staging\stg_eltool.yml)
  relation "public.stg_eltool__customers_snapshots" does not exist
  LINE 14: from "my_database"."public"."stg_eltool__customers_snapshots...
                ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__customers_snapshots_customer_id.sql
[0m20:07:53.026725 [error] [Thread-1 (]: 8 of 17 ERROR not_null_stg_eltool__customers_snapshots_customer_id ............. [[31mERROR[0m in 0.08s]
[0m20:07:53.027724 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:07:53.028724 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:53.029738 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m20:07:53.030725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m20:07:53.031725 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:53.036768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:53.042758 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 20:07:53.031725 => 20:07:53.042758
[0m20:07:53.043722 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:53.045888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:53.053852 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:53.054852 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m20:07:53.054852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.079253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.080253 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:07:53.081253 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m20:07:53.084254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_eltool__stock" does not exist
LINE 14: from "my_database"."public"."stg_eltool__stock"
              ^

[0m20:07:53.085284 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m20:07:53.088286 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 20:07:53.043722 => 20:07:53.088286
[0m20:07:53.088814 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m20:07:53.095334 [debug] [Thread-1 (]: Database Error in test not_null_stg_eltool__stock_id (models\staging\stg_eltool.yml)
  relation "public.stg_eltool__stock" does not exist
  LINE 14: from "my_database"."public"."stg_eltool__stock"
                ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__stock_id.sql
[0m20:07:53.096342 [error] [Thread-1 (]: 9 of 17 ERROR not_null_stg_eltool__stock_id .................................... [[31mERROR[0m in 0.07s]
[0m20:07:53.098341 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:07:53.098910 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:53.099945 [info ] [Thread-1 (]: 10 of 17 START test not_null_stock_update_status_id ............................ [RUN]
[0m20:07:53.101954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_project.not_null_stock_update_status_id.633bc8afe3)
[0m20:07:53.101954 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:53.106942 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:53.114940 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (compile): 20:07:53.102920 => 20:07:53.113923
[0m20:07:53.115921 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:53.119940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:53.126968 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:53.127967 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m20:07:53.128970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.175569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.177566 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:07:53.177566 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m20:07:53.180568 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stock_update_status" does not exist
LINE 14: from "my_database"."public"."stock_update_status"
              ^

[0m20:07:53.181579 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m20:07:53.184075 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (execute): 20:07:53.116923 => 20:07:53.184075
[0m20:07:53.185115 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: Close
[0m20:07:53.191090 [debug] [Thread-1 (]: Database Error in test not_null_stock_update_status_id (models\marts\stock\stock.yml)
  relation "public.stock_update_status" does not exist
  LINE 14: from "my_database"."public"."stock_update_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\stock\stock.yml\not_null_stock_update_status_id.sql
[0m20:07:53.193090 [error] [Thread-1 (]: 10 of 17 ERROR not_null_stock_update_status_id ................................. [[31mERROR[0m in 0.09s]
[0m20:07:53.194091 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:07:53.195088 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:53.196086 [info ] [Thread-1 (]: 11 of 17 START test source_not_null_public_customers_customer_id ............... [RUN]
[0m20:07:53.198088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stock_update_status_id.633bc8afe3, now test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f)
[0m20:07:53.198088 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:53.204608 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:53.213620 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (compile): 20:07:53.199087 => 20:07:53.212813
[0m20:07:53.213620 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:53.216614 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:53.225132 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:53.227155 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: BEGIN
[0m20:07:53.228137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.254152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.255143 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:07:53.256137 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:07:53.259263 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.262296 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (execute): 20:07:53.214607 => 20:07:53.262296
[0m20:07:53.263278 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: ROLLBACK
[0m20:07:53.265261 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: Close
[0m20:07:53.268260 [info ] [Thread-1 (]: 11 of 17 PASS source_not_null_public_customers_customer_id ..................... [[32mPASS[0m in 0.07s]
[0m20:07:53.270257 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:07:53.271261 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:53.272263 [info ] [Thread-1 (]: 12 of 17 START test source_not_null_public_ksql-company-stream_id .............. [RUN]
[0m20:07:53.274268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f, now test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0)
[0m20:07:53.275260 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:53.281259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:53.289266 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (compile): 20:07:53.276259 => 20:07:53.289266
[0m20:07:53.290264 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:53.293262 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:53.301781 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:53.303821 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: BEGIN
[0m20:07:53.304801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.335316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.337327 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:07:53.339316 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m20:07:53.343314 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.346839 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (execute): 20:07:53.291264 => 20:07:53.346839
[0m20:07:53.348354 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: ROLLBACK
[0m20:07:53.350876 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: Close
[0m20:07:53.353873 [info ] [Thread-1 (]: 12 of 17 PASS source_not_null_public_ksql-company-stream_id .................... [[32mPASS[0m in 0.08s]
[0m20:07:53.355872 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:07:53.356968 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:53.359499 [info ] [Thread-1 (]: 13 of 17 START test source_not_null_public_ksql-stock-stream_id ................ [RUN]
[0m20:07:53.362088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0, now test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8)
[0m20:07:53.363094 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:53.370958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:53.380006 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (compile): 20:07:53.364101 => 20:07:53.380006
[0m20:07:53.382540 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:53.387532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:53.396206 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:53.397207 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: BEGIN
[0m20:07:53.398203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.424778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.425813 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:07:53.426787 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m20:07:53.436615 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.443525 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (execute): 20:07:53.383539 => 20:07:53.442924
[0m20:07:53.445732 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: ROLLBACK
[0m20:07:53.449235 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: Close
[0m20:07:53.452569 [info ] [Thread-1 (]: 13 of 17 PASS source_not_null_public_ksql-stock-stream_id ...................... [[32mPASS[0m in 0.09s]
[0m20:07:53.454874 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:07:53.456501 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:53.457534 [info ] [Thread-1 (]: 14 of 17 START test source_not_null_public_orders_order_id ..................... [RUN]
[0m20:07:53.459679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8, now test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee)
[0m20:07:53.460216 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:53.470128 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:53.477121 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (compile): 20:07:53.461302 => 20:07:53.477121
[0m20:07:53.478567 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:53.482378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:53.489906 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:53.490905 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: BEGIN
[0m20:07:53.491904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.529510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.530521 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:07:53.531521 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "my_database"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m20:07:53.536061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.540686 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (execute): 20:07:53.479378 => 20:07:53.539675
[0m20:07:53.542729 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: ROLLBACK
[0m20:07:53.546174 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: Close
[0m20:07:53.549696 [info ] [Thread-1 (]: 14 of 17 PASS source_not_null_public_orders_order_id ........................... [[32mPASS[0m in 0.09s]
[0m20:07:53.552969 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:07:53.554258 [debug] [Thread-1 (]: Began running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:53.555884 [info ] [Thread-1 (]: 15 of 17 START test source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [RUN]
[0m20:07:53.558605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee, now test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5)
[0m20:07:53.559778 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:53.569624 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:53.578152 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (compile): 20:07:53.560835 => 20:07:53.578152
[0m20:07:53.580079 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:53.584093 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:53.592143 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:53.593182 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: BEGIN
[0m20:07:53.593182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.619654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.620655 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:07:53.620655 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "my_database"."public"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "my_database"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:07:53.624655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.627654 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (execute): 20:07:53.581092 => 20:07:53.626658
[0m20:07:53.628196 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: ROLLBACK
[0m20:07:53.630213 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: Close
[0m20:07:53.633737 [info ] [Thread-1 (]: 15 of 17 PASS source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [[32mPASS[0m in 0.08s]
[0m20:07:53.635734 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:07:53.636730 [debug] [Thread-1 (]: Began running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:53.637736 [info ] [Thread-1 (]: 16 of 17 START test source_unique_public_orders_order_id ....................... [RUN]
[0m20:07:53.639736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5, now test.dbt_project.source_unique_public_orders_order_id.95035364f0)
[0m20:07:53.640449 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:53.655477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:53.664694 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (compile): 20:07:53.641460 => 20:07:53.663695
[0m20:07:53.664694 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:53.668696 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:53.677297 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:53.677297 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: BEGIN
[0m20:07:53.678295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.701906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.702906 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:07:53.704909 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_unique_public_orders_order_id.95035364f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:07:53.707930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:07:53.710937 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (execute): 20:07:53.665694 => 20:07:53.710937
[0m20:07:53.711938 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: ROLLBACK
[0m20:07:53.713940 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: Close
[0m20:07:53.715673 [info ] [Thread-1 (]: 16 of 17 PASS source_unique_public_orders_order_id ............................. [[32mPASS[0m in 0.08s]
[0m20:07:53.718678 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:07:53.719685 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:53.721682 [info ] [Thread-1 (]: 17 of 17 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m20:07:53.722679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_unique_public_orders_order_id.95035364f0, now test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee)
[0m20:07:53.723679 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:53.730720 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:53.739721 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (compile): 20:07:53.725194 => 20:07:53.739721
[0m20:07:53.740720 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:53.744225 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:53.750748 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:53.751747 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m20:07:53.752747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:53.777597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.778598 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:07:53.779598 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."public"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:07:53.783622 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.customer_orders_status" does not exist
LINE 15: from "my_database"."public"."customer_orders_status"
              ^

[0m20:07:53.784627 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m20:07:53.787630 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (execute): 20:07:53.741721 => 20:07:53.787630
[0m20:07:53.789137 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m20:07:53.795150 [debug] [Thread-1 (]: Database Error in test unique_customer_orders_status_order_id (models\marts\marketing\marketing.yml)
  relation "public.customer_orders_status" does not exist
  LINE 15: from "my_database"."public"."customer_orders_status"
                ^
  compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\unique_customer_orders_status_order_id.sql
[0m20:07:53.796152 [error] [Thread-1 (]: 17 of 17 ERROR unique_customer_orders_status_order_id .......................... [[31mERROR[0m in 0.07s]
[0m20:07:53.797161 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:07:53.800674 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:53.801686 [debug] [MainThread]: On master: BEGIN
[0m20:07:53.801686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:53.830080 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:53.831066 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.831066 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:53.832071 [debug] [MainThread]: On master: COMMIT
[0m20:07:53.835066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:53.836067 [debug] [MainThread]: On master: Close
[0m20:07:53.837066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:53.839069 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:07:53.840069 [debug] [MainThread]: Connection 'test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m20:07:53.841067 [info ] [MainThread]: 
[0m20:07:53.843068 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m20:07:53.848934 [debug] [MainThread]: Command end result
[0m20:07:53.885156 [info ] [MainThread]: 
[0m20:07:53.887174 [info ] [MainThread]: [31mCompleted with 11 errors and 0 warnings:[0m
[0m20:07:53.888151 [info ] [MainThread]: 
[0m20:07:53.890151 [error] [MainThread]: [33mDatabase Error in test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable (models\marts\marketing\marketing.yml)[0m
[0m20:07:53.891156 [error] [MainThread]:   relation "public.customer_orders_status" does not exist
[0m20:07:53.893154 [error] [MainThread]:   LINE 17:     from "my_database"."public"."customer_orders_status"
[0m20:07:53.894112 [error] [MainThread]:                     ^
[0m20:07:53.895120 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\accepted_values_customer_order_ff3347afd9206869995c975a52036ab8.sql
[0m20:07:53.896119 [info ] [MainThread]: 
[0m20:07:53.898119 [error] [MainThread]: [33mDatabase Error in test assert_customer_dimension_has_no_row_loss (tests\assert_customer_dimension_has_no_row_loss.sql)[0m
[0m20:07:53.899120 [error] [MainThread]:   relation "public.dim_customers" does not exist
[0m20:07:53.900121 [error] [MainThread]:   LINE 12:     from "my_database"."public"."dim_customers" dim_cust
[0m20:07:53.900629 [error] [MainThread]:                     ^
[0m20:07:53.901646 [error] [MainThread]:   compiled Code at target\run\dbt_project\tests\assert_customer_dimension_has_no_row_loss.sql
[0m20:07:53.902637 [info ] [MainThread]: 
[0m20:07:53.903638 [error] [MainThread]: [33mDatabase Error in test assert_stock_fact_has_no_row_loss (tests\assert_stock_fact_has_no_row_loss.sql)[0m
[0m20:07:53.904637 [error] [MainThread]:   relation "public.fact_stocks" does not exist
[0m20:07:53.906636 [error] [MainThread]:   LINE 12:     from "my_database"."public"."fact_stocks" stock
[0m20:07:53.907636 [error] [MainThread]:                     ^
[0m20:07:53.908636 [error] [MainThread]:   compiled Code at target\run\dbt_project\tests\assert_stock_fact_has_no_row_loss.sql
[0m20:07:53.909651 [info ] [MainThread]: 
[0m20:07:53.910636 [error] [MainThread]: [33mDatabase Error in test not_null_customer_orders_status_customer_id (models\marts\marketing\marketing.yml)[0m
[0m20:07:53.912641 [error] [MainThread]:   relation "public.customer_orders_status" does not exist
[0m20:07:53.913640 [error] [MainThread]:   LINE 14: from "my_database"."public"."customer_orders_status"
[0m20:07:53.914640 [error] [MainThread]:                 ^
[0m20:07:53.916152 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\not_null_customer_orders_status_customer_id.sql
[0m20:07:53.917176 [info ] [MainThread]: 
[0m20:07:53.918168 [error] [MainThread]: [33mDatabase Error in test not_null_dim_customers_customer_id (models\marts\core\core.yml)[0m
[0m20:07:53.920180 [error] [MainThread]:   relation "public.dim_customers" does not exist
[0m20:07:53.921160 [error] [MainThread]:   LINE 14: from "my_database"."public"."dim_customers"
[0m20:07:53.923166 [error] [MainThread]:                 ^
[0m20:07:53.924169 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_dim_customers_customer_id.sql
[0m20:07:53.925166 [info ] [MainThread]: 
[0m20:07:53.927180 [error] [MainThread]: [33mDatabase Error in test not_null_fact_stocks_id (models\marts\core\core.yml)[0m
[0m20:07:53.928177 [error] [MainThread]:   relation "public.fact_stocks" does not exist
[0m20:07:53.929166 [error] [MainThread]:   LINE 14: from "my_database"."public"."fact_stocks"
[0m20:07:53.930162 [error] [MainThread]:                 ^
[0m20:07:53.931166 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\core\core.yml\not_null_fact_stocks_id.sql
[0m20:07:53.932260 [info ] [MainThread]: 
[0m20:07:53.934164 [error] [MainThread]: [33mDatabase Error in test not_null_stg_eltool__company_id (models\staging\stg_eltool.yml)[0m
[0m20:07:53.935165 [error] [MainThread]:   relation "public.stg_eltool__company" does not exist
[0m20:07:53.936196 [error] [MainThread]:   LINE 14: from "my_database"."public"."stg_eltool__company"
[0m20:07:53.937169 [error] [MainThread]:                 ^
[0m20:07:53.938164 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__company_id.sql
[0m20:07:53.939171 [info ] [MainThread]: 
[0m20:07:53.941699 [error] [MainThread]: [33mDatabase Error in test not_null_stg_eltool__customers_snapshots_customer_id (models\staging\stg_eltool.yml)[0m
[0m20:07:53.942703 [error] [MainThread]:   relation "public.stg_eltool__customers_snapshots" does not exist
[0m20:07:53.944728 [error] [MainThread]:   LINE 14: from "my_database"."public"."stg_eltool__customers_snapshots...
[0m20:07:53.945720 [error] [MainThread]:                 ^
[0m20:07:53.947719 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__customers_snapshots_customer_id.sql
[0m20:07:53.948740 [info ] [MainThread]: 
[0m20:07:53.949720 [error] [MainThread]: [33mDatabase Error in test not_null_stg_eltool__stock_id (models\staging\stg_eltool.yml)[0m
[0m20:07:53.951735 [error] [MainThread]:   relation "public.stg_eltool__stock" does not exist
[0m20:07:53.952733 [error] [MainThread]:   LINE 14: from "my_database"."public"."stg_eltool__stock"
[0m20:07:53.954721 [error] [MainThread]:                 ^
[0m20:07:53.955721 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool.yml\not_null_stg_eltool__stock_id.sql
[0m20:07:53.956719 [info ] [MainThread]: 
[0m20:07:53.957720 [error] [MainThread]: [33mDatabase Error in test not_null_stock_update_status_id (models\marts\stock\stock.yml)[0m
[0m20:07:53.959225 [error] [MainThread]:   relation "public.stock_update_status" does not exist
[0m20:07:53.959753 [error] [MainThread]:   LINE 14: from "my_database"."public"."stock_update_status"
[0m20:07:53.960772 [error] [MainThread]:                 ^
[0m20:07:53.961760 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\stock\stock.yml\not_null_stock_update_status_id.sql
[0m20:07:53.962759 [info ] [MainThread]: 
[0m20:07:53.963761 [error] [MainThread]: [33mDatabase Error in test unique_customer_orders_status_order_id (models\marts\marketing\marketing.yml)[0m
[0m20:07:53.964761 [error] [MainThread]:   relation "public.customer_orders_status" does not exist
[0m20:07:53.965760 [error] [MainThread]:   LINE 15: from "my_database"."public"."customer_orders_status"
[0m20:07:53.966760 [error] [MainThread]:                 ^
[0m20:07:53.967763 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\marts\marketing\marketing.yml\unique_customer_orders_status_order_id.sql
[0m20:07:53.969766 [info ] [MainThread]: 
[0m20:07:53.971727 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=11 SKIP=0 TOTAL=17
[0m20:07:53.972740 [debug] [MainThread]: Command `dbt test` failed at 20:07:53.972740 after 2.99 seconds
[0m20:07:53.973739 [debug] [MainThread]: Flushing usage events


============================== 20:09:52.461709 | 6c81b6bb-a900-45b1-aabd-2e3f313b0804 ==============================
[0m20:09:52.461709 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:09:52.466708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:09:52.596090 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:09:52.606652 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:09:52.776405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:52.777402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:52.823727 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:09:52.826213 [info ] [MainThread]: 
[0m20:09:52.828220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:52.831834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:09:52.843454 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:09:52.843454 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:09:52.844450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:52.885146 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:09:52.887713 [debug] [ThreadPool]: On list_my_database: Close
[0m20:09:52.891679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:09:52.899954 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:09:52.899954 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:09:52.900954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:52.925659 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:09:52.926678 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:09:52.927700 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:09:52.932662 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:09:52.934693 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:09:52.936072 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:09:52.938083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:09:52.942086 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:09:52.943106 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:09:52.943106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:52.965582 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:09:52.965582 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:09:52.966615 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:09:52.970580 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:09:52.972617 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:09:52.974580 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:09:52.982615 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:52.983581 [debug] [MainThread]: On master: BEGIN
[0m20:09:52.983581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:53.005241 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.006225 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:53.007226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:09:53.013965 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m20:09:53.016974 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:53.018976 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:53.020001 [debug] [MainThread]: On master: BEGIN
[0m20:09:53.022983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.022983 [debug] [MainThread]: On master: COMMIT
[0m20:09:53.023981 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:53.025008 [debug] [MainThread]: On master: COMMIT
[0m20:09:53.025977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.026975 [debug] [MainThread]: On master: Close
[0m20:09:53.027974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:53.029976 [info ] [MainThread]: 
[0m20:09:53.035029 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:09:53.036064 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:09:53.037040 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:09:53.038040 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:09:53.047077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:09:53.054384 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:09:53.039044 => 20:09:53.054384
[0m20:09:53.055416 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:09:53.093456 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:09:53.099329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:09:53.100348 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:09:53.100348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:53.122350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.123378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:09:53.124384 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:09:53.128344 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.134378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:09:53.135345 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:09:53.137358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.151378 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:09:53.152379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:09:53.153361 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:09:53.157347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.167386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:09:53.168346 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:09:53.170653 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.171701 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:09:53.056394 => 20:09:53.171701
[0m20:09:53.172709 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:09:53.174666 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:09:53.176664 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:09:53.177675 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:09:53.178664 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:09:53.180701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:09:53.181666 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:09:53.185665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:09:53.192709 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:09:53.182689 => 20:09:53.191706
[0m20:09:53.192709 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:09:53.197704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:09:53.205241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:09:53.206249 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:09:53.207251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.235249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.236241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:09:53.236241 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:09:53.242268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.245265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:09:53.246277 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:09:53.249247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.251264 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:09:53.252265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:09:53.253258 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:09:53.257243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.262269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:09:53.263552 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:09:53.265555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.267575 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:09:53.193708 => 20:09:53.267575
[0m20:09:53.268577 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:09:53.270556 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:09:53.273556 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:09:53.275552 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:09:53.276549 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:09:53.277561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:09:53.278556 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:09:53.281585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:09:53.288627 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:09:53.278556 => 20:09:53.287597
[0m20:09:53.289634 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:09:53.293668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:09:53.299668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:09:53.300669 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:09:53.301634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.324535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.325546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:09:53.325546 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:09:53.328546 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "snapshots.customers_snapshot" does not exist
LINE 8:                 from "my_database"."snapshots"."customers_sn...
                             ^

[0m20:09:53.329546 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: ROLLBACK
[0m20:09:53.331438 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:09:53.289634 => 20:09:53.331438
[0m20:09:53.332439 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:09:53.345511 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)
  relation "snapshots.customers_snapshot" does not exist
  LINE 8:                 from "my_database"."snapshots"."customers_sn...
                               ^
  compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:09:53.346487 [error] [Thread-1 (]: 3 of 11 ERROR creating sql view model public.stg_eltool__customers_snapshots ... [[31mERROR[0m in 0.07s]
[0m20:09:53.348517 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:09:53.349485 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:09:53.349485 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:09:53.351509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:09:53.352484 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:09:53.354483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:09:53.365520 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:09:53.352484 => 20:09:53.364485
[0m20:09:53.365520 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:09:53.373490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:09:53.386511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:09:53.387492 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:09:53.388489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.411086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.412115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:09:53.413114 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:09:53.420082 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.424084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:09:53.425100 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:09:53.428084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.431084 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:09:53.431084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:09:53.432658 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:09:53.436098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.440664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:09:53.441676 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:09:53.444658 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.446663 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:09:53.366521 => 20:09:53.446663
[0m20:09:53.448312 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:09:53.450747 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:09:53.453517 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:09:53.454712 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:09:53.456365 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:09:53.457540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:09:53.458665 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:09:53.462182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:09:53.470191 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:09:53.459293 => 20:09:53.470191
[0m20:09:53.471226 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:09:53.476223 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:09:53.483193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:09:53.484227 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:09:53.485198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.506520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.507543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:09:53.508524 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:09:53.512540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.516543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:09:53.516543 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:09:53.519164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.521196 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:09:53.522164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:09:53.522164 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:09:53.526639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.529665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:09:53.530663 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:09:53.532639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.534663 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:09:53.472204 => 20:09:53.534663
[0m20:09:53.535638 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:09:53.536640 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:09:53.539640 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:09:53.540656 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:09:53.541655 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:09:53.542642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:09:53.543639 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:09:53.546671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:09:53.553645 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:09:53.544656 => 20:09:53.553645
[0m20:09:53.554650 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:09:53.560638 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:09:53.568238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:09:53.569214 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:09:53.570255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.593916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.594921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:09:53.595939 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:09:53.599898 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.605450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:09:53.605450 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:09:53.609337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.612176 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:09:53.612830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:09:53.613909 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:09:53.617948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.621886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:09:53.622773 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:09:53.624775 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.626772 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:09:53.555639 => 20:09:53.626772
[0m20:09:53.627772 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:09:53.630318 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:09:53.632319 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:09:53.634323 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:09:53.635330 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:09:53.636350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:09:53.638317 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:09:53.641352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:09:53.647083 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:09:53.638317 => 20:09:53.647083
[0m20:09:53.649600 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:09:53.656602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:09:53.665599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:09:53.666599 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:09:53.667600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.694669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.695637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:09:53.696668 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:09:53.702657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.706813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:09:53.707791 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:09:53.710780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.713755 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:09:53.714754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:09:53.715757 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:09:53.719770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.723791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:09:53.724755 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:09:53.727760 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.729791 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:09:53.650599 => 20:09:53.729791
[0m20:09:53.730791 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:09:53.732758 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:09:53.734756 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:09:53.736787 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:09:53.737757 [info ] [Thread-1 (]: 8 of 11 SKIP relation public.dim_customers ..................................... [[33mSKIP[0m]
[0m20:09:53.738756 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:09:53.739775 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:09:53.740791 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:09:53.741769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.fact_stocks)
[0m20:09:53.742757 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:09:53.746754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:09:53.753760 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:09:53.743754 => 20:09:53.753760
[0m20:09:53.754757 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:09:53.760757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:09:53.767755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:09:53.768755 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:09:53.768755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.794814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.795822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:09:53.796840 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:09:53.800784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.805297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:09:53.805297 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:09:53.808312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.810334 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:09:53.811353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:09:53.812299 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:09:53.816303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.819297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:09:53.821303 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:09:53.823362 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.825297 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:09:53.755754 => 20:09:53.825297
[0m20:09:53.826297 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:09:53.828299 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:09:53.830297 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:09:53.832332 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:09:53.833306 [info ] [Thread-1 (]: 10 of 11 SKIP relation public.customer_orders_status ........................... [[33mSKIP[0m]
[0m20:09:53.834313 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:09:53.835309 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:09:53.836303 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:09:53.839297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_stocks, now model.dbt_project.stock_update_status)
[0m20:09:53.839297 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stock_update_status
[0m20:09:53.843298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stock_update_status"
[0m20:09:53.848303 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (compile): 20:09:53.840298 => 20:09:53.848303
[0m20:09:53.849296 [debug] [Thread-1 (]: Began executing node model.dbt_project.stock_update_status
[0m20:09:53.855297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stock_update_status"
[0m20:09:53.859300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:09:53.860339 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: BEGIN
[0m20:09:53.861333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:53.885304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.886296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:09:53.887316 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:09:53.892313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:09:53.897304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:09:53.898318 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:09:53.901321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:53.904854 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:09:53.905878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:09:53.905878 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:09:53.910854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.915171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:09:53.915855 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:09:53.918156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:09:53.920197 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (execute): 20:09:53.850296 => 20:09:53.920197
[0m20:09:53.921207 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: Close
[0m20:09:53.923178 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:09:53.925226 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:09:53.929226 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:53.930240 [debug] [MainThread]: On master: BEGIN
[0m20:09:53.931222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:53.961321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:53.962326 [debug] [MainThread]: On master: COMMIT
[0m20:09:53.963325 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:53.964323 [debug] [MainThread]: On master: COMMIT
[0m20:09:53.967332 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:09:53.969336 [debug] [MainThread]: On master: Close
[0m20:09:53.970862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:53.971878 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:09:53.973863 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:09:53.974877 [debug] [MainThread]: Connection 'model.dbt_project.stock_update_status' was properly closed.
[0m20:09:53.975871 [info ] [MainThread]: 
[0m20:09:53.976862 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m20:09:53.980859 [debug] [MainThread]: Command end result
[0m20:09:54.014810 [info ] [MainThread]: 
[0m20:09:54.015814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:09:54.016810 [info ] [MainThread]: 
[0m20:09:54.018827 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers_snapshots (models\staging\stg_eltool__customers_snapshots.sql)[0m
[0m20:09:54.018827 [error] [MainThread]:   relation "snapshots.customers_snapshot" does not exist
[0m20:09:54.020821 [error] [MainThread]:   LINE 8:                 from "my_database"."snapshots"."customers_sn...
[0m20:09:54.021814 [error] [MainThread]:                                ^
[0m20:09:54.022835 [error] [MainThread]:   compiled Code at target\run\dbt_project\models\staging\stg_eltool__customers_snapshots.sql
[0m20:09:54.023814 [info ] [MainThread]: 
[0m20:09:54.025306 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=2 TOTAL=11
[0m20:09:54.026825 [debug] [MainThread]: Command `dbt run` failed at 20:09:54.026825 after 1.60 seconds
[0m20:09:54.027817 [debug] [MainThread]: Flushing usage events


============================== 20:10:14.840227 | ed1e1510-5ee3-4f14-9c95-740992dc015b ==============================
[0m20:10:14.840227 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:10:14.847180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m20:10:15.055537 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:10:15.070541 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:10:15.267436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:15.267436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:15.333731 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:10:15.337242 [info ] [MainThread]: 
[0m20:10:15.339244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:15.343253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:10:15.358450 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:10:15.359471 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:10:15.360450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:15.395731 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:10:15.398708 [debug] [ThreadPool]: On list_my_database: Close
[0m20:10:15.402718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:10:15.411221 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:15.412218 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:10:15.413222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:15.436842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.438830 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:15.441244 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:10:15.449870 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:10:15.454869 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:10:15.458148 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:10:15.461556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:10:15.471937 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:15.472941 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:10:15.473935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:15.570211 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.571201 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:15.572208 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:10:15.579200 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:10:15.582208 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:10:15.586170 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:10:15.598964 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.599597 [debug] [MainThread]: On master: BEGIN
[0m20:10:15.600228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:15.628751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.629784 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.630750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:10:15.639743 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:10:15.646368 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:15.649347 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.649347 [debug] [MainThread]: On master: BEGIN
[0m20:10:15.654336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.655341 [debug] [MainThread]: On master: COMMIT
[0m20:10:15.656345 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.657332 [debug] [MainThread]: On master: COMMIT
[0m20:10:15.659350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:15.660336 [debug] [MainThread]: On master: Close
[0m20:10:15.662339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:15.663854 [info ] [MainThread]: 
[0m20:10:15.671263 [debug] [Thread-1 (]: Began running node snapshot.dbt_project.customers_snapshot
[0m20:10:15.672504 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m20:10:15.674249 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_project.customers_snapshot'
[0m20:10:15.674249 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_project.customers_snapshot
[0m20:10:15.686026 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (compile): 20:10:15.675250 => 20:10:15.686026
[0m20:10:15.687024 [debug] [Thread-1 (]: Began executing node snapshot.dbt_project.customers_snapshot
[0m20:10:15.753629 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_project.customers_snapshot"
[0m20:10:15.759869 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:10:15.760182 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: BEGIN
[0m20:10:15.761172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:15.788223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.789222 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:10:15.790260 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_project.customers_snapshot"} */

      
  
    

  create  table "my_database"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "my_database"."public"."customers"

    ) sbq



  );
  
  
[0m20:10:15.806784 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:10:15.836366 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: COMMIT
[0m20:10:15.837376 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:10:15.838378 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: COMMIT
[0m20:10:15.842558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:15.845558 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (execute): 20:10:15.687999 => 20:10:15.844557
[0m20:10:15.846557 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: Close
[0m20:10:15.849558 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.18s]
[0m20:10:15.852559 [debug] [Thread-1 (]: Finished running node snapshot.dbt_project.customers_snapshot
[0m20:10:15.855560 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.856571 [debug] [MainThread]: On master: BEGIN
[0m20:10:15.857590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:15.888644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:15.889621 [debug] [MainThread]: On master: COMMIT
[0m20:10:15.890620 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:15.891639 [debug] [MainThread]: On master: COMMIT
[0m20:10:15.894618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:15.894618 [debug] [MainThread]: On master: Close
[0m20:10:15.897142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:15.898146 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:10:15.899158 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:10:15.900142 [debug] [MainThread]: Connection 'snapshot.dbt_project.customers_snapshot' was properly closed.
[0m20:10:15.901158 [info ] [MainThread]: 
[0m20:10:15.902147 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:10:15.904142 [debug] [MainThread]: Command end result
[0m20:10:15.937786 [info ] [MainThread]: 
[0m20:10:15.939816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:15.941327 [info ] [MainThread]: 
[0m20:10:15.942354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:15.944334 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:10:15.943362 after 1.15 seconds
[0m20:10:15.944334 [debug] [MainThread]: Flushing usage events


============================== 20:10:22.784722 | 1a6dc29c-e7fa-406f-a92c-f207466a0391 ==============================
[0m20:10:22.784722 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:10:22.789747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m20:10:22.918318 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:10:22.931329 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:10:23.132333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:23.133326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:23.191405 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:10:23.193439 [info ] [MainThread]: 
[0m20:10:23.195445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:23.198454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:10:23.208403 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:10:23.209442 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:10:23.210403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:23.242178 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:10:23.243156 [debug] [ThreadPool]: On list_my_database: Close
[0m20:10:23.247672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:10:23.254670 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:23.254670 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:10:23.255671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:23.277173 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.278174 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:23.278174 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:10:23.283174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:23.285209 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:10:23.287174 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:10:23.289174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:10:23.293173 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:23.293173 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:10:23.294170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:23.316053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.317085 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:23.318084 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:10:23.323050 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:10:23.324061 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:10:23.326075 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:10:23.335109 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:23.335109 [debug] [MainThread]: On master: BEGIN
[0m20:10:23.336111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:23.357623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.358604 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:23.358604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:10:23.367607 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:10:23.373223 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:23.375195 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:23.376191 [debug] [MainThread]: On master: BEGIN
[0m20:10:23.379139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.380126 [debug] [MainThread]: On master: COMMIT
[0m20:10:23.380126 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:23.381161 [debug] [MainThread]: On master: COMMIT
[0m20:10:23.383059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.383059 [debug] [MainThread]: On master: Close
[0m20:10:23.385088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:23.386095 [info ] [MainThread]: 
[0m20:10:23.392117 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:10:23.393801 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:10:23.394802 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:10:23.395791 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:10:23.403791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:10:23.410788 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:10:23.396791 => 20:10:23.409788
[0m20:10:23.410788 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:10:23.456497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:10:23.462783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.462783 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:10:23.463790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:23.484715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.485714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.486714 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:10:23.490715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.497750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.498713 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:10:23.501750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.504749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.505713 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:10:23.507714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.526749 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:10:23.527755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.528720 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:10:23.531742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.540762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:10:23.540762 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:10:23.546309 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:23.548346 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:10:23.411824 => 20:10:23.548346
[0m20:10:23.549309 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:10:23.551311 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:10:23.553309 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:10:23.554312 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:10:23.555311 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:10:23.556366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:10:23.557345 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:10:23.560345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:10:23.566310 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:10:23.558308 => 20:10:23.565349
[0m20:10:23.566310 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:10:23.572346 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:10:23.578585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.579587 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:10:23.580585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.605801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.606744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.607423 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:10:23.611186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.614753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.615729 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:10:23.617751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.620761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.621759 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:10:23.623734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.625763 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:10:23.626766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.627735 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:10:23.630771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.633792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:10:23.634795 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:10:23.638768 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:23.640766 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:10:23.567344 => 20:10:23.639768
[0m20:10:23.641775 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:10:23.644287 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:10:23.646306 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:10:23.647298 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:10:23.648295 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:10:23.650615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:10:23.651298 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:10:23.654344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.661688 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:10:23.651298 => 20:10:23.661688
[0m20:10:23.662679 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:10:23.668686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.675666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.677090 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:10:23.677090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.700423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.700423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.701423 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:10:23.706422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.710423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.712424 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:10:23.714419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.716455 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:10:23.717456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.718453 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:10:23.721400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.724395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:10:23.725395 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:10:23.727397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:23.729397 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:10:23.663661 => 20:10:23.729397
[0m20:10:23.730413 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:10:23.732427 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.08s]
[0m20:10:23.733408 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:10:23.734410 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:10:23.735404 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:10:23.737403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:10:23.738408 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:10:23.741403 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:10:23.752445 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:10:23.739403 => 20:10:23.752445
[0m20:10:23.753445 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:10:23.758446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:10:23.769648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.770649 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:10:23.771634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.794267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.795258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.796260 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:10:23.800257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.803284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.804261 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:10:23.806259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.809281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.810281 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:10:23.813259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.815284 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:10:23.816266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.816266 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:10:23.820257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.823285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:10:23.824257 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:10:23.827284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:23.830278 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:10:23.754467 => 20:10:23.830278
[0m20:10:23.831291 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:10:23.833301 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:10:23.835280 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:10:23.836278 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:10:23.837277 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:10:23.838287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:10:23.839277 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:10:23.842275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:10:23.848649 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:10:23.839277 => 20:10:23.847687
[0m20:10:23.849646 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:10:23.853680 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:10:23.859684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.860681 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:10:23.861681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.883533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.884569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.885568 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:10:23.888532 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.892554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.893527 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:10:23.895344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.899378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.900351 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:10:23.902343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:23.904345 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:10:23.904345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.905378 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:10:23.909041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:23.912056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:10:23.913034 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:10:23.916018 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:23.919029 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:10:23.849646 => 20:10:23.918027
[0m20:10:23.919029 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:10:23.922018 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:10:23.923044 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:10:23.924020 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:10:23.925018 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:10:23.927019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:10:23.927019 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:10:23.930049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:10:23.935963 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:10:23.928018 => 20:10:23.935963
[0m20:10:23.936965 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:10:23.942965 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:10:23.949477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:23.950475 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:10:23.950475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:23.977413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:23.978414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:23.980413 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:10:23.986030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:23.992038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:23.993547 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:10:23.996558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.001589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:24.001589 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:10:24.004565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.007558 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:10:24.008576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:24.008576 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:10:24.012585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.016591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:10:24.017555 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:10:24.020943 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.022933 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:10:23.937952 => 20:10:24.022933
[0m20:10:24.023948 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:10:24.025935 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:10:24.026954 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:10:24.027932 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:10:24.028932 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:10:24.029939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:10:24.030977 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:10:24.034946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:10:24.041938 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:10:24.031971 => 20:10:24.041938
[0m20:10:24.042943 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:10:24.047490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:10:24.053792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:10:24.054790 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:10:24.054790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:24.077807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.078788 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:10:24.078788 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:10:24.082795 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:24.085828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:10:24.086848 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:10:24.089790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.091793 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:10:24.092793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:10:24.093799 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:10:24.097828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.100856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:10:24.101876 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:10:24.104038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.105061 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:10:24.042943 => 20:10:24.105061
[0m20:10:24.106064 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:10:24.108030 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:10:24.110059 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:10:24.111050 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:10:24.112058 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:10:24.114062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.dim_customers)
[0m20:10:24.115029 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m20:10:24.121055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m20:10:24.126033 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (compile): 20:10:24.116029 => 20:10:24.126033
[0m20:10:24.127033 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m20:10:24.133045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m20:10:24.137076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:10:24.139047 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m20:10:24.140070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:24.165190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.166217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:10:24.167213 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:10:24.173227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:24.176230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:10:24.177238 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:10:24.180710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.183723 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:10:24.185724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:10:24.186726 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:10:24.191738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.196722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:10:24.198727 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:10:24.201726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.205252 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (execute): 20:10:24.128032 => 20:10:24.205252
[0m20:10:24.206267 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m20:10:24.208253 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:10:24.211817 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:10:24.213842 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:10:24.215812 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:10:24.217815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customers, now model.dbt_project.fact_stocks)
[0m20:10:24.218803 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:10:24.223070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:10:24.229802 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:10:24.219867 => 20:10:24.229802
[0m20:10:24.231320 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:10:24.239332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:10:24.247860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:10:24.248893 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:10:24.249861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:24.274941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.275941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:10:24.275941 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:10:24.279945 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:24.283941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:10:24.284942 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:10:24.286994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.289941 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:10:24.290940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:10:24.291452 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:10:24.294466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.299464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:10:24.300464 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:10:24.302465 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.304460 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:10:24.232339 => 20:10:24.304460
[0m20:10:24.304460 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:10:24.307029 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:10:24.309037 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:10:24.310022 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:10:24.312196 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:10:24.314226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_stocks, now model.dbt_project.customer_orders_status)
[0m20:10:24.315221 [debug] [Thread-1 (]: Began compiling node model.dbt_project.customer_orders_status
[0m20:10:24.319226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.customer_orders_status"
[0m20:10:24.324291 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (compile): 20:10:24.316195 => 20:10:24.324291
[0m20:10:24.325270 [debug] [Thread-1 (]: Began executing node model.dbt_project.customer_orders_status
[0m20:10:24.330928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.customer_orders_status"
[0m20:10:24.335910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:10:24.335910 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: BEGIN
[0m20:10:24.336932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:24.363415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.364439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:10:24.365441 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:10:24.370409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:24.374410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:10:24.375408 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:10:24.378445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.380441 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:10:24.380441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:10:24.381444 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:10:24.384420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.388418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:10:24.389418 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:10:24.391433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.393417 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (execute): 20:10:24.326270 => 20:10:24.393417
[0m20:10:24.394416 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: Close
[0m20:10:24.396436 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:10:24.398419 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:10:24.399419 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:10:24.401428 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:10:24.402418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.customer_orders_status, now model.dbt_project.stock_update_status)
[0m20:10:24.403417 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stock_update_status
[0m20:10:24.407416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stock_update_status"
[0m20:10:24.415164 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (compile): 20:10:24.404417 => 20:10:24.414167
[0m20:10:24.415164 [debug] [Thread-1 (]: Began executing node model.dbt_project.stock_update_status
[0m20:10:24.422161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stock_update_status"
[0m20:10:24.427831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:10:24.428821 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: BEGIN
[0m20:10:24.429796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:24.452373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.453379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:10:24.454376 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:10:24.458388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:10:24.462387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:10:24.462387 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:10:24.465364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:10:24.467389 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:10:24.468359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:10:24.469366 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:10:24.474363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.477391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:10:24.478389 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:10:24.480363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:10:24.482394 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (execute): 20:10:24.416155 => 20:10:24.482394
[0m20:10:24.483385 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: Close
[0m20:10:24.485357 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:10:24.487372 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:10:24.490365 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:24.491390 [debug] [MainThread]: On master: BEGIN
[0m20:10:24.492388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:24.518367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:24.519356 [debug] [MainThread]: On master: COMMIT
[0m20:10:24.519356 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:24.520354 [debug] [MainThread]: On master: COMMIT
[0m20:10:24.523353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:24.524354 [debug] [MainThread]: On master: Close
[0m20:10:24.525356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:24.527361 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:10:24.528356 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:10:24.529377 [debug] [MainThread]: Connection 'model.dbt_project.stock_update_status' was properly closed.
[0m20:10:24.530394 [info ] [MainThread]: 
[0m20:10:24.531417 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m20:10:24.535420 [debug] [MainThread]: Command end result
[0m20:10:24.602229 [info ] [MainThread]: 
[0m20:10:24.603039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:24.604085 [info ] [MainThread]: 
[0m20:10:24.605051 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:10:24.606115 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:24.606115 after 1.86 seconds
[0m20:10:24.607075 [debug] [MainThread]: Flushing usage events


============================== 20:10:30.371965 | 19da4b27-2587-4801-80b6-a485becde1b0 ==============================
[0m20:10:30.371965 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:10:30.376928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:10:30.507553 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:10:30.516544 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:10:30.665850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:30.665850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:30.706860 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:10:30.709862 [info ] [MainThread]: 
[0m20:10:30.712837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:30.717835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:10:30.728859 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:30.729860 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:10:30.729860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:30.774557 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:30.775572 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:10:30.776555 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:10:30.780582 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:30.782614 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:10:30.784654 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:10:30.786686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:10:30.789708 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:30.790680 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:10:30.790680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:30.847123 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:30.848137 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:10:30.849152 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:10:30.854958 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:10:30.856958 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:10:30.859992 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:10:30.871511 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:30.872512 [debug] [MainThread]: On master: BEGIN
[0m20:10:30.873517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:30.898696 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:30.900041 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:30.901716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:10:30.915251 [debug] [MainThread]: SQL status: SELECT 19 in 0.0 seconds
[0m20:10:30.922213 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:30.924374 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:30.924374 [debug] [MainThread]: On master: BEGIN
[0m20:10:30.928030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:30.929021 [debug] [MainThread]: On master: COMMIT
[0m20:10:30.930004 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:30.931004 [debug] [MainThread]: On master: COMMIT
[0m20:10:30.932007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:30.933029 [debug] [MainThread]: On master: Close
[0m20:10:30.934007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:30.936020 [info ] [MainThread]: 
[0m20:10:30.942015 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:10:30.943040 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m20:10:30.944016 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m20:10:30.945020 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:10:30.965643 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:10:30.973047 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 20:10:30.945020 => 20:10:30.972073
[0m20:10:30.974038 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:10:30.988038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:10:30.994470 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:10:30.995460 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m20:10:30.996443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:31.018093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.019122 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m20:10:31.020105 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "my_database"."public"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m20:10:31.026722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.029533 [debug] [Thread-1 (]: Timing info for test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 20:10:30.975041 => 20:10:31.029533
[0m20:10:31.030643 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m20:10:31.032840 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m20:10:31.034605 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m20:10:31.036963 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m20:10:31.037514 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:10:31.038578 [info ] [Thread-1 (]: 2 of 17 START test assert_customer_dimension_has_no_row_loss ................... [RUN]
[0m20:10:31.039522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_project.assert_customer_dimension_has_no_row_loss)
[0m20:10:31.040556 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:10:31.044556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:10:31.050523 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (compile): 20:10:31.041528 => 20:10:31.049556
[0m20:10:31.051525 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:10:31.057660 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:10:31.065659 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:10:31.066723 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: BEGIN
[0m20:10:31.067658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.089977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.090977 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_customer_dimension_has_no_row_loss"
[0m20:10:31.090977 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_customer_dimension_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "my_database"."public"."dim_customers" dim_cust
        left join "my_database"."public"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "my_database"."public"."stg_eltool__customers_snapshots" stg_cust
      left join "my_database"."public"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m20:10:31.095979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.097977 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_customer_dimension_has_no_row_loss (execute): 20:10:31.052524 => 20:10:31.097977
[0m20:10:31.098996 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: ROLLBACK
[0m20:10:31.100977 [debug] [Thread-1 (]: On test.dbt_project.assert_customer_dimension_has_no_row_loss: Close
[0m20:10:31.102981 [info ] [Thread-1 (]: 2 of 17 PASS assert_customer_dimension_has_no_row_loss ......................... [[32mPASS[0m in 0.06s]
[0m20:10:31.104980 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_customer_dimension_has_no_row_loss
[0m20:10:31.105996 [debug] [Thread-1 (]: Began running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:10:31.106977 [info ] [Thread-1 (]: 3 of 17 START test assert_stock_fact_has_no_row_loss ........................... [RUN]
[0m20:10:31.107977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_customer_dimension_has_no_row_loss, now test.dbt_project.assert_stock_fact_has_no_row_loss)
[0m20:10:31.108977 [debug] [Thread-1 (]: Began compiling node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:10:31.111977 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:10:31.118979 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (compile): 20:10:31.109977 => 20:10:31.118979
[0m20:10:31.119984 [debug] [Thread-1 (]: Began executing node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:10:31.124024 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:10:31.130769 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:10:31.131768 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: BEGIN
[0m20:10:31.132752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.155289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.156265 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.assert_stock_fact_has_no_row_loss"
[0m20:10:31.156265 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.assert_stock_fact_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "my_database"."public"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m20:10:31.164264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.166302 [debug] [Thread-1 (]: Timing info for test.dbt_project.assert_stock_fact_has_no_row_loss (execute): 20:10:31.121019 => 20:10:31.166302
[0m20:10:31.167288 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: ROLLBACK
[0m20:10:31.169126 [debug] [Thread-1 (]: On test.dbt_project.assert_stock_fact_has_no_row_loss: Close
[0m20:10:31.171135 [info ] [Thread-1 (]: 3 of 17 PASS assert_stock_fact_has_no_row_loss ................................. [[32mPASS[0m in 0.06s]
[0m20:10:31.173149 [debug] [Thread-1 (]: Finished running node test.dbt_project.assert_stock_fact_has_no_row_loss
[0m20:10:31.174655 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:10:31.174655 [info ] [Thread-1 (]: 4 of 17 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m20:10:31.176664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.assert_stock_fact_has_no_row_loss, now test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb)
[0m20:10:31.178663 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:10:31.186664 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:10:31.193128 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (compile): 20:10:31.179663 => 20:10:31.193128
[0m20:10:31.194091 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:10:31.197127 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:10:31.202802 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:10:31.203802 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m20:10:31.204804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.230969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.231999 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"
[0m20:10:31.232959 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m20:10:31.241002 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.242972 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb (execute): 20:10:31.195099 => 20:10:31.242972
[0m20:10:31.243973 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m20:10:31.246970 [debug] [Thread-1 (]: On test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m20:10:31.248977 [info ] [Thread-1 (]: 4 of 17 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.07s]
[0m20:10:31.251498 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb
[0m20:10:31.253773 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:31.255776 [info ] [Thread-1 (]: 5 of 17 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m20:10:31.256774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:10:31.257767 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:31.263782 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:10:31.273648 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 20:10:31.258768 => 20:10:31.272666
[0m20:10:31.274666 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:31.278644 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:10:31.285646 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:10:31.287647 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m20:10:31.288658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.322648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.323650 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:10:31.323650 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:10:31.329648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.331652 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 20:10:31.275646 => 20:10:31.331652
[0m20:10:31.332646 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m20:10:31.335660 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m20:10:31.337647 [info ] [Thread-1 (]: 5 of 17 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.08s]
[0m20:10:31.339656 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:31.341668 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:10:31.342659 [info ] [Thread-1 (]: 6 of 17 START test not_null_fact_stocks_id ..................................... [RUN]
[0m20:10:31.343667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_fact_stocks_id.e7b7e788fa)
[0m20:10:31.345666 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:10:31.351654 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:10:31.359176 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (compile): 20:10:31.345666 => 20:10:31.359176
[0m20:10:31.360165 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:10:31.365165 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:10:31.373399 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:10:31.374395 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m20:10:31.375395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.403402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.404395 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"
[0m20:10:31.405397 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m20:10:31.421213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.425211 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_fact_stocks_id.e7b7e788fa (execute): 20:10:31.361164 => 20:10:31.425211
[0m20:10:31.426221 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m20:10:31.431302 [debug] [Thread-1 (]: On test.dbt_project.not_null_fact_stocks_id.e7b7e788fa: Close
[0m20:10:31.434294 [info ] [Thread-1 (]: 6 of 17 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.09s]
[0m20:10:31.437295 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_fact_stocks_id.e7b7e788fa
[0m20:10:31.438308 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:10:31.439304 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m20:10:31.442313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_project.not_null_stg_eltool__company_id.632831b79c)
[0m20:10:31.443302 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:10:31.451826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:10:31.461097 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (compile): 20:10:31.444316 => 20:10:31.460093
[0m20:10:31.462090 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:10:31.466090 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:10:31.475095 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:10:31.477096 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m20:10:31.478090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.507095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.510095 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"
[0m20:10:31.511095 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m20:10:31.516109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.519090 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__company_id.632831b79c (execute): 20:10:31.463089 => 20:10:31.518095
[0m20:10:31.520120 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m20:10:31.523090 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__company_id.632831b79c: Close
[0m20:10:31.525095 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.08s]
[0m20:10:31.527095 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__company_id.632831b79c
[0m20:10:31.528091 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:10:31.529095 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m20:10:31.531090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__company_id.632831b79c, now test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m20:10:31.531090 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:10:31.538107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:10:31.548102 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 20:10:31.532094 => 20:10:31.547103
[0m20:10:31.549102 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:10:31.552101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:10:31.558374 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:10:31.559374 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m20:10:31.560356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.581784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.582796 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m20:10:31.582796 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m20:10:31.585795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.587794 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 20:10:31.550108 => 20:10:31.587794
[0m20:10:31.588795 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m20:10:31.590794 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m20:10:31.592795 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.06s]
[0m20:10:31.593795 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m20:10:31.594798 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:10:31.595800 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m20:10:31.597796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m20:10:31.598794 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:10:31.603795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:10:31.610254 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 20:10:31.599796 => 20:10:31.609252
[0m20:10:31.611215 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:10:31.613249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:10:31.622796 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:10:31.622796 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m20:10:31.623795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.649280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.650314 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m20:10:31.651291 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m20:10:31.657847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.659867 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 20:10:31.611215 => 20:10:31.658848
[0m20:10:31.659867 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m20:10:31.662608 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m20:10:31.663629 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.07s]
[0m20:10:31.665625 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a
[0m20:10:31.666637 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:10:31.667632 [info ] [Thread-1 (]: 10 of 17 START test not_null_stock_update_status_id ............................ [RUN]
[0m20:10:31.668618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_project.not_null_stock_update_status_id.633bc8afe3)
[0m20:10:31.669618 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:10:31.674620 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:10:31.681955 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (compile): 20:10:31.670631 => 20:10:31.681955
[0m20:10:31.682957 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:10:31.685925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:10:31.691923 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:10:31.692925 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m20:10:31.693920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.718549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.719539 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"
[0m20:10:31.720574 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m20:10:31.861457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.863448 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stock_update_status_id.633bc8afe3 (execute): 20:10:31.683920 => 20:10:31.863448
[0m20:10:31.864450 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m20:10:31.866516 [debug] [Thread-1 (]: On test.dbt_project.not_null_stock_update_status_id.633bc8afe3: Close
[0m20:10:31.869326 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.20s]
[0m20:10:31.870854 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stock_update_status_id.633bc8afe3
[0m20:10:31.872855 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:10:31.873865 [info ] [Thread-1 (]: 11 of 17 START test source_not_null_public_customers_customer_id ............... [RUN]
[0m20:10:31.875856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stock_update_status_id.633bc8afe3, now test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f)
[0m20:10:31.876856 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:10:31.882862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:10:31.889855 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (compile): 20:10:31.877858 => 20:10:31.889855
[0m20:10:31.891856 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:10:31.894856 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:10:31.902856 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:10:31.903863 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: BEGIN
[0m20:10:31.904854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.934851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:31.935852 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"
[0m20:10:31.936863 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "my_database"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:10:31.941872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:31.943869 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f (execute): 20:10:31.892857 => 20:10:31.943869
[0m20:10:31.945882 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: ROLLBACK
[0m20:10:31.947866 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f: Close
[0m20:10:31.949868 [info ] [Thread-1 (]: 11 of 17 PASS source_not_null_public_customers_customer_id ..................... [[32mPASS[0m in 0.07s]
[0m20:10:31.951864 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f
[0m20:10:31.954385 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:10:31.955388 [info ] [Thread-1 (]: 12 of 17 START test source_not_null_public_ksql-company-stream_id .............. [RUN]
[0m20:10:31.957388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_customers_customer_id.3ca828c88f, now test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0)
[0m20:10:31.958397 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:10:31.966391 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:10:31.976391 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (compile): 20:10:31.959387 => 20:10:31.975417
[0m20:10:31.977389 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:10:31.981387 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:10:31.989388 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:10:31.990389 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: BEGIN
[0m20:10:31.991390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.020385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.021397 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"
[0m20:10:32.022386 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m20:10:32.025413 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.028387 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0 (execute): 20:10:31.978388 => 20:10:32.028387
[0m20:10:32.029386 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: ROLLBACK
[0m20:10:32.032407 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0: Close
[0m20:10:32.034390 [info ] [Thread-1 (]: 12 of 17 PASS source_not_null_public_ksql-company-stream_id .................... [[32mPASS[0m in 0.08s]
[0m20:10:32.036387 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0
[0m20:10:32.038387 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:10:32.039419 [info ] [Thread-1 (]: 13 of 17 START test source_not_null_public_ksql-stock-stream_id ................ [RUN]
[0m20:10:32.040412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-company-stream_id.245eb849f0, now test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8)
[0m20:10:32.041396 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:10:32.049395 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:10:32.058569 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (compile): 20:10:32.042395 => 20:10:32.057574
[0m20:10:32.059583 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:10:32.066569 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:10:32.075570 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:10:32.077570 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: BEGIN
[0m20:10:32.079601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.112582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.113595 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"
[0m20:10:32.114595 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "my_database"."public"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m20:10:32.121591 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.125148 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8 (execute): 20:10:32.059583 => 20:10:32.125148
[0m20:10:32.126148 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: ROLLBACK
[0m20:10:32.129148 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8: Close
[0m20:10:32.131153 [info ] [Thread-1 (]: 13 of 17 PASS source_not_null_public_ksql-stock-stream_id ...................... [[32mPASS[0m in 0.09s]
[0m20:10:32.133154 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8
[0m20:10:32.134152 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:10:32.135149 [info ] [Thread-1 (]: 14 of 17 START test source_not_null_public_orders_order_id ..................... [RUN]
[0m20:10:32.138145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_ksql-stock-stream_id.e4d8a6c1d8, now test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee)
[0m20:10:32.139154 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:10:32.146159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:10:32.156778 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (compile): 20:10:32.140162 => 20:10:32.155778
[0m20:10:32.157780 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:10:32.163773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:10:32.171600 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:10:32.172607 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: BEGIN
[0m20:10:32.173628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.200605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.202604 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"
[0m20:10:32.203617 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "my_database"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m20:10:32.206606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.208601 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee (execute): 20:10:32.158774 => 20:10:32.208601
[0m20:10:32.210599 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: ROLLBACK
[0m20:10:32.212606 [debug] [Thread-1 (]: On test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee: Close
[0m20:10:32.214607 [info ] [Thread-1 (]: 14 of 17 PASS source_not_null_public_orders_order_id ........................... [[32mPASS[0m in 0.08s]
[0m20:10:32.217601 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee
[0m20:10:32.218605 [debug] [Thread-1 (]: Began running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:10:32.219601 [info ] [Thread-1 (]: 15 of 17 START test source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [RUN]
[0m20:10:32.221601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_not_null_public_orders_order_id.6a0be631ee, now test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5)
[0m20:10:32.222636 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:10:32.234634 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:10:32.242617 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (compile): 20:10:32.223626 => 20:10:32.241670
[0m20:10:32.243612 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:10:32.247616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:10:32.255170 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:10:32.257137 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: BEGIN
[0m20:10:32.258131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.284185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.285167 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"
[0m20:10:32.286146 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "my_database"."public"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "my_database"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:10:32.290156 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.292130 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5 (execute): 20:10:32.243612 => 20:10:32.292130
[0m20:10:32.293130 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: ROLLBACK
[0m20:10:32.296134 [debug] [Thread-1 (]: On test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5: Close
[0m20:10:32.298153 [info ] [Thread-1 (]: 15 of 17 PASS source_relationships_public_orders_cust_id__customer_id__source_public_customers_  [[32mPASS[0m in 0.08s]
[0m20:10:32.301135 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5
[0m20:10:32.302131 [debug] [Thread-1 (]: Began running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:10:32.303136 [info ] [Thread-1 (]: 16 of 17 START test source_unique_public_orders_order_id ....................... [RUN]
[0m20:10:32.305131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_relationships_public_orders_cust_id__customer_id__source_public_customers_.7b836e3bd5, now test.dbt_project.source_unique_public_orders_order_id.95035364f0)
[0m20:10:32.306138 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:10:32.315167 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:10:32.321516 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (compile): 20:10:32.307149 => 20:10:32.321516
[0m20:10:32.322515 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:10:32.325531 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:10:32.332515 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:10:32.332515 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: BEGIN
[0m20:10:32.333549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.355710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.356726 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.source_unique_public_orders_order_id.95035364f0"
[0m20:10:32.357722 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.source_unique_public_orders_order_id.95035364f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:32.361892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.363937 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_public_orders_order_id.95035364f0 (execute): 20:10:32.323578 => 20:10:32.362939
[0m20:10:32.363937 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: ROLLBACK
[0m20:10:32.365903 [debug] [Thread-1 (]: On test.dbt_project.source_unique_public_orders_order_id.95035364f0: Close
[0m20:10:32.367917 [info ] [Thread-1 (]: 16 of 17 PASS source_unique_public_orders_order_id ............................. [[32mPASS[0m in 0.06s]
[0m20:10:32.369905 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_unique_public_orders_order_id.95035364f0
[0m20:10:32.370906 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:10:32.371904 [info ] [Thread-1 (]: 17 of 17 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m20:10:32.372903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.source_unique_public_orders_order_id.95035364f0, now test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee)
[0m20:10:32.373902 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:10:32.378939 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:10:32.385388 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (compile): 20:10:32.374905 => 20:10:32.385388
[0m20:10:32.386360 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:10:32.389392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:10:32.395811 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:10:32.395811 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m20:10:32.396847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.417874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.418912 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"
[0m20:10:32.419880 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "my_database"."public"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:32.426900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:10:32.428901 [debug] [Thread-1 (]: Timing info for test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee (execute): 20:10:32.387361 => 20:10:32.427875
[0m20:10:32.429877 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m20:10:32.431889 [debug] [Thread-1 (]: On test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m20:10:32.434882 [info ] [Thread-1 (]: 17 of 17 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.06s]
[0m20:10:32.436879 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee
[0m20:10:32.440897 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:32.441891 [debug] [MainThread]: On master: BEGIN
[0m20:10:32.442887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:32.468411 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:32.469412 [debug] [MainThread]: On master: COMMIT
[0m20:10:32.469412 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:32.470447 [debug] [MainThread]: On master: COMMIT
[0m20:10:32.472409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:32.473411 [debug] [MainThread]: On master: Close
[0m20:10:32.474433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:32.475427 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:10:32.476414 [debug] [MainThread]: Connection 'test.dbt_project.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m20:10:32.477415 [info ] [MainThread]: 
[0m20:10:32.478414 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m20:10:32.483447 [debug] [MainThread]: Command end result
[0m20:10:32.510969 [info ] [MainThread]: 
[0m20:10:32.512935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:32.513933 [info ] [MainThread]: 
[0m20:10:32.514970 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:10:32.515964 [debug] [MainThread]: Command `dbt test` succeeded at 20:10:32.515964 after 2.18 seconds
[0m20:10:32.516936 [debug] [MainThread]: Flushing usage events


============================== 20:13:14.177030 | a39ea8a5-fabb-492c-8007-580c04e18dd5 ==============================
[0m20:13:14.177030 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:13:14.183030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:13:14.312548 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:13:14.322550 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:13:14.470323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:14.470323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:14.511957 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:13:14.514916 [info ] [MainThread]: 
[0m20:13:14.516917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:13:14.519917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:13:14.532219 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:13:14.532219 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:13:14.533216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:14.565070 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:13:14.567077 [debug] [ThreadPool]: On list_my_database: Close
[0m20:13:14.571076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:13:14.578075 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:13:14.579076 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:13:14.579076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:14.609664 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.610662 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:13:14.611639 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:13:14.618650 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:13:14.620669 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:13:14.622656 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:13:14.624713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:13:14.628665 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:13:14.629664 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:13:14.629664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:14.651291 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.652284 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:13:14.652284 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:13:14.656856 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m20:13:14.658821 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:13:14.661798 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:13:14.669820 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:14.670835 [debug] [MainThread]: On master: BEGIN
[0m20:13:14.670835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:14.693418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.694410 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:14.695407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:13:14.700981 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m20:13:14.704026 [debug] [MainThread]: On master: ROLLBACK
[0m20:13:14.705987 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:14.707024 [debug] [MainThread]: On master: BEGIN
[0m20:13:14.710406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.711395 [debug] [MainThread]: On master: COMMIT
[0m20:13:14.711395 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:14.712395 [debug] [MainThread]: On master: COMMIT
[0m20:13:14.713975 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:13:14.714989 [debug] [MainThread]: On master: Close
[0m20:13:14.716992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:14.717988 [info ] [MainThread]: 
[0m20:13:14.723991 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:13:14.724995 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:13:14.726012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:13:14.726987 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:13:14.734023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:13:14.742994 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:13:14.727985 => 20:13:14.742994
[0m20:13:14.744024 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:13:14.782985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:13:14.790170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.791173 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:13:14.792130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:13:14.816188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.817188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.818194 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:13:14.822212 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:14.830186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.831186 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:13:14.833182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:14.837185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.838186 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:13:14.840152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:14.856168 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:13:14.857135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.858146 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:13:14.861205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:14.870216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:13:14.871216 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:13:14.876236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:14.878222 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:13:14.745001 => 20:13:14.878222
[0m20:13:14.880240 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:13:14.882225 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:13:14.883267 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:13:14.885221 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:13:14.886217 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:13:14.887255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:13:14.888257 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:13:14.894231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:13:14.903571 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:13:14.889229 => 20:13:14.902631
[0m20:13:14.904589 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:13:14.910569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:13:14.920682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.921689 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:13:14.923686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:14.952175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:14.953181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.954184 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:13:14.958181 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:14.962181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.963199 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:13:14.967182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:14.971206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.972181 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:13:14.974197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:14.976206 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:13:14.977209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.978196 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:13:14.981028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:14.986053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:13:14.986053 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:13:14.990060 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:14.992059 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:13:14.904589 => 20:13:14.992059
[0m20:13:14.993088 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:13:14.995063 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.11s]
[0m20:13:14.997076 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:13:14.998062 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:13:14.999061 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:13:15.000063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:13:15.001573 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:13:15.004579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.010606 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:13:15.001573 => 20:13:15.010606
[0m20:13:15.011605 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:13:15.018619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.026274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.027274 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:13:15.027274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.050027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.051052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.052050 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:13:15.055525 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.058536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.059535 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:13:15.061539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.065535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.066552 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:13:15.069546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.071540 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:13:15.072559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.072559 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:13:15.076703 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.080734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:13:15.080734 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:13:15.085238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.087238 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:13:15.012605 => 20:13:15.087238
[0m20:13:15.088230 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:13:15.091232 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.09s]
[0m20:13:15.093234 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:13:15.094228 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:13:15.095252 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:13:15.097252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:13:15.097252 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:13:15.100250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:13:15.112304 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:13:15.098253 => 20:13:15.112304
[0m20:13:15.113272 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:13:15.119307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:13:15.132837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.134818 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:13:15.135834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.163179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.164189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.165189 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:13:15.168192 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.173189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.173189 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:13:15.176418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.179455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.180456 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:13:15.183430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.185454 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:13:15.186458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.187463 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:13:15.190505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.194468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:13:15.194468 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:13:15.198474 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.200506 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:13:15.114299 => 20:13:15.200506
[0m20:13:15.202012 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:13:15.204028 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:13:15.206021 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:13:15.207018 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:13:15.208021 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:13:15.209020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:13:15.210036 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:13:15.212019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:13:15.219020 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:13:15.210036 => 20:13:15.218047
[0m20:13:15.219020 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:13:15.224045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:13:15.230874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.231833 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:13:15.232834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.255754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.256786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.257734 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:13:15.260756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.265735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.266739 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:13:15.270739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.274733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.275765 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:13:15.277734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.280733 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:13:15.280733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.281733 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:13:15.285280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.288287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:13:15.289288 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:13:15.294308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.296290 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:13:15.220045 => 20:13:15.296290
[0m20:13:15.297316 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:13:15.299313 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:13:15.301291 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:13:15.302297 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:13:15.304479 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:13:15.305938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:13:15.306936 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:13:15.311938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:13:15.319996 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:13:15.306936 => 20:13:15.319002
[0m20:13:15.320977 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:13:15.328030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:13:15.336051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.336972 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:13:15.338002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.361999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.362978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.363977 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:13:15.367971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.372977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.372977 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:13:15.375993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.379976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.379976 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:13:15.382974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.384978 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:13:15.386980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.388021 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:13:15.392005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.395991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:13:15.396992 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:13:15.400992 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.403508 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:13:15.321983 => 20:13:15.403508
[0m20:13:15.404511 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:13:15.406531 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:13:15.409509 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:13:15.411506 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:13:15.412526 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:13:15.414510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:13:15.415509 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:13:15.421549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:13:15.427545 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:13:15.416510 => 20:13:15.427545
[0m20:13:15.428513 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:13:15.435510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:13:15.441822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:13:15.442790 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:13:15.443789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.465832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.466863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:13:15.467812 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:13:15.470848 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.474841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:13:15.475810 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:13:15.477884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.479811 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:13:15.480837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:13:15.481838 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:13:15.485257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.489300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:13:15.490276 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:13:15.492271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.494339 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:13:15.429511 => 20:13:15.494339
[0m20:13:15.495272 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:13:15.497274 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:13:15.500273 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:13:15.501270 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:13:15.501270 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:13:15.503812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.dim_customers)
[0m20:13:15.504783 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m20:13:15.507812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m20:13:15.517787 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (compile): 20:13:15.504783 => 20:13:15.514786
[0m20:13:15.519786 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m20:13:15.530807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m20:13:15.540787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:13:15.541782 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m20:13:15.543785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.574781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.576776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:13:15.577779 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:13:15.585783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.591808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:13:15.592812 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:13:15.595805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.597831 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:13:15.598818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:13:15.598818 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:13:15.602805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.607260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:13:15.608314 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:13:15.610261 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.612284 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (execute): 20:13:15.520786 => 20:13:15.612284
[0m20:13:15.613263 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m20:13:15.615265 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:13:15.617263 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:13:15.618267 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:13:15.619284 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:13:15.621261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customers, now model.dbt_project.fact_stocks)
[0m20:13:15.622263 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:13:15.627259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:13:15.634576 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:13:15.623286 => 20:13:15.633608
[0m20:13:15.635576 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:13:15.642576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:13:15.649613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:13:15.650634 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:13:15.651618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.676615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.677612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:13:15.677612 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:13:15.682636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.688624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:13:15.689625 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:13:15.691634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.693657 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:13:15.694661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:13:15.695680 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:13:15.699624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.703205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:13:15.704248 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:13:15.705525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.707561 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:13:15.636580 => 20:13:15.707561
[0m20:13:15.708536 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:13:15.710540 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:13:15.712537 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:13:15.714547 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:13:15.715554 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:13:15.716538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_stocks, now model.dbt_project.customer_orders_status)
[0m20:13:15.717542 [debug] [Thread-1 (]: Began compiling node model.dbt_project.customer_orders_status
[0m20:13:15.720561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.customer_orders_status"
[0m20:13:15.727536 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (compile): 20:13:15.718545 => 20:13:15.726563
[0m20:13:15.728535 [debug] [Thread-1 (]: Began executing node model.dbt_project.customer_orders_status
[0m20:13:15.735573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.customer_orders_status"
[0m20:13:15.743535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:13:15.744536 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: BEGIN
[0m20:13:15.744536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.769351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.770337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:13:15.772335 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:13:15.777153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.780164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:13:15.781163 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:13:15.783167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.786162 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:13:15.787177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:13:15.787177 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:13:15.791051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.796062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:13:15.797067 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:13:15.800032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.801032 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (execute): 20:13:15.729543 => 20:13:15.801032
[0m20:13:15.802546 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: Close
[0m20:13:15.804555 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.09s]
[0m20:13:15.806615 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:13:15.807583 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:13:15.808558 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:13:15.810600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.customer_orders_status, now model.dbt_project.stock_update_status)
[0m20:13:15.811566 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stock_update_status
[0m20:13:15.814567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stock_update_status"
[0m20:13:15.822569 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (compile): 20:13:15.811566 => 20:13:15.821623
[0m20:13:15.823573 [debug] [Thread-1 (]: Began executing node model.dbt_project.stock_update_status
[0m20:13:15.829568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stock_update_status"
[0m20:13:15.836120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:13:15.837159 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: BEGIN
[0m20:13:15.838146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:15.862125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.863148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:13:15.863148 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:13:15.867885 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:13:15.871909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:13:15.872896 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:13:15.874899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:13:15.876933 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:13:15.877899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:13:15.877899 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:13:15.882911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.886946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:13:15.887998 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:13:15.890635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:13:15.892666 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (execute): 20:13:15.824572 => 20:13:15.892666
[0m20:13:15.893662 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: Close
[0m20:13:15.895641 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:13:15.897641 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:13:15.900625 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:15.901625 [debug] [MainThread]: On master: BEGIN
[0m20:13:15.903147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:15.934064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:13:15.936067 [debug] [MainThread]: On master: COMMIT
[0m20:13:15.936067 [debug] [MainThread]: Using postgres connection "master"
[0m20:13:15.938585 [debug] [MainThread]: On master: COMMIT
[0m20:13:15.941587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:13:15.942597 [debug] [MainThread]: On master: Close
[0m20:13:15.945583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:15.947602 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:13:15.948586 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:13:15.950587 [debug] [MainThread]: Connection 'model.dbt_project.stock_update_status' was properly closed.
[0m20:13:15.952589 [info ] [MainThread]: 
[0m20:13:15.954603 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m20:13:15.960184 [debug] [MainThread]: Command end result
[0m20:13:16.050848 [info ] [MainThread]: 
[0m20:13:16.052787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:16.053783 [info ] [MainThread]: 
[0m20:13:16.054786 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:13:16.055806 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:16.055806 after 1.92 seconds
[0m20:13:16.056807 [debug] [MainThread]: Flushing usage events


============================== 20:39:34.269887 | 55e4e6b2-e861-481b-85c4-6c9ceaca37de ==============================
[0m20:39:34.269887 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:39:34.275059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:39:34.423185 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:39:34.432188 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:39:34.451191 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:39:35.408233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres.marts.core
[0m20:39:35.459007 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:39:35.461971 [info ] [MainThread]: 
[0m20:39:35.463118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:35.468297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:39:35.479335 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:39:35.480329 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:39:35.480329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:35.512325 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:39:35.514329 [debug] [ThreadPool]: On list_my_database: Close
[0m20:39:35.518329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:39:35.525329 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:39:35.525329 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:39:35.526331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:35.551577 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.552569 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:39:35.553565 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:39:35.558570 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:39:35.560604 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:39:35.562564 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:39:35.563574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:39:35.567121 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:39:35.568149 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:39:35.569122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:35.590434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.604446 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:39:35.604446 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:39:35.609488 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:39:35.611445 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:39:35.613447 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:39:35.623483 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:35.624461 [debug] [MainThread]: On master: BEGIN
[0m20:39:35.624461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:35.646003 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.647030 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:35.648002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:35.655008 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:39:35.659036 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:35.661013 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:35.662033 [debug] [MainThread]: On master: BEGIN
[0m20:39:35.665311 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.665311 [debug] [MainThread]: On master: COMMIT
[0m20:39:35.666452 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:35.667477 [debug] [MainThread]: On master: COMMIT
[0m20:39:35.669455 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:39:35.669455 [debug] [MainThread]: On master: Close
[0m20:39:35.671455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:35.672450 [info ] [MainThread]: 
[0m20:39:35.677451 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:39:35.678449 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:39:35.679462 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:39:35.680490 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:39:35.689483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:39:35.698073 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:39:35.681457 => 20:39:35.698073
[0m20:39:35.699001 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:39:35.733032 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:39:35.739713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.741730 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:39:35.741730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:35.764130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.764130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.765672 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:39:35.770679 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:35.778678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.778678 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:39:35.781869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:35.784879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.785878 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:39:35.787944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:35.805979 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:39:35.806984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.807942 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:39:35.811943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:35.820975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:39:35.821990 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:39:35.826913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:35.828942 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:39:35.699001 => 20:39:35.828942
[0m20:39:35.829908 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:39:35.831911 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:39:35.833931 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:39:35.835906 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:39:35.835906 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:39:35.837941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:39:35.837941 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:39:35.841907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:39:35.848905 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:39:35.838940 => 20:39:35.848905
[0m20:39:35.849917 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:39:35.854961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:39:35.862956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.863988 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:39:35.863988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:35.886424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:35.887427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.888402 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:39:35.891402 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:35.895438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.895438 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:39:35.898402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:35.902438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.903442 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:39:35.907222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:35.909234 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:39:35.910233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.911233 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:39:35.914594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:35.918619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:39:35.919594 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:39:35.923600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:35.925626 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:39:35.850939 => 20:39:35.925626
[0m20:39:35.926622 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:39:35.928610 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:39:35.930595 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:39:35.931598 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:39:35.932597 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:39:35.933594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:39:35.934596 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:39:35.937620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:35.943849 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:39:35.935607 => 20:39:35.943849
[0m20:39:35.944829 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:39:35.950832 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:35.963844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:35.965845 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:39:35.968876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.000875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.001895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:36.001895 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:39:36.006880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.011878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:36.012875 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:39:36.015880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.019875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:36.020894 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:39:36.023875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.026877 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:39:36.027878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:36.028874 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:39:36.032402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.036395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:39:36.037451 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:39:36.042393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.044395 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:39:35.944829 => 20:39:36.044395
[0m20:39:36.045394 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:39:36.047413 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.11s]
[0m20:39:36.049398 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:39:36.050399 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:39:36.051441 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:39:36.052406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:39:36.053406 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:39:36.056406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:39:36.066873 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:39:36.054405 => 20:39:36.066873
[0m20:39:36.067903 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:39:36.073903 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:39:36.084912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.085867 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:39:36.085867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.108890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.109890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.109890 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:39:36.113888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.118889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.119890 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:39:36.122441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.125509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.126515 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:39:36.128509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.131502 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:39:36.131502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.132488 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:39:36.135509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.141535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:39:36.141535 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:39:36.145508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.147536 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:39:36.068866 => 20:39:36.147536
[0m20:39:36.148534 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:39:36.150553 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:39:36.152564 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:39:36.154564 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:39:36.154564 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:39:36.156561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:39:36.156561 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:39:36.160561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:39:36.165878 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:39:36.157561 => 20:39:36.165878
[0m20:39:36.167342 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:39:36.173375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:39:36.180511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.181510 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:39:36.181510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.204033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.205032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.205032 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:39:36.209033 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.213067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.214068 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:39:36.217037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.221070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.222067 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:39:36.224055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.227097 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:39:36.227097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.228096 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:39:36.232293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.235268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:39:36.236269 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:39:36.239714 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.241726 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:39:36.168365 => 20:39:36.241726
[0m20:39:36.242684 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:39:36.244690 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:39:36.246688 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:39:36.247713 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:39:36.248687 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:39:36.249692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:39:36.250688 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:39:36.253733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:39:36.259279 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:39:36.250688 => 20:39:36.259279
[0m20:39:36.260281 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:39:36.265843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:39:36.271888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.272889 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:39:36.273858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.296011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.297005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.297005 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:39:36.301009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.305003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.305003 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:39:36.308004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.311003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.312003 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:39:36.314153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.316164 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:39:36.317164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.317164 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:39:36.320491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.326515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:39:36.327519 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:39:36.332489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.334516 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:39:36.261310 => 20:39:36.333516
[0m20:39:36.334516 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:39:36.336487 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:39:36.339482 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:39:36.340479 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:39:36.341480 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:39:36.343482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:39:36.344494 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:39:36.347499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:39:36.356416 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:39:36.344494 => 20:39:36.356416
[0m20:39:36.358412 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:39:36.366114 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:39:36.373674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:39:36.374676 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:39:36.375642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.400015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.400981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:39:36.401981 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:39:36.405222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.408289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:39:36.409254 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:39:36.411256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.413289 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:39:36.414267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:39:36.414267 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:39:36.418257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.423289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:39:36.423289 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:39:36.426263 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.428289 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:39:36.359549 => 20:39:36.428289
[0m20:39:36.429290 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:39:36.431256 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:39:36.433257 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:39:36.435255 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:39:36.435255 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:39:36.437253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.dim_customers)
[0m20:39:36.437253 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m20:39:36.441288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m20:39:36.447304 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (compile): 20:39:36.438290 => 20:39:36.447304
[0m20:39:36.448308 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m20:39:36.453316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m20:39:36.460185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:39:36.460185 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m20:39:36.461185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.484391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.485406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:39:36.486373 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:39:36.490754 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.493789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:39:36.494788 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:39:36.497754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.499753 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:39:36.499753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:39:36.500792 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:39:36.503753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.507781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:39:36.507781 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:39:36.510754 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.511778 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (execute): 20:39:36.448308 => 20:39:36.511778
[0m20:39:36.512782 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m20:39:36.514762 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:39:36.516781 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:39:36.517758 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:39:36.518754 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:39:36.520779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customers, now model.dbt_project.fact_stocks)
[0m20:39:36.521780 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:39:36.527798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:39:36.535759 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:39:36.522753 => 20:39:36.534792
[0m20:39:36.536766 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:39:36.540757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:39:36.547795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:39:36.548776 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:39:36.548776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.572302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.573302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:39:36.574325 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:39:36.578299 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.582328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:39:36.582328 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:39:36.585300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.586302 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:39:36.587326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:39:36.588300 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:39:36.591474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.595507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:39:36.595507 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:39:36.597474 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.599496 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:39:36.536766 => 20:39:36.599496
[0m20:39:36.600499 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:39:36.602483 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:39:36.604478 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:39:36.605475 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:39:36.606486 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:39:36.608475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_stocks, now model.dbt_project.customer_orders_status)
[0m20:39:36.609472 [debug] [Thread-1 (]: Began compiling node model.dbt_project.customer_orders_status
[0m20:39:36.612506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.customer_orders_status"
[0m20:39:36.619475 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (compile): 20:39:36.609472 => 20:39:36.618488
[0m20:39:36.620469 [debug] [Thread-1 (]: Began executing node model.dbt_project.customer_orders_status
[0m20:39:36.627476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.customer_orders_status"
[0m20:39:36.635476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:39:36.636498 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: BEGIN
[0m20:39:36.637488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.662678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.662678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:39:36.663689 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:39:36.668235 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.671237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:39:36.672237 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:39:36.675236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.677236 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:39:36.677236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:39:36.678237 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:39:36.681160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.685197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:39:36.686194 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:39:36.688156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.690158 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (execute): 20:39:36.621509 => 20:39:36.690158
[0m20:39:36.690158 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: Close
[0m20:39:36.692179 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:39:36.694190 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:39:36.695162 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:39:36.696194 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:39:36.697165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.customer_orders_status, now model.dbt_project.stock_update_status)
[0m20:39:36.698167 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stock_update_status
[0m20:39:36.701158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stock_update_status"
[0m20:39:36.707156 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (compile): 20:39:36.699160 => 20:39:36.707156
[0m20:39:36.708166 [debug] [Thread-1 (]: Began executing node model.dbt_project.stock_update_status
[0m20:39:36.712157 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stock_update_status"
[0m20:39:36.721158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:39:36.721158 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: BEGIN
[0m20:39:36.722158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:36.744274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.745271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:39:36.746296 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:39:36.750570 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:36.753580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:39:36.754580 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:39:36.756582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:36.758581 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:39:36.759581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:39:36.760579 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:39:36.763580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.767124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:39:36.768134 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:39:36.770477 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:36.771488 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (execute): 20:39:36.708166 => 20:39:36.771488
[0m20:39:36.772488 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: Close
[0m20:39:36.774508 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:39:36.776489 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:39:36.779490 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.780526 [debug] [MainThread]: On master: BEGIN
[0m20:39:36.780526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:36.801835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.802849 [debug] [MainThread]: On master: COMMIT
[0m20:39:36.802849 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.803858 [debug] [MainThread]: On master: COMMIT
[0m20:39:36.805844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.806830 [debug] [MainThread]: On master: Close
[0m20:39:36.807823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:36.808829 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:39:36.810827 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:39:36.811839 [debug] [MainThread]: Connection 'model.dbt_project.stock_update_status' was properly closed.
[0m20:39:36.812824 [info ] [MainThread]: 
[0m20:39:36.813822 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m20:39:36.816824 [debug] [MainThread]: Command end result
[0m20:39:36.841839 [info ] [MainThread]: 
[0m20:39:36.842843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:36.843880 [info ] [MainThread]: 
[0m20:39:36.844824 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:39:36.845822 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:36.845822 after 2.62 seconds
[0m20:39:36.846877 [debug] [MainThread]: Flushing usage events


============================== 20:41:18.825590 | 0664311a-a946-42cf-ac55-2f85a0737a18 ==============================
[0m20:41:18.825590 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:41:18.830602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:41:18.983789 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:41:18.997789 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:41:19.159470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:19.160486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:19.161495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres.marts.core
[0m20:41:19.208469 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:41:19.211538 [info ] [MainThread]: 
[0m20:41:19.212513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:19.217506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:41:19.227156 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:41:19.228124 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:41:19.229088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:19.265854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:41:19.267850 [debug] [ThreadPool]: On list_my_database: Close
[0m20:41:19.271879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:41:19.280882 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:41:19.280882 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:41:19.281882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:19.304541 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.305537 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:41:19.306558 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:41:19.311544 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m20:41:19.313579 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:41:19.316545 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:41:19.318545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:41:19.325150 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:41:19.326162 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:41:19.326162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:19.357616 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.358263 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:41:19.359253 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:41:19.365761 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:41:19.367776 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:41:19.370793 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:41:19.380773 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:19.381770 [debug] [MainThread]: On master: BEGIN
[0m20:41:19.382784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:19.412832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.413834 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:19.414887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:19.423838 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m20:41:19.429689 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:19.432930 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:19.433945 [debug] [MainThread]: On master: BEGIN
[0m20:41:19.438925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.439945 [debug] [MainThread]: On master: COMMIT
[0m20:41:19.442478 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:19.443485 [debug] [MainThread]: On master: COMMIT
[0m20:41:19.447457 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:19.448459 [debug] [MainThread]: On master: Close
[0m20:41:19.450465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:19.452987 [info ] [MainThread]: 
[0m20:41:19.461095 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__company
[0m20:41:19.461985 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:41:19.463987 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__company'
[0m20:41:19.465020 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__company
[0m20:41:19.480506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__company"
[0m20:41:19.491502 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (compile): 20:41:19.465986 => 20:41:19.491502
[0m20:41:19.493502 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__company
[0m20:41:19.588838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__company"
[0m20:41:19.600166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.601210 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: BEGIN
[0m20:41:19.603175 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:19.638683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.640677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.642673 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:41:19.646760 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:19.657762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.658763 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:41:19.662760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.667880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.668880 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:41:19.671882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.698423 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:41:19.699419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.700420 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: COMMIT
[0m20:41:19.704959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:19.716968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__company"
[0m20:41:19.717965 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:41:19.722962 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:19.727492 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__company (execute): 20:41:19.494508 => 20:41:19.726519
[0m20:41:19.729493 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__company: Close
[0m20:41:19.732494 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.27s]
[0m20:41:19.734495 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__company
[0m20:41:19.736493 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:41:19.737491 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:41:19.739519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__company, now model.dbt_project.stg_eltool__customers)
[0m20:41:19.740528 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:41:19.745494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:41:19.751490 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 20:41:19.740528 => 20:41:19.751490
[0m20:41:19.752525 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:41:19.757490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:41:19.766497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.768493 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:41:19.770490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:19.803011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.804008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.805007 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:41:19.809013 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:19.814022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.815013 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:41:19.818052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.823048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.824015 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:41:19.828563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.831569 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:41:19.832590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.833562 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:41:19.837583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:19.843565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:41:19.844584 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:41:19.849566 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:19.853569 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 20:41:19.753501 => 20:41:19.853569
[0m20:41:19.855569 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:41:19.858570 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:41:19.861609 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:41:19.863568 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:41:19.864568 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:41:19.866569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers, now model.dbt_project.stg_eltool__customers_snapshots)
[0m20:41:19.867580 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers_snapshots
[0m20:41:19.873568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.881569 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (compile): 20:41:19.869567 => 20:41:19.881569
[0m20:41:19.882567 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers_snapshots
[0m20:41:19.896564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.906565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.907572 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: BEGIN
[0m20:41:19.908569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:19.939454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:19.940455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.941459 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:41:19.947468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:19.952453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.953452 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:41:19.956454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.960454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.961454 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:41:19.964454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:19.967490 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:41:19.967490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.968488 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: COMMIT
[0m20:41:19.972472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:19.975473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers_snapshots"
[0m20:41:19.976488 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:41:19.982453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:19.985455 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers_snapshots (execute): 20:41:19.883566 => 20:41:19.985455
[0m20:41:19.987471 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers_snapshots: Close
[0m20:41:19.989456 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.12s]
[0m20:41:19.992458 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers_snapshots
[0m20:41:19.993453 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:41:19.995472 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:41:19.996452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__customers_snapshots, now model.dbt_project.stg_eltool__orders)
[0m20:41:19.998455 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:41:20.002461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:41:20.016464 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 20:41:19.998455 => 20:41:20.015464
[0m20:41:20.017465 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:41:20.023467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:41:20.040554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.041536 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:41:20.042537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.070553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.071537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.072537 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:41:20.075536 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.080535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.080535 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:41:20.082950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.085995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.086995 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:41:20.089986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.092995 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:41:20.093962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.094961 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:41:20.098959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.101995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:41:20.102998 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:41:20.107973 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.111034 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 20:41:20.017465 => 20:41:20.111034
[0m20:41:20.112081 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:41:20.114370 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:41:20.116029 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:41:20.117025 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:41:20.119044 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:41:20.121036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__orders, now model.dbt_project.stg_eltool__state)
[0m20:41:20.121562 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:41:20.125604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:41:20.132193 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 20:41:20.122575 => 20:41:20.132193
[0m20:41:20.133163 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:41:20.141783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:41:20.149303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.150301 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:41:20.150301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.172489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.172489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.173527 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:41:20.176489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.181515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.181515 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:41:20.184650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.187661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.188662 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:41:20.190567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.192613 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:41:20.193606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.193606 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:41:20.197582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.201613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:41:20.202579 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:41:20.205579 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.207579 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 20:41:20.134159 => 20:41:20.207579
[0m20:41:20.209579 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:41:20.210584 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:41:20.212593 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:41:20.213593 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__stock
[0m20:41:20.214620 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:41:20.215590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__state, now model.dbt_project.stg_eltool__stock)
[0m20:41:20.216619 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__stock
[0m20:41:20.221616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__stock"
[0m20:41:20.228799 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (compile): 20:41:20.217613 => 20:41:20.228799
[0m20:41:20.229816 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__stock
[0m20:41:20.234822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__stock"
[0m20:41:20.240797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.242801 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: BEGIN
[0m20:41:20.243805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.266243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.267237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.268212 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:41:20.271215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.276238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.277213 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:41:20.279215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.283231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.284215 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:41:20.287212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.290248 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:41:20.291212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.292215 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: COMMIT
[0m20:41:20.296217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.300238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__stock"
[0m20:41:20.301239 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:41:20.305232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.307212 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__stock (execute): 20:41:20.230826 => 20:41:20.307212
[0m20:41:20.308215 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__stock: Close
[0m20:41:20.310211 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:41:20.312247 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__stock
[0m20:41:20.313225 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_orders
[0m20:41:20.314243 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:41:20.315217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_eltool__stock, now model.dbt_project.fact_orders)
[0m20:41:20.316242 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_orders
[0m20:41:20.319246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_orders"
[0m20:41:20.325736 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (compile): 20:41:20.317219 => 20:41:20.325736
[0m20:41:20.326743 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_orders
[0m20:41:20.333744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_orders"
[0m20:41:20.341769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:41:20.343759 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: BEGIN
[0m20:41:20.344749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.373499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.373499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:41:20.374535 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:41:20.377526 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.380540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:41:20.381537 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:41:20.384638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.386649 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:41:20.387649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:41:20.387649 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: COMMIT
[0m20:41:20.391680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.396767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_orders"
[0m20:41:20.397712 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:41:20.400711 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.402716 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_orders (execute): 20:41:20.326743 => 20:41:20.402716
[0m20:41:20.403719 [debug] [Thread-1 (]: On model.dbt_project.fact_orders: Close
[0m20:41:20.406714 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:41:20.408710 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_orders
[0m20:41:20.410740 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m20:41:20.411750 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:41:20.412751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_orders, now model.dbt_project.dim_customers)
[0m20:41:20.414764 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m20:41:20.419759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m20:41:20.428878 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (compile): 20:41:20.415751 => 20:41:20.427879
[0m20:41:20.429877 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m20:41:20.435879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m20:41:20.443877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:41:20.444876 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m20:41:20.445876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.477875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.478878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:41:20.479874 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:41:20.485880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.489876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:41:20.490879 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:41:20.494891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.496881 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:41:20.497884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:41:20.498880 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m20:41:20.503915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.509916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m20:41:20.510913 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:41:20.513935 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.516941 [debug] [Thread-1 (]: Timing info for model.dbt_project.dim_customers (execute): 20:41:20.430877 => 20:41:20.516941
[0m20:41:20.517924 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m20:41:20.519927 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:41:20.522954 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m20:41:20.524922 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_stocks
[0m20:41:20.525925 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:41:20.529254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customers, now model.dbt_project.fact_stocks)
[0m20:41:20.530271 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_stocks
[0m20:41:20.538256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_stocks"
[0m20:41:20.547269 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (compile): 20:41:20.531256 => 20:41:20.547269
[0m20:41:20.548288 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_stocks
[0m20:41:20.555269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_stocks"
[0m20:41:20.568255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:41:20.570255 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: BEGIN
[0m20:41:20.572265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.603297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.605266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:41:20.606285 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:41:20.612268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.617265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:41:20.619269 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:41:20.623285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.625780 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:41:20.626792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:41:20.627793 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: COMMIT
[0m20:41:20.632789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.637815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.fact_stocks"
[0m20:41:20.638812 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:41:20.641812 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.644789 [debug] [Thread-1 (]: Timing info for model.dbt_project.fact_stocks (execute): 20:41:20.549251 => 20:41:20.644789
[0m20:41:20.646798 [debug] [Thread-1 (]: On model.dbt_project.fact_stocks: Close
[0m20:41:20.648788 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:41:20.650790 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_stocks
[0m20:41:20.651791 [debug] [Thread-1 (]: Began running node model.dbt_project.customer_orders_status
[0m20:41:20.652793 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:41:20.654789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_stocks, now model.dbt_project.customer_orders_status)
[0m20:41:20.654789 [debug] [Thread-1 (]: Began compiling node model.dbt_project.customer_orders_status
[0m20:41:20.658790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.customer_orders_status"
[0m20:41:20.665799 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (compile): 20:41:20.655807 => 20:41:20.664794
[0m20:41:20.666804 [debug] [Thread-1 (]: Began executing node model.dbt_project.customer_orders_status
[0m20:41:20.675794 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.customer_orders_status"
[0m20:41:20.683791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:41:20.685803 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: BEGIN
[0m20:41:20.686793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.721819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.723834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:41:20.724815 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:41:20.732346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.739338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:41:20.740340 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:41:20.744338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.749900 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:41:20.751897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:41:20.753914 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: COMMIT
[0m20:41:20.759900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.767214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.customer_orders_status"
[0m20:41:20.768902 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:41:20.771899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.775432 [debug] [Thread-1 (]: Timing info for model.dbt_project.customer_orders_status (execute): 20:41:20.666804 => 20:41:20.775432
[0m20:41:20.777443 [debug] [Thread-1 (]: On model.dbt_project.customer_orders_status: Close
[0m20:41:20.780337 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.13s]
[0m20:41:20.783339 [debug] [Thread-1 (]: Finished running node model.dbt_project.customer_orders_status
[0m20:41:20.786218 [debug] [Thread-1 (]: Began running node model.dbt_project.stock_update_status
[0m20:41:20.789564 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:41:20.794694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.customer_orders_status, now model.dbt_project.stock_update_status)
[0m20:41:20.797101 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stock_update_status
[0m20:41:20.808734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stock_update_status"
[0m20:41:20.820422 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (compile): 20:41:20.798657 => 20:41:20.819395
[0m20:41:20.822434 [debug] [Thread-1 (]: Began executing node model.dbt_project.stock_update_status
[0m20:41:20.835961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stock_update_status"
[0m20:41:20.851304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:41:20.853643 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: BEGIN
[0m20:41:20.855845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:20.923958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:41:20.925034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:41:20.926032 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:41:20.933817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:41:20.945458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:41:20.947699 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:41:20.951547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:41:20.955821 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:41:20.957430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:41:20.958496 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: COMMIT
[0m20:41:20.962041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:41:20.967447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stock_update_status"
[0m20:41:20.967447 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:41:20.970457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:41:20.973980 [debug] [Thread-1 (]: Timing info for model.dbt_project.stock_update_status (execute): 20:41:20.824453 => 20:41:20.972980
[0m20:41:20.974979 [debug] [Thread-1 (]: On model.dbt_project.stock_update_status: Close
[0m20:41:20.977980 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:41:20.979980 [debug] [Thread-1 (]: Finished running node model.dbt_project.stock_update_status
[0m20:41:20.983494 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:20.984506 [debug] [MainThread]: On master: BEGIN
[0m20:41:20.985503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:21.012105 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:21.013111 [debug] [MainThread]: On master: COMMIT
[0m20:41:21.016131 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:21.017247 [debug] [MainThread]: On master: COMMIT
[0m20:41:21.020501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:21.022923 [debug] [MainThread]: On master: Close
[0m20:41:21.025657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:21.027349 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:41:21.028996 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:41:21.030050 [debug] [MainThread]: Connection 'model.dbt_project.stock_update_status' was properly closed.
[0m20:41:21.031169 [info ] [MainThread]: 
[0m20:41:21.032303 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m20:41:21.036603 [debug] [MainThread]: Command end result
[0m20:41:21.123726 [info ] [MainThread]: 
[0m20:41:21.124729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:21.126242 [info ] [MainThread]: 
[0m20:41:21.127254 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:41:21.129259 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:21.128254 after 2.35 seconds
[0m20:41:21.130256 [debug] [MainThread]: Flushing usage events


============================== 20:45:52.965726 | ae2a4ac4-5147-42a0-a439-8096f09501c5 ==============================
[0m20:45:52.965726 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:45:52.972258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m20:45:53.112841 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:45:53.118868 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt_postgres" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m20:45:53.119847 [debug] [MainThread]: Command `dbt run` failed at 20:45:53.119847 after 0.19 seconds
[0m20:45:53.120849 [debug] [MainThread]: Flushing usage events


============================== 20:46:36.580077 | 6248584f-03b8-499e-ad55-860b653971e7 ==============================
[0m20:46:36.580077 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:46:36.585078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:46:36.713750 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:46:36.722111 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:46:36.733114 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:46:37.747924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres.marts.core
[0m20:46:37.802645 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:46:37.805638 [info ] [MainThread]: 
[0m20:46:37.806667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:37.812137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:46:37.824134 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:46:37.826141 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:46:37.827160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:37.860349 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:46:37.862312 [debug] [ThreadPool]: On list_my_database: Close
[0m20:46:37.866313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:46:37.873315 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:46:37.874316 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:46:37.875314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:37.897868 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:37.898890 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:46:37.899874 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:46:37.904407 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:46:37.906440 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:46:37.908406 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:46:37.909916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:46:37.916968 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:46:37.917935 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:46:37.918926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:37.942245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:37.942245 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:46:37.943256 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:46:37.947258 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:46:37.949257 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:46:37.951256 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:46:37.959297 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:37.960292 [debug] [MainThread]: On master: BEGIN
[0m20:46:37.960292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:37.983754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:37.984787 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:37.985788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:37.992777 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:37.997827 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:37.999794 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:38.000796 [debug] [MainThread]: On master: BEGIN
[0m20:46:38.004560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.005589 [debug] [MainThread]: On master: COMMIT
[0m20:46:38.006553 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:38.007548 [debug] [MainThread]: On master: COMMIT
[0m20:46:38.008560 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.010102 [debug] [MainThread]: On master: Close
[0m20:46:38.012134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:38.013116 [info ] [MainThread]: 
[0m20:46:38.018109 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:46:38.019108 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:46:38.020109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:46:38.021143 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:46:38.029143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.033109 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:46:38.022115 => 20:46:38.033109
[0m20:46:38.034112 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:46:38.071151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.075905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.076917 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:46:38.077915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:46:38.099597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.100635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.100635 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:46:38.104623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.112192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.113171 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:46:38.115161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.119195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.120194 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:46:38.122906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.138956 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:46:38.139916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.139916 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:46:38.144965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.156983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:46:38.157969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:46:38.165968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.167966 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:46:38.034112 => 20:46:38.167966
[0m20:46:38.168966 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:46:38.170981 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:46:38.172978 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:46:38.173990 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:46:38.174969 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:46:38.175991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:46:38.176996 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:46:38.180002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.183780 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:46:38.177976 => 20:46:38.183780
[0m20:46:38.184804 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:46:38.188790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.192794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.193826 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:46:38.194792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.219408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.220417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.221394 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:46:38.224322 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.228350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.229332 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:46:38.231350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.234340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.235338 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:46:38.238316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.240320 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:46:38.241319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.242320 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:46:38.245329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.248342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:46:38.249339 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:46:38.253316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.255341 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:46:38.184804 => 20:46:38.255341
[0m20:46:38.256316 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:46:38.258326 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:46:38.260344 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:46:38.261318 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:46:38.262314 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:46:38.264314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:46:38.265320 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:46:38.268351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.272319 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:46:38.265320 => 20:46:38.272319
[0m20:46:38.273351 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:46:38.279317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.283268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.284232 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:46:38.285231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.308563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.309574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.309574 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:46:38.313683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.316729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.317734 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:46:38.319695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.323729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.323729 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:46:38.326695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.328731 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:46:38.329694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.329694 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:46:38.332957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.337003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:46:38.337003 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:46:38.343048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.345049 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:46:38.274316 => 20:46:38.344049
[0m20:46:38.345049 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:46:38.347052 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.08s]
[0m20:46:38.349051 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:46:38.350050 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:46:38.351096 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:46:38.352051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:46:38.353083 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:46:38.357082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.365087 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:46:38.354055 => 20:46:38.365087
[0m20:46:38.366048 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:46:38.371047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.379084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.380048 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:46:38.381047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.403544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.403544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.404576 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:46:38.408547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.413137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.414117 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:46:38.416140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.420139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.421140 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:46:38.423922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.425933 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:46:38.426932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.426932 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:46:38.430937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.433932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:46:38.434933 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:46:38.439931 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.441934 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:46:38.367047 => 20:46:38.440933
[0m20:46:38.441934 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:46:38.443941 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:46:38.445935 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:46:38.447942 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:46:38.448933 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:46:38.450936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:46:38.451933 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:46:38.454969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.458934 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:46:38.451933 => 20:46:38.457970
[0m20:46:38.458934 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:46:38.464932 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.469935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.470933 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:46:38.470933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.502937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.503942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.504953 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:46:38.508938 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.516475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.518463 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:46:38.521462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.527636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.529652 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:46:38.532633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.535635 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:46:38.536653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.537632 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:46:38.542646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.548183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:46:38.549183 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:46:38.554185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.557796 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:46:38.459934 => 20:46:38.556806
[0m20:46:38.558794 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:46:38.560792 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:46:38.562793 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:46:38.564790 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:46:38.566104 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:46:38.568091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:46:38.569091 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:46:38.574045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.579029 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:46:38.569091 => 20:46:38.579029
[0m20:46:38.580064 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:46:38.585645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.591617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.593129 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:46:38.594140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.624228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.624228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.625742 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:46:38.630751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.634751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.636277 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:46:38.639292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.643286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.643286 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:46:38.646822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.650628 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:46:38.652655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.653641 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:46:38.657632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.661814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:46:38.662809 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:46:38.667809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.670803 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:46:38.580064 => 20:46:38.670803
[0m20:46:38.671841 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:46:38.674502 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:46:38.677501 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:46:38.678518 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:46:38.679524 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:46:38.682013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:46:38.683570 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:46:38.687564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:46:38.694486 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:46:38.683570 => 20:46:38.694486
[0m20:46:38.696510 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:46:38.704544 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:46:38.709513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:46:38.711142 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:46:38.712070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.739447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.740466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:46:38.741454 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:46:38.747160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.751188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:46:38.752291 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:46:38.755285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.758287 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:46:38.759284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:46:38.759979 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:46:38.764991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.770522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:46:38.770522 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:46:38.773524 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.777518 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:46:38.697474 => 20:46:38.776521
[0m20:46:38.778516 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:46:38.780524 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:46:38.782518 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:46:38.783615 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:46:38.784619 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:46:38.786666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:46:38.786666 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:46:38.790666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:46:38.795705 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:46:38.787671 => 20:46:38.795705
[0m20:46:38.796665 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:46:38.802692 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:46:38.808752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:46:38.809716 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:46:38.809716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.839015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.839947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:46:38.840975 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:46:38.845953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.849953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:46:38.852487 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:46:38.855999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.859015 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:46:38.860018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:46:38.861014 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:46:38.865421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.870129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:46:38.871132 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:46:38.874130 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.876200 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:46:38.797665 => 20:46:38.875128
[0m20:46:38.877199 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:46:38.879234 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:46:38.881203 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:46:38.882200 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:46:38.884198 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:46:38.885208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:46:38.886197 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:46:38.889201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.894731 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:46:38.887201 => 20:46:38.893719
[0m20:46:38.895734 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:46:38.903263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.908282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.909266 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:46:38.910275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:38.937966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:38.938992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.939980 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:46:38.946509 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:38.950540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.951540 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:46:38.954521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:38.957860 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:46:38.958762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.960769 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:46:38.964772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:38.971965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:46:38.973966 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:46:38.977494 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:38.981490 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:46:38.895734 => 20:46:38.981490
[0m20:46:38.983498 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:46:38.985498 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:46:38.988743 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:46:38.990496 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:46:38.992495 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:46:38.994493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:46:38.995493 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:46:39.003645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.011159 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:46:38.997016 => 20:46:39.009636
[0m20:46:39.012168 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:46:39.022702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.028312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.029312 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:46:39.030311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:39.054539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:39.055548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.056535 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:46:39.060570 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:39.064055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.065056 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:46:39.067055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.070058 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:46:39.071056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.072080 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:46:39.076055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:39.080053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:46:39.080559 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:46:39.083570 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:39.085565 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:46:39.013167 => 20:46:39.084568
[0m20:46:39.086567 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:46:39.088570 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.09s]
[0m20:46:39.090573 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:46:39.091566 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:46:39.092568 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:46:39.093599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:46:39.094567 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:46:39.098458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.103972 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:46:39.095453 => 20:46:39.102466
[0m20:46:39.104978 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:46:39.111498 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.116522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.117511 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:46:39.117511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:39.142503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:39.143485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.144485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:46:39.149484 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:46:39.153487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.154486 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:46:39.157485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.159485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:46:39.159485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.160485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:46:39.164486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:39.167484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:46:39.168485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:46:39.170486 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:46:39.172485 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:46:39.104978 => 20:46:39.172485
[0m20:46:39.173495 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:46:39.174486 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:46:39.176485 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:46:39.179756 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:39.179756 [debug] [MainThread]: On master: BEGIN
[0m20:46:39.180753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:39.204569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:39.204569 [debug] [MainThread]: On master: COMMIT
[0m20:46:39.205597 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:39.206597 [debug] [MainThread]: On master: COMMIT
[0m20:46:39.208599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:39.209597 [debug] [MainThread]: On master: Close
[0m20:46:39.210597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:39.212123 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:46:39.213143 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:46:39.213143 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:46:39.214131 [info ] [MainThread]: 
[0m20:46:39.215131 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m20:46:39.218948 [debug] [MainThread]: Command end result
[0m20:46:39.243928 [info ] [MainThread]: 
[0m20:46:39.244923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:39.245923 [info ] [MainThread]: 
[0m20:46:39.246832 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:46:39.247879 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:39.247879 after 2.70 seconds
[0m20:46:39.248902 [debug] [MainThread]: Flushing usage events


============================== 20:47:48.104754 | 6fb45c30-071d-45fa-afc1-4ca11764fb23 ==============================
[0m20:47:48.104754 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:47:48.109732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:47:48.232371 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:47:48.241343 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:47:48.253382 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:47:49.181391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgress.marts.core
[0m20:47:49.226960 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:47:49.229993 [info ] [MainThread]: 
[0m20:47:49.230960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:47:49.234961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:47:49.243960 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:47:49.244961 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:47:49.244961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:49.278476 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:47:49.280466 [debug] [ThreadPool]: On list_my_database: Close
[0m20:47:49.284492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:47:49.290510 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:47:49.291507 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:47:49.292482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:49.313558 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.313558 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:47:49.314558 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:47:49.318594 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:47:49.320558 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:47:49.322176 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:47:49.324192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:47:49.328221 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:47:49.329220 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:47:49.330198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:49.350973 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.351973 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:47:49.351973 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:47:49.355974 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:47:49.358006 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:47:49.359969 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:47:49.370007 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:49.370983 [debug] [MainThread]: On master: BEGIN
[0m20:47:49.370983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:49.393078 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.394068 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:49.394068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:49.401621 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:47:49.405618 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:49.407616 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:49.408617 [debug] [MainThread]: On master: BEGIN
[0m20:47:49.412114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.413104 [debug] [MainThread]: On master: COMMIT
[0m20:47:49.413104 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:49.414143 [debug] [MainThread]: On master: COMMIT
[0m20:47:49.416103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:47:49.416103 [debug] [MainThread]: On master: Close
[0m20:47:49.418107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:49.419124 [info ] [MainThread]: 
[0m20:47:49.424142 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:47:49.425106 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:47:49.427104 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:47:49.428103 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:47:49.435120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.443469 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:47:49.428103 => 20:47:49.442490
[0m20:47:49.444466 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:47:49.481475 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.488490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.489488 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:47:49.490476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:47:49.514001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.515511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.516526 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:47:49.521554 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:49.533523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.536069 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:47:49.541047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.545105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.546050 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:47:49.550093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.571564 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:47:49.572579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.572579 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:47:49.577678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:49.589282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:47:49.590265 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:47:49.595887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:49.598900 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:47:49.444466 => 20:47:49.598900
[0m20:47:49.600907 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:47:49.602902 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:47:49.604896 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:47:49.605897 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:47:49.607935 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:47:49.609900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:47:49.610899 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:47:49.613938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.620934 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:47:49.611417 => 20:47:49.619935
[0m20:47:49.621940 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:47:49.628903 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.636915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.638967 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:47:49.640936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:49.665434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.666467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.667995 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:47:49.672019 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:49.678037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.679001 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:47:49.682007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.684006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.686535 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:47:49.689060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.692060 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:47:49.692060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.693061 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:47:49.697330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:49.701316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:47:49.702342 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:47:49.706838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:49.709855 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:47:49.621940 => 20:47:49.708837
[0m20:47:49.710858 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:47:49.712839 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.10s]
[0m20:47:49.714853 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:47:49.715834 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:47:49.716837 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:47:49.718833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:47:49.719838 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:47:49.725942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.733950 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:47:49.720858 => 20:47:49.733950
[0m20:47:49.734969 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:47:49.742478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.749013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.751019 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:47:49.751019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:49.779887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.781628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.782629 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:47:49.786633 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:49.791840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.792840 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:47:49.796374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.800927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.801923 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:47:49.805446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.808454 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:47:49.809478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.810465 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:47:49.814463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:49.819458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:47:49.821183 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:47:49.826625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:49.829610 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:47:49.735954 => 20:47:49.829610
[0m20:47:49.831114 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:47:49.833130 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.11s]
[0m20:47:49.835122 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:47:49.836138 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:47:49.837122 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:47:49.839123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:47:49.840130 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:47:49.844173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.860143 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:47:49.841122 => 20:47:49.860143
[0m20:47:49.861123 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:47:49.866159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.877855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.878397 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:47:49.879412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:49.904578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:49.906087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.907095 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:47:49.911951 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:49.918504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.919543 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:47:49.922546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.926222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.927082 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:47:49.929086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:49.932106 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:47:49.933108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.934094 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:47:49.937230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:49.941260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:47:49.942263 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:47:49.947229 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:49.949239 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:47:49.862139 => 20:47:49.949239
[0m20:47:49.950243 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:47:49.952236 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:47:49.955254 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:47:49.956240 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:47:49.958229 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:47:49.959760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:47:49.960765 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:47:49.966750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:49.974306 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:47:49.961748 => 20:47:49.974306
[0m20:47:49.975303 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:47:49.981337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:49.987343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:49.988343 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:47:49.989365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.014400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.015401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:50.015401 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:47:50.020413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.025399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:50.026419 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:47:50.029397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.035411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:50.035411 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:47:50.038420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.043018 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:47:50.045015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:50.045981 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:47:50.050981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.055980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:47:50.056981 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:47:50.061515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.064547 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:47:49.976303 => 20:47:50.064547
[0m20:47:50.065527 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:47:50.068523 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:47:50.069519 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:47:50.070521 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:47:50.073070 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:47:50.074088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:47:50.075103 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:47:50.079701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.087686 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:47:50.076073 => 20:47:50.086687
[0m20:47:50.088685 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:47:50.094248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.104158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.105157 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:47:50.106159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.130217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.131217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.132217 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:47:50.136722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.141256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.142255 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:47:50.144261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.149273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.149965 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:47:50.152984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.155007 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:47:50.156020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.157533 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:47:50.161111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.166086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:47:50.167093 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:47:50.172092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.175107 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:47:50.088685 => 20:47:50.175107
[0m20:47:50.176086 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:47:50.178086 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:47:50.180721 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:47:50.181730 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:47:50.183740 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:47:50.185738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:47:50.186737 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:47:50.189746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:47:50.197791 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:47:50.187737 => 20:47:50.197791
[0m20:47:50.198790 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:47:50.207328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:47:50.217404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:47:50.218403 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:47:50.218403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.245151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.246149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:47:50.247149 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:47:50.252148 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.255147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:47:50.256157 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:47:50.258147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.261147 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:47:50.261147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:47:50.262148 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:47:50.266160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.270147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:47:50.271147 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:47:50.273151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.276183 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:47:50.199791 => 20:47:50.276183
[0m20:47:50.277150 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:47:50.278659 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:47:50.280683 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:47:50.281670 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:47:50.282732 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:47:50.283679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:47:50.284715 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:47:50.288710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:47:50.295681 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:47:50.285723 => 20:47:50.294681
[0m20:47:50.295681 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:47:50.300289 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:47:50.308428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:47:50.310418 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:47:50.310418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.334968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.335969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:47:50.336972 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:47:50.341003 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.344539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:47:50.345538 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:47:50.348540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.350538 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:47:50.351541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:47:50.351541 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:47:50.356536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.359573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:47:50.360571 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:47:50.362538 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.365067 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:47:50.296675 => 20:47:50.365067
[0m20:47:50.366071 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:47:50.368073 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:47:50.370061 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:47:50.371064 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:47:50.372062 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:47:50.374063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:47:50.375065 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:47:50.378580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.386665 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:47:50.376063 => 20:47:50.385697
[0m20:47:50.387679 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:47:50.392664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.399820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.401329 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:47:50.402341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.432435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.433444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.434430 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:47:50.438928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.441965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.442964 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:47:50.446930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.448930 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:47:50.449988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.450930 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:47:50.454929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.458931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:47:50.459934 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:47:50.462930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.464966 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:47:50.387679 => 20:47:50.463931
[0m20:47:50.465935 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:47:50.467942 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:47:50.469963 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:47:50.470944 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:47:50.471949 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:47:50.473966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:47:50.473966 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:47:50.478957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.485967 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:47:50.474957 => 20:47:50.484967
[0m20:47:50.485967 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:47:50.495803 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.503744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.504725 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:47:50.504725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.530517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.532532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.533514 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:47:50.540514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.544547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.544547 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:47:50.547515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.549512 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:47:50.550832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.551531 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:47:50.556517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.561844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:47:50.563046 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:47:50.565564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.568577 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:47:50.486966 => 20:47:50.568577
[0m20:47:50.569585 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:47:50.572578 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.10s]
[0m20:47:50.574587 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:47:50.575593 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:47:50.576578 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:47:50.578578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:47:50.578886 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:47:50.582598 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.591425 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:47:50.579605 => 20:47:50.590434
[0m20:47:50.592424 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:47:50.596936 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.605992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.607017 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:47:50.608034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:50.633593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.634678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.635662 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:47:50.641021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:47:50.644660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.645677 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:47:50.648631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:47:50.651149 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:47:50.652187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.652187 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:47:50.657160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.661157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:47:50.662161 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:47:50.665162 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:47:50.667704 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:47:50.592424 => 20:47:50.667159
[0m20:47:50.668710 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:47:50.670746 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:47:50.672142 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:47:50.675140 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:50.676150 [debug] [MainThread]: On master: BEGIN
[0m20:47:50.677134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:50.702288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:47:50.703317 [debug] [MainThread]: On master: COMMIT
[0m20:47:50.704289 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:50.704289 [debug] [MainThread]: On master: COMMIT
[0m20:47:50.707814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:47:50.707814 [debug] [MainThread]: On master: Close
[0m20:47:50.710089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:50.711816 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:47:50.713813 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:47:50.714826 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:47:50.716815 [info ] [MainThread]: 
[0m20:47:50.718830 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m20:47:50.721400 [debug] [MainThread]: Command end result
[0m20:47:50.758252 [info ] [MainThread]: 
[0m20:47:50.760286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:50.761266 [info ] [MainThread]: 
[0m20:47:50.762265 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:47:50.763266 [debug] [MainThread]: Command `dbt run` succeeded at 20:47:50.763266 after 2.70 seconds
[0m20:47:50.764265 [debug] [MainThread]: Flushing usage events


============================== 20:48:02.950767 | 99dd6eee-11f5-4394-ae22-605a10a45cec ==============================
[0m20:48:02.950767 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:48:02.956790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:48:03.111390 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:48:03.121972 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:48:03.139559 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:48:04.391672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.core
[0m20:48:04.446122 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:48:04.450521 [info ] [MainThread]: 
[0m20:48:04.453537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:04.460097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:48:04.475629 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:48:04.476137 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:48:04.477146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:04.520079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:48:04.522076 [debug] [ThreadPool]: On list_my_database: Close
[0m20:48:04.528081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:48:04.540545 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:48:04.541555 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:48:04.542555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:04.580125 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:04.581115 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:48:04.582117 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:48:04.589116 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:48:04.591651 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:48:04.595209 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:48:04.598698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:48:04.608244 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:48:04.609243 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:48:04.610750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:04.644990 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:04.645991 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:48:04.646988 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:48:04.652501 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:48:04.656475 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:48:04.659515 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:48:04.669474 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:04.670474 [debug] [MainThread]: On master: BEGIN
[0m20:48:04.670474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:04.697069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:04.698068 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:04.699070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:04.709597 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:04.714636 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:04.716674 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:04.718211 [debug] [MainThread]: On master: BEGIN
[0m20:48:04.721796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:04.723777 [debug] [MainThread]: On master: COMMIT
[0m20:48:04.723777 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:04.724789 [debug] [MainThread]: On master: COMMIT
[0m20:48:04.727796 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:04.728780 [debug] [MainThread]: On master: Close
[0m20:48:04.729782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:04.731318 [info ] [MainThread]: 
[0m20:48:04.737838 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:48:04.739843 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:48:04.742394 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:48:04.743397 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:48:04.759221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.767782 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:48:04.744397 => 20:48:04.766847
[0m20:48:04.769801 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:48:04.833120 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.840103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.841103 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:48:04.841103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:48:04.869376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:04.870409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.871410 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:48:04.875376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:04.882962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.884471 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:48:04.887045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:04.892031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.893030 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:48:04.895421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:04.919174 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:48:04.920142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.921137 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:48:04.925173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:04.937269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:04.939274 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:48:04.943816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:04.947369 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:48:04.770810 => 20:48:04.947369
[0m20:48:04.948353 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:48:04.950352 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.21s]
[0m20:48:04.953357 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:48:04.955351 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:04.956353 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:48:04.957350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:48:04.958858 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:04.962907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:04.971973 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:48:04.959867 => 20:48:04.971016
[0m20:48:04.972973 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:04.977976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:04.985493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:04.987784 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:48:04.989795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.018438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.019613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:05.020612 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:48:05.025631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.029613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:05.030613 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:48:05.034616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.041173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:05.043181 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:48:05.047154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.050205 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:48:05.051168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:05.052151 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:48:05.056702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.060705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:05.061703 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:48:05.068705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.070703 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:48:04.972973 => 20:48:05.070703
[0m20:48:05.072704 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:48:05.074859 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:48:05.076866 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:05.079855 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:05.080861 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:48:05.083540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:48:05.084543 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:05.089542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.100082 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:48:05.085543 => 20:48:05.099083
[0m20:48:05.100082 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:05.111697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.122263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.123263 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:48:05.125262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.157948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.158957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.159991 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:48:05.165960 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.173399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.175911 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:48:05.178958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.183536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.184552 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:48:05.187829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.190340 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:48:05.191352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.192365 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:48:05.196895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.201889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:05.202904 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:48:05.207936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.211647 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:48:05.102691 => 20:48:05.210139
[0m20:48:05.212658 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:48:05.215188 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.13s]
[0m20:48:05.217777 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:05.219779 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:05.221797 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:48:05.224355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:48:05.225365 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:05.230903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.244547 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:48:05.226380 => 20:48:05.244547
[0m20:48:05.245551 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:05.255615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.270677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.271188 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:48:05.272201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.300785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.301783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.302781 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:48:05.307351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.315168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.316176 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:48:05.319176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.325699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.326702 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:48:05.330234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.333250 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:48:05.334246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.335249 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:48:05.339272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.344793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:05.346811 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:48:05.352310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.354822 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:48:05.245551 => 20:48:05.354822
[0m20:48:05.355830 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:48:05.357834 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:48:05.359833 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:05.360835 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:48:05.361832 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:48:05.363831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:48:05.363831 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:48:05.367832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.375394 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:48:05.364829 => 20:48:05.375394
[0m20:48:05.376986 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:48:05.383392 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.390921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.391937 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:48:05.391937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.418150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.419147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.420156 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:48:05.424151 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.429677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.430693 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:48:05.432679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.438223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.439231 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:48:05.442238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.444506 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:48:05.445505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.446505 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:48:05.450506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.453503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:05.454504 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:48:05.458504 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.461507 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:48:05.377391 => 20:48:05.461507
[0m20:48:05.462508 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:48:05.465013 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:05.468032 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:48:05.469027 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:05.470026 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:48:05.472023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:48:05.473021 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:05.476025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.482021 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:48:05.473021 => 20:48:05.482021
[0m20:48:05.483532 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:05.489540 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.495539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.497550 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:48:05.498552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.521580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.522578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.523579 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:48:05.528098 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.532092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.532345 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:48:05.535097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.541096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.542095 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:48:05.545596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.549573 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:48:05.550570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.550570 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:48:05.555574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.559571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:05.560568 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:48:05.564829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.568183 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:48:05.483532 => 20:48:05.568183
[0m20:48:05.569177 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:48:05.572182 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:05.574485 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:05.576179 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:48:05.577180 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:48:05.578180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:48:05.579179 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:48:05.582767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:48:05.590293 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:48:05.580213 => 20:48:05.589292
[0m20:48:05.592294 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:48:05.606797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:48:05.613313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:05.614310 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:48:05.615314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.640685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.641682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:05.642683 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:48:05.646685 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.649719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:05.650722 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:48:05.653686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.656242 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:48:05.657242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:05.657242 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:48:05.661242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.665278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:05.666298 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:48:05.669243 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.670244 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:48:05.593294 => 20:48:05.670244
[0m20:48:05.671243 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:48:05.673779 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:05.675808 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:48:05.676792 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:48:05.677791 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:48:05.679791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:48:05.680809 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:48:05.683910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:48:05.690809 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:48:05.680809 => 20:48:05.690809
[0m20:48:05.691792 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:48:05.696407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:48:05.703403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:05.704383 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:48:05.705400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.728442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.729423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:05.730423 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:48:05.735937 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.739937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:05.741060 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:48:05.743942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.745972 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:48:05.746938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:05.747973 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:48:05.751937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.755449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:05.756450 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:48:05.758454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.761431 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:48:05.691792 => 20:48:05.761431
[0m20:48:05.762417 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:48:05.764421 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:48:05.767422 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:48:05.769420 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:48:05.770420 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:48:05.771927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:48:05.771927 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:48:05.775968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.783947 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:48:05.772939 => 20:48:05.782936
[0m20:48:05.784934 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:48:05.789969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.796568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.798579 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:48:05.798579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.827629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.829654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.830628 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:48:05.836743 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:05.845073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.846735 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:48:05.849730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:05.854261 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:48:05.856263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.857279 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:48:05.863263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:05.868258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:05.870260 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:48:05.873767 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:05.876774 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:48:05.784934 => 20:48:05.875775
[0m20:48:05.877777 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:48:05.880775 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:48:05.882783 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:48:05.884795 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:48:05.887778 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:48:05.890805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:48:05.892960 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:48:05.900968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:48:05.910978 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:48:05.894976 => 20:48:05.910978
[0m20:48:05.912485 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:48:05.928127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:48:05.940687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:05.942679 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:48:05.944678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:05.981941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:05.982927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:05.984931 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:48:05.991930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:06.002178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:06.004171 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:48:06.009177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:06.012684 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:48:06.014692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:06.015702 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:48:06.020200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:06.027208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:06.028209 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:48:06.031214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:06.034214 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:48:05.913497 => 20:48:06.033207
[0m20:48:06.035210 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:48:06.038214 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.15s]
[0m20:48:06.041766 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:48:06.043778 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:48:06.045763 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:48:06.047761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:48:06.048766 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:48:06.053761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.062764 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:48:06.049761 => 20:48:06.061762
[0m20:48:06.063901 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:48:06.070901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.079899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.080916 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:48:06.082899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:06.109688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:06.110708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.111688 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:48:06.116784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:06.122794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.122794 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:48:06.126314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:06.129317 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:48:06.130317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.130317 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:48:06.134316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:06.139313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:06.140317 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:48:06.143336 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:06.145824 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:48:06.064918 => 20:48:06.145824
[0m20:48:06.147832 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:48:06.149831 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:06.152850 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:48:06.155832 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:06.156833 [debug] [MainThread]: On master: BEGIN
[0m20:48:06.157831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:06.188960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:06.189989 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.190988 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:06.191967 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.193969 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:06.195977 [debug] [MainThread]: On master: Close
[0m20:48:06.197979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:06.198981 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:48:06.199979 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:48:06.201981 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:48:06.202977 [info ] [MainThread]: 
[0m20:48:06.203986 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m20:48:06.207976 [debug] [MainThread]: Command end result
[0m20:48:06.239984 [info ] [MainThread]: 
[0m20:48:06.241990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:06.242987 [info ] [MainThread]: 
[0m20:48:06.244008 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:48:06.245989 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:06.245989 after 3.34 seconds
[0m20:48:06.246992 [debug] [MainThread]: Flushing usage events


============================== 20:48:29.672722 | 87e201be-f5e7-4e4d-8fbf-2b91a8ddcaaa ==============================
[0m20:48:29.672722 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:48:29.678723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m20:48:29.680760 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX/profiles.yml
  
[0m20:48:29.682726 [debug] [MainThread]: Command `dbt run` failed at 20:48:29.681722 after 0.05 seconds
[0m20:48:29.682726 [debug] [MainThread]: Flushing usage events


============================== 20:48:44.564533 | 2ed64574-68f8-4517-890e-fa418795ae42 ==============================
[0m20:48:44.564533 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:48:44.571510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m20:48:44.577051 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_postgress'
[0m20:48:44.579053 [debug] [MainThread]: Command `dbt run` failed at 20:48:44.579053 after 0.06 seconds
[0m20:48:44.580052 [debug] [MainThread]: Flushing usage events


============================== 20:48:56.491874 | fb5c0e58-f8e5-40d2-b6bf-125c8b2ea257 ==============================
[0m20:48:56.491874 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:48:56.496877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m20:48:56.641286 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:48:56.650296 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:48:56.662341 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:48:57.743970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres.marts.core
[0m20:48:57.788205 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:48:57.791169 [info ] [MainThread]: 
[0m20:48:57.793166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:57.796210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:48:57.805216 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:48:57.806216 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:48:57.806216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:57.841349 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:48:57.842347 [debug] [ThreadPool]: On list_my_database: Close
[0m20:48:57.846348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:48:57.852347 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:48:57.853377 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:48:57.853377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:57.876353 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:57.877352 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:48:57.877352 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:48:57.881391 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:48:57.883353 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:48:57.885357 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:48:57.887378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:48:57.891368 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:48:57.892373 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:48:57.892373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:57.914416 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:57.914416 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:48:57.915418 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:48:57.920419 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:48:57.922452 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:48:57.925417 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:48:57.935456 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:57.936416 [debug] [MainThread]: On master: BEGIN
[0m20:48:57.937417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:57.959881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:57.960883 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:57.961885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:57.969874 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:57.975289 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:57.977853 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:57.977853 [debug] [MainThread]: On master: BEGIN
[0m20:48:57.981862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:57.982879 [debug] [MainThread]: On master: COMMIT
[0m20:48:57.982879 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:57.983867 [debug] [MainThread]: On master: COMMIT
[0m20:48:57.986219 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:57.986219 [debug] [MainThread]: On master: Close
[0m20:48:57.988238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:57.989257 [info ] [MainThread]: 
[0m20:48:57.996232 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:48:57.997243 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:48:57.999232 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:48:57.999232 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:48:58.010230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.018235 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:48:58.000282 => 20:48:58.018235
[0m20:48:58.019232 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:48:58.070270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.077811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.078820 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:48:58.079814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:48:58.107816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.108813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.109827 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:48:58.114811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.123810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.124812 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:48:58.127841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.132827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.133808 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:48:58.136810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.162827 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:48:58.163820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.164820 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:48:58.169820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.185996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:48:58.187997 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:48:58.194000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.199002 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:48:58.020231 => 20:48:58.198000
[0m20:48:58.199996 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:48:58.203000 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.20s]
[0m20:48:58.205009 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:48:58.206996 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:58.208010 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:48:58.209996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:48:58.211059 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:58.216999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.225998 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:48:58.212010 => 20:48:58.225021
[0m20:48:58.226996 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:58.235567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.245504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.247494 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:48:58.248697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.279103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.280103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.281117 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:48:58.286099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.294112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.295094 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:48:58.298095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.303096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.304116 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:48:58.307119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.311116 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:48:58.312098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.313094 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:48:58.317098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.321118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:48:58.322118 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:48:58.326999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.329998 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:48:58.228007 => 20:48:58.329998
[0m20:48:58.331000 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:48:58.333004 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:48:58.335005 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:48:58.337001 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:58.338001 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:48:58.340006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:48:58.340006 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:58.343998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.353005 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:48:58.341053 => 20:48:58.353005
[0m20:48:58.354017 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:58.360019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.367015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.369018 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:48:58.370015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.393965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.394966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.395967 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:48:58.399936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.402964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.403958 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:48:58.405941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.409937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.410973 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:48:58.412936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.415937 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:48:58.416971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.416971 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:48:58.420725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.424764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:48:58.424764 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:48:58.429726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.431742 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:48:58.355000 => 20:48:58.431742
[0m20:48:58.432726 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:48:58.433749 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.09s]
[0m20:48:58.435731 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:48:58.436735 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:58.437728 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:48:58.438790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:48:58.439752 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:58.442754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.452561 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:48:58.440726 => 20:48:58.452561
[0m20:48:58.453577 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:58.457610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.468657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.469618 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:48:58.470627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.493323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.493323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.494357 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:48:58.498326 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.502326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.503326 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:48:58.505360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.509359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.510326 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:48:58.512356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.514387 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:48:58.515384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.515384 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:48:58.519416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.522450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:48:58.523417 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:48:58.527417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.529417 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:48:58.453577 => 20:48:58.529417
[0m20:48:58.530416 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:48:58.532435 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:48:58.534433 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:48:58.535419 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:48:58.537452 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:48:58.538448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:48:58.539417 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:48:58.542455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.548444 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:48:58.540420 => 20:48:58.548444
[0m20:48:58.549439 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:48:58.555422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.564508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.565524 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:48:58.565524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.593582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.594586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.595584 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:48:58.601159 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.607757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.609274 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:48:58.612281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.617268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.618267 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:48:58.621269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.624272 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:48:58.625272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.625272 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:48:58.630269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.635272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:48:58.636311 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:48:58.641476 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.645470 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:48:58.549439 => 20:48:58.644486
[0m20:48:58.646473 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:48:58.648477 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:48:58.651497 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:48:58.652473 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:58.653472 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:48:58.655477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:48:58.656474 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:58.659504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.669872 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:48:58.656474 => 20:48:58.668869
[0m20:48:58.670884 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:58.678387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.686391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.687402 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:48:58.688425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.716406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.717413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.718404 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:48:58.721631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.726629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.727629 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:48:58.729629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.733595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.733595 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:48:58.736487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.739500 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:48:58.739500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.740499 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:48:58.744434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.748432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:48:58.749467 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:48:58.754431 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.757438 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:48:58.670884 => 20:48:58.757438
[0m20:48:58.758463 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:48:58.760463 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:48:58.763462 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:48:58.764448 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:48:58.765446 [info ] [Thread-1 (]: 7 of 11 START sql view model public.fact_orders ................................ [RUN]
[0m20:48:58.767444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:48:58.768461 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:48:58.772965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:48:58.780384 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:48:58.770463 => 20:48:58.780384
[0m20:48:58.782388 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:48:58.792415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:48:58.800387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:58.801389 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:48:58.802416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.829386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.830413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:58.832392 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  create view "my_database"."public"."fact_orders__dbt_tmp"
    
    
  as (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
[0m20:48:58.837401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.841383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:58.842382 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:48:58.845380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.849399 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:48:58.850417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:58.851389 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:48:58.855401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.860437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:48:58.861415 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop view if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:48:58.864414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.867461 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:48:58.783383 => 20:48:58.866437
[0m20:48:58.868414 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:48:58.870419 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.fact_orders ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:58.872937 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:48:58.873948 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:48:58.874948 [info ] [Thread-1 (]: 8 of 11 START sql view model public.dim_customers .............................. [RUN]
[0m20:48:58.876950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:48:58.877951 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:48:58.882952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:48:58.889945 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:48:58.878971 => 20:48:58.888947
[0m20:48:58.890946 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:48:58.897999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:48:58.904947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:58.906966 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:48:58.907948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:58.934965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:58.935961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:58.936969 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  create view "my_database"."public"."dim_customers__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
[0m20:48:58.942947 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:58.946945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:58.948001 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:48:58.949952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:58.952950 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:48:58.953947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:58.954948 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:48:58.958953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:58.962954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:48:58.963970 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop view if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:48:58.965955 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:58.968954 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:48:58.891961 => 20:48:58.968954
[0m20:48:58.969954 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:48:58.971953 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.dim_customers ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:48:58.973493 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:48:58.974507 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:48:58.975525 [info ] [Thread-1 (]: 9 of 11 START sql view model public.fact_stocks ................................ [RUN]
[0m20:48:58.977499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:48:58.978504 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:48:58.982524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:48:58.990545 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:48:58.979513 => 20:48:58.990545
[0m20:48:58.991531 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:48:58.998501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.007530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.007530 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:48:59.008527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:59.032501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:59.034521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.034521 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  create view "my_database"."public"."fact_stocks__dbt_tmp"
    
    
  as (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
[0m20:48:59.039525 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:59.042524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.043527 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:48:59.046537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:59.048537 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:48:59.052553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.053566 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:48:59.058587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:59.062586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:48:59.063582 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop view if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:48:59.065582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:59.067582 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:48:58.992500 => 20:48:59.067582
[0m20:48:59.068584 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:48:59.069583 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.fact_stocks ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:48:59.071593 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:48:59.073105 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:48:59.074127 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:48:59.075129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:48:59.076113 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:48:59.079112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.087118 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:48:59.077113 => 20:48:59.087118
[0m20:48:59.088112 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:48:59.096112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.103274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.104248 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:48:59.104248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:59.125256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:59.126268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.127243 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:48:59.131835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:59.134845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.135844 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:48:59.137847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:59.139846 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:48:59.140845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.140845 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:48:59.144421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:59.148424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:48:59.149472 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:48:59.151423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:59.153449 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:48:59.089111 => 20:48:59.153449
[0m20:48:59.154474 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:48:59.156425 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:48:59.158432 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:48:59.159447 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:48:59.160478 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:48:59.161433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:48:59.162445 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:48:59.165458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.171193 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:48:59.162445 => 20:48:59.170218
[0m20:48:59.171193 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:48:59.176776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.184749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.184749 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:48:59.185769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:59.210022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:59.211019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.212046 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:48:59.216018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:48:59.220045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.221019 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:48:59.224034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:48:59.227045 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:48:59.227045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.228043 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:48:59.231890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:48:59.234939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:48:59.236906 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:48:59.239386 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:48:59.240397 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:48:59.172219 => 20:48:59.240397
[0m20:48:59.241397 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:48:59.243399 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:48:59.244439 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:48:59.247397 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:59.247397 [debug] [MainThread]: On master: BEGIN
[0m20:48:59.248435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:59.270520 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:59.271529 [debug] [MainThread]: On master: COMMIT
[0m20:48:59.272506 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:59.272506 [debug] [MainThread]: On master: COMMIT
[0m20:48:59.275881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:59.275881 [debug] [MainThread]: On master: Close
[0m20:48:59.277856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:59.278853 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:48:59.279874 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:48:59.280854 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:48:59.281854 [info ] [MainThread]: 
[0m20:48:59.282848 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m20:48:59.285883 [debug] [MainThread]: Command end result
[0m20:48:59.310779 [info ] [MainThread]: 
[0m20:48:59.312739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:59.312739 [info ] [MainThread]: 
[0m20:48:59.313774 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:48:59.314740 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:59.314740 after 2.86 seconds
[0m20:48:59.315773 [debug] [MainThread]: Flushing usage events


============================== 20:52:01.397112 | 0dd69220-ddb2-43a8-b3ff-2b9869404d21 ==============================
[0m20:52:01.397112 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:52:01.402655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:52:01.562734 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:52:01.573733 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:52:01.589805 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:52:03.081574 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:52:03.085632 [info ] [MainThread]: 
[0m20:52:03.086599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:03.089582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:52:03.102224 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:52:03.104187 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:52:03.105191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:03.138176 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:52:03.140173 [debug] [ThreadPool]: On list_my_database: Close
[0m20:52:03.145176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m20:52:03.153179 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:52:03.154175 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:52:03.155170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:03.181175 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.182178 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:52:03.183180 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:52:03.188632 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:52:03.191611 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:52:03.194616 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:52:03.197617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m20:52:03.204145 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:52:03.205314 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:52:03.206313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:03.235316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.236311 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:52:03.237312 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:52:03.249312 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:52:03.251318 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:52:03.255312 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:52:03.268317 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:03.269314 [debug] [MainThread]: On master: BEGIN
[0m20:52:03.270316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:03.295329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.296316 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:03.297349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:03.306383 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:03.311829 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:03.314849 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:03.315826 [debug] [MainThread]: On master: BEGIN
[0m20:52:03.319826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.320830 [debug] [MainThread]: On master: COMMIT
[0m20:52:03.321829 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:03.322828 [debug] [MainThread]: On master: COMMIT
[0m20:52:03.325845 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.326844 [debug] [MainThread]: On master: Close
[0m20:52:03.328823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:03.330828 [info ] [MainThread]: 
[0m20:52:03.338828 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:52:03.340826 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:52:03.344824 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:52:03.346839 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:52:03.364828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.373826 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:52:03.348829 => 20:52:03.372832
[0m20:52:03.374828 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:52:03.424404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.431404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.432407 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:52:03.432407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:03.458419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.459430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.460405 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:52:03.464418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:03.471436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.473399 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:52:03.475405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.479440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.480462 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:52:03.484402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.507851 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:52:03.509861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.510380 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:52:03.515413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.529392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:52:03.530393 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:52:03.536851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:03.539893 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:52:03.375827 => 20:52:03.539893
[0m20:52:03.540846 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:52:03.543846 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.20s]
[0m20:52:03.545855 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:52:03.547851 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:52:03.548846 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:52:03.550845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:52:03.551861 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:52:03.556884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.565886 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:52:03.552847 => 20:52:03.565886
[0m20:52:03.566877 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:52:03.575851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.584854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.585897 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:52:03.586860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:03.614271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.615307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.616327 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:52:03.621274 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:03.628276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.629273 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:52:03.631274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.635309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.637272 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:52:03.639278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.642312 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:52:03.643273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.643273 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:52:03.648274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.652274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:52:03.653286 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:52:03.659274 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:03.662273 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:52:03.567874 => 20:52:03.661296
[0m20:52:03.663276 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:52:03.665280 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.11s]
[0m20:52:03.667280 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:52:03.668272 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:52:03.669274 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:52:03.671276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:52:03.672285 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:52:03.675307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.681272 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:52:03.672285 => 20:52:03.681272
[0m20:52:03.682307 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:52:03.690664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.697627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.698625 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:52:03.699637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:03.723743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.724741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.725779 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:52:03.730742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:03.734746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.734746 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:52:03.737757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.742761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.743762 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:52:03.747277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.750276 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:52:03.752280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.753277 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:52:03.757839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.763836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:52:03.765414 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:52:03.770414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:03.773672 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:52:03.683309 => 20:52:03.773672
[0m20:52:03.775705 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:52:03.778686 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.11s]
[0m20:52:03.781208 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:52:03.782251 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:52:03.783248 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:52:03.785249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:52:03.786267 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:52:03.789288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.800786 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:52:03.786267 => 20:52:03.799786
[0m20:52:03.800786 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:52:03.806510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.819079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.820072 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:52:03.821089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:03.846171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.847175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.848208 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:52:03.853176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:03.862327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.864291 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:52:03.867392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.870387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.871421 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:52:03.874388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.876418 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:52:03.877419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.878388 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:52:03.882707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.886629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:52:03.887253 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:52:03.892247 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:03.894275 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:52:03.801991 => 20:52:03.894275
[0m20:52:03.895272 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:52:03.898299 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:52:03.899298 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:52:03.901316 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:52:03.902324 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:52:03.904324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:52:03.905324 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:52:03.909360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.916343 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:52:03.906407 => 20:52:03.916343
[0m20:52:03.917930 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:52:03.923387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.930384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.931396 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:52:03.932421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:03.959431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:03.959431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.961453 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:52:03.965460 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:03.971466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.972470 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:52:03.975461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.979495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.979495 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:52:03.983000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:03.986054 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:52:03.987056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.988075 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:52:03.993023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:03.998061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:52:03.999018 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:52:04.003565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:04.007564 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:52:03.918866 => 20:52:04.006552
[0m20:52:04.008549 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:52:04.010552 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:52:04.014074 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:52:04.015085 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:52:04.017108 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:52:04.018082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:52:04.019117 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:52:04.022636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.031589 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:52:04.020099 => 20:52:04.031589
[0m20:52:04.033588 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:52:04.040206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.048727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.049760 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:52:04.050719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.082857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.083857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.085562 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:52:04.092041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:04.101466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.102554 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:52:04.105826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.110924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.111942 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:52:04.114942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.120519 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:52:04.121482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.122485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:52:04.127516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.130556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:52:04.132538 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:52:04.137526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:04.141043 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:52:04.033588 => 20:52:04.140033
[0m20:52:04.142040 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:52:04.144052 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:52:04.147578 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:52:04.148597 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:52:04.151155 [info ] [Thread-1 (]: 7 of 11 START sql table model public.fact_orders ............................... [RUN]
[0m20:52:04.153154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:52:04.154163 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:52:04.158158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:52:04.167197 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:52:04.155137 => 20:52:04.166155
[0m20:52:04.168165 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:52:04.199328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:52:04.206920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:52:04.207951 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:52:04.208916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.234565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.235565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:52:04.236590 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:52:04.246100 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:52:04.251642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:52:04.253611 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:52:04.257119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.267132 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:52:04.268133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:52:04.269134 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:52:04.274137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.282992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:52:04.284045 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:52:04.287017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:52:04.290014 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:52:04.169165 => 20:52:04.289027
[0m20:52:04.291011 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:52:04.293509 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.14s]
[0m20:52:04.296030 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:52:04.297065 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:52:04.298032 [info ] [Thread-1 (]: 8 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m20:52:04.300065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:52:04.300065 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:52:04.304135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:52:04.313133 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:52:04.301580 => 20:52:04.312176
[0m20:52:04.313133 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:52:04.324280 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:52:04.331800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:52:04.332843 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:52:04.333807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.360991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.361990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:52:04.362993 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:52:04.368076 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:52:04.372988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:52:04.373990 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:52:04.376002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.379513 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:52:04.380520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:52:04.381033 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:52:04.385042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.395047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:52:04.396047 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:52:04.399050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:52:04.401820 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:52:04.315684 => 20:52:04.401820
[0m20:52:04.403909 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:52:04.406906 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.11s]
[0m20:52:04.408916 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:52:04.409942 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:52:04.410910 [info ] [Thread-1 (]: 9 of 11 START sql table model public.fact_stocks ............................... [RUN]
[0m20:52:04.412941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:52:04.413911 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:52:04.419941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.428040 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:52:04.414907 => 20:52:04.428040
[0m20:52:04.429059 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:52:04.437047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.443794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.444793 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:52:04.445798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.474802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.476798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.477796 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:52:04.628940 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:52:04.634733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.635730 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:52:04.639256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.642260 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:52:04.643257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.644254 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:52:04.719403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.725929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:52:04.726775 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:52:04.729790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:52:04.735312 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:52:04.430082 => 20:52:04.734317
[0m20:52:04.736309 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:52:04.741042 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.33s]
[0m20:52:04.744575 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:52:04.746573 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:52:04.750192 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:52:04.753192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:52:04.755199 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:52:04.767041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.776601 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:52:04.758257 => 20:52:04.775587
[0m20:52:04.777117 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:52:04.788647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.797180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.799326 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:52:04.801031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.828122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.829117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.830636 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:52:04.836186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:04.842188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.843181 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:52:04.845941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.849462 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:52:04.849462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.850468 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:52:04.854475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.861000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:52:04.861999 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:52:04.866002 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:04.868003 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:52:04.777117 => 20:52:04.868003
[0m20:52:04.868998 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:52:04.871521 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.12s]
[0m20:52:04.874538 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:52:04.875531 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:52:04.877051 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:52:04.879249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:52:04.880064 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:52:04.884591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.892123 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:52:04.881064 => 20:52:04.892123
[0m20:52:04.894119 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:52:04.900648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.909699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.910696 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:52:04.912699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:04.938433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:52:04.939429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.940431 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:52:04.944865 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:52:04.950117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.951130 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:52:04.953120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:52:04.957641 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:52:04.958645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.959641 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:52:04.962646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:52:04.967687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:52:04.968685 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:52:04.971689 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:52:04.973692 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:52:04.894119 => 20:52:04.973692
[0m20:52:04.974687 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:52:04.976690 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.10s]
[0m20:52:04.978688 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:52:04.982209 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:04.983215 [debug] [MainThread]: On master: BEGIN
[0m20:52:04.984208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:05.009866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:05.010859 [debug] [MainThread]: On master: COMMIT
[0m20:52:05.012872 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:05.015862 [debug] [MainThread]: On master: COMMIT
[0m20:52:05.018929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:52:05.020078 [debug] [MainThread]: On master: Close
[0m20:52:05.022947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:05.023930 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:52:05.024930 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m20:52:05.025950 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:52:05.027341 [info ] [MainThread]: 
[0m20:52:05.028363 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m20:52:05.033880 [debug] [MainThread]: Command end result
[0m20:52:05.069759 [info ] [MainThread]: 
[0m20:52:05.071370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:05.073387 [info ] [MainThread]: 
[0m20:52:05.074397 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:52:05.076382 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:05.075396 after 3.72 seconds
[0m20:52:05.077378 [debug] [MainThread]: Flushing usage events


============================== 20:53:30.564315 | 60d20f00-c6a4-41c5-bff6-79baa4678575 ==============================
[0m20:53:30.564315 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:53:30.569282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m20:53:30.703832 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:53:30.712027 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:53:30.724036 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:53:31.836530 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:53:31.839557 [info ] [MainThread]: 
[0m20:53:31.841572 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:31.844535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:53:31.854541 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:53:31.855538 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:53:31.856538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:31.888521 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:53:31.889552 [debug] [ThreadPool]: On list_my_database: Close
[0m20:53:31.893528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:53:31.898981 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:53:31.899986 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:53:31.900988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:31.922847 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:53:31.923876 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:53:31.924849 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:53:31.928843 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:53:31.930888 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:53:31.932851 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:53:31.934873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:53:31.941663 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:53:31.941663 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:53:31.942663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:31.964022 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:53:31.965022 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:53:31.965022 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:53:31.970018 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:53:31.971054 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:53:31.973018 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:53:31.980020 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:31.981015 [debug] [MainThread]: On master: BEGIN
[0m20:53:31.982029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:32.008620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.008620 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:32.009654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:32.018652 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m20:53:32.022647 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:32.025616 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:32.026635 [debug] [MainThread]: On master: BEGIN
[0m20:53:32.029617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.030616 [debug] [MainThread]: On master: COMMIT
[0m20:53:32.031616 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:32.031616 [debug] [MainThread]: On master: COMMIT
[0m20:53:32.033626 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.034642 [debug] [MainThread]: On master: Close
[0m20:53:32.036616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:32.038619 [info ] [MainThread]: 
[0m20:53:32.044631 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:53:32.045626 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:53:32.047617 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:53:32.048637 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:53:32.057625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.065654 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:53:32.049651 => 20:53:32.065654
[0m20:53:32.067619 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:53:32.108238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.114246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.115209 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:53:32.116207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:32.137950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.138931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.138931 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:53:32.142926 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.149930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.151943 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:53:32.154927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.158969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.159937 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:53:32.162945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.180961 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:53:32.181963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.182927 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:53:32.186954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.196969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:53:32.196969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:53:32.201237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.204239 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:53:32.068617 => 20:53:32.203239
[0m20:53:32.204239 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:53:32.206762 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:53:32.208769 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:53:32.209764 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:53:32.210751 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:53:32.211753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:53:32.212764 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:53:32.216754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.222751 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:53:32.212764 => 20:53:32.222751
[0m20:53:32.223751 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:53:32.228751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.235527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.236543 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:53:32.236543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.263237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.264235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.264235 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:53:32.268272 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.271272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.272262 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:53:32.274225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.277247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.278245 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:53:32.281209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.283280 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:53:32.284211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.284211 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:53:32.287383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.291443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:53:32.292440 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:53:32.295415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.297415 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:53:32.224751 => 20:53:32.297415
[0m20:53:32.298415 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:53:32.300440 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:53:32.302415 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:53:32.303437 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:53:32.304438 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:53:32.304438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:53:32.306978 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:53:32.309978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.317207 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:53:32.306978 => 20:53:32.317207
[0m20:53:32.318170 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:53:32.323170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.330210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.331139 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:53:32.331139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.353922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.354948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.354948 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:53:32.358961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.362959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.363969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:53:32.366939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.370971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.371934 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:53:32.374149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.376194 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:53:32.377163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.377163 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:53:32.381160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.385183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:53:32.386159 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:53:32.389159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.391181 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:53:32.318170 => 20:53:32.391181
[0m20:53:32.392189 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:53:32.394195 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.09s]
[0m20:53:32.396188 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:53:32.397193 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:53:32.398188 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:53:32.399189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:53:32.400190 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:53:32.404217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.414329 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:53:32.401213 => 20:53:32.414329
[0m20:53:32.415359 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:53:32.420358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.430019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.431058 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:53:32.432036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.457450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.458450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.458450 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:53:32.462484 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.467487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.468485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:53:32.471306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.474339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.475339 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:53:32.478306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.480329 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:53:32.481305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.481305 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:53:32.485306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.488325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:53:32.489332 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:53:32.492350 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.495358 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:53:32.416327 => 20:53:32.494357
[0m20:53:32.495358 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:53:32.497364 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:53:32.499375 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:53:32.500375 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:53:32.501357 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:53:32.502359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:53:32.503360 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:53:32.506860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.512910 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:53:32.504357 => 20:53:32.512910
[0m20:53:32.513921 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:53:32.518920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.525653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.526652 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:53:32.527652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.551318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.551318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.552317 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:53:32.556117 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.559162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.560166 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:53:32.562832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.565842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.566851 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:53:32.568751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.571760 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:53:32.572750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.572750 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:53:32.576777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.579775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:53:32.579775 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:53:32.583750 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.585751 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:53:32.514946 => 20:53:32.585751
[0m20:53:32.586749 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:53:32.589755 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:53:32.591774 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:53:32.591774 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:53:32.592756 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:53:32.594754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:53:32.594754 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:53:32.597792 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.605438 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:53:32.595757 => 20:53:32.604876
[0m20:53:32.606019 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:53:32.610725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.617160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.617160 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:53:32.618195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.642060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.643063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.644054 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:53:32.648042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:32.655052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.656039 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:53:32.659045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.662059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.663062 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:53:32.665925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.667973 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:53:32.668937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.668937 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:53:32.672560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.675586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:53:32.676549 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:53:32.680552 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:32.683599 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:53:32.606720 => 20:53:32.683599
[0m20:53:32.684578 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:53:32.685562 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:53:32.687552 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:53:32.688557 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:53:32.689563 [info ] [Thread-1 (]: 7 of 11 START sql table model public.fact_orders ............................... [RUN]
[0m20:53:32.690552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:53:32.691555 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:53:32.694564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:53:32.700596 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:53:32.691555 => 20:53:32.700596
[0m20:53:32.701587 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:53:32.729182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:53:32.735185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.736188 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:53:32.737148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.760150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.761184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.762156 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:53:32.771778 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:53:32.777798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.778766 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m20:53:32.780764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.785759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.786761 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:53:32.788760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.795767 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:53:32.796766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.797767 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:53:32.800767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.807974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:53:32.808939 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:53:32.813937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:32.816002 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:53:32.701587 => 20:53:32.816002
[0m20:53:32.816977 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:53:32.819945 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.13s]
[0m20:53:32.821944 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:53:32.822938 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:53:32.823941 [info ] [Thread-1 (]: 8 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m20:53:32.824951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:53:32.825974 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:53:32.829981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:53:32.835939 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:53:32.826961 => 20:53:32.834975
[0m20:53:32.836952 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:53:32.845945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:53:32.853940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.855940 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:53:32.855940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.879744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.880739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.881740 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:53:32.886740 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:53:32.889740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.890739 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:53:32.892748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.895746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.896746 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:53:32.898790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:32.901781 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:53:32.901781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.902746 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:53:32.906814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:32.909855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:53:32.909855 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:53:32.913823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:32.916832 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:53:32.836952 => 20:53:32.916832
[0m20:53:32.917849 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:53:32.919826 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.09s]
[0m20:53:32.921825 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:53:32.922836 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:53:32.923820 [info ] [Thread-1 (]: 9 of 11 START sql table model public.fact_stocks ............................... [RUN]
[0m20:53:32.924837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:53:32.925845 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:53:32.928845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:53:32.936830 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:53:32.926847 => 20:53:32.935821
[0m20:53:32.937822 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:53:32.941857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:53:32.948906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:32.949912 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:53:32.949912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:32.971907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:32.972907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:32.973902 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:53:33.047359 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:53:33.051408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:33.052411 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m20:53:33.054374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:33.058406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:33.058406 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:53:33.061371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:33.063373 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:53:33.064408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:33.065396 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:53:33.077383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:33.081372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:53:33.081372 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:53:33.089372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:33.092412 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:53:32.937822 => 20:53:33.091409
[0m20:53:33.092412 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:53:33.094421 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.17s]
[0m20:53:33.096422 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:53:33.097421 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:53:33.098419 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:53:33.100417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:53:33.101417 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:53:33.105453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.111570 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:53:33.101417 => 20:53:33.111570
[0m20:53:33.112618 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:53:33.117619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.125578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.126578 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:53:33.126578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:33.148650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:33.151652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.152645 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:53:33.157644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:33.161681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.162647 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:53:33.164649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:33.168682 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:53:33.168682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.169684 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:53:33.173650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:33.177682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:53:33.178680 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:53:33.180649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:33.182649 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:53:33.113631 => 20:53:33.182649
[0m20:53:33.183650 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:53:33.184648 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.09s]
[0m20:53:33.186685 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:53:33.187684 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:53:33.188684 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:53:33.189676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:53:33.190674 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:53:33.193706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.200719 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:53:33.191671 => 20:53:33.199678
[0m20:53:33.200719 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:53:33.205712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.212728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.212728 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:53:33.214738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:33.238220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:33.239215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.239215 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:53:33.243227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:33.247219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.247219 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:53:33.250216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:33.252219 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:53:33.252219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.253219 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:53:33.256751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:33.260756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:53:33.261757 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:53:33.264773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:33.266753 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:53:33.201718 => 20:53:33.266753
[0m20:53:33.267781 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:53:33.269760 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:53:33.271755 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:53:33.273763 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:33.274787 [debug] [MainThread]: On master: BEGIN
[0m20:53:33.275758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:33.298604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:33.299630 [debug] [MainThread]: On master: COMMIT
[0m20:53:33.299630 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:33.300595 [debug] [MainThread]: On master: COMMIT
[0m20:53:33.302603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:53:33.303616 [debug] [MainThread]: On master: Close
[0m20:53:33.304594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:33.305594 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:53:33.306597 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:53:33.307101 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:53:33.308109 [info ] [MainThread]: 
[0m20:53:33.309107 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m20:53:33.313145 [debug] [MainThread]: Command end result
[0m20:53:33.337143 [info ] [MainThread]: 
[0m20:53:33.338142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:33.339145 [info ] [MainThread]: 
[0m20:53:33.340148 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:53:33.342108 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:33.342108 after 2.85 seconds
[0m20:53:33.343111 [debug] [MainThread]: Flushing usage events


============================== 20:54:02.802369 | b04a98af-8d1f-484f-9c8c-9be15e2301c6 ==============================
[0m20:54:02.802369 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:54:02.807381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m20:54:02.931908 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:54:02.941419 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:54:02.956446 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:54:03.923631 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:54:03.926181 [info ] [MainThread]: 
[0m20:54:03.927186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:03.930608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:54:03.940611 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:54:03.940611 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:54:03.941612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:03.975180 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:54:03.976180 [debug] [ThreadPool]: On list_my_database: Close
[0m20:54:03.980179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:54:03.989038 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:54:03.990049 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:54:03.991051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:04.013934 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.014890 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:54:04.015893 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:04.022891 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:54:04.025889 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:54:04.027897 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:54:04.029900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:54:04.035930 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:54:04.035930 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:54:04.036931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:04.057610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.058604 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:54:04.059633 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:54:04.064688 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:54:04.065700 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:54:04.067699 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:54:04.074734 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:04.075740 [debug] [MainThread]: On master: BEGIN
[0m20:54:04.076734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:04.097984 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.098986 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:04.098986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:04.106006 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m20:54:04.109982 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:04.112788 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:04.113799 [debug] [MainThread]: On master: BEGIN
[0m20:54:04.116802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.116802 [debug] [MainThread]: On master: COMMIT
[0m20:54:04.117836 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:04.117836 [debug] [MainThread]: On master: COMMIT
[0m20:54:04.119799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.120799 [debug] [MainThread]: On master: Close
[0m20:54:04.121798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:04.123802 [info ] [MainThread]: 
[0m20:54:04.128786 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:54:04.129820 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:54:04.130790 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:54:04.131788 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:54:04.139789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.148315 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:54:04.131788 => 20:54:04.147330
[0m20:54:04.150316 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:54:04.193311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.200344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.200344 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:54:04.201342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:04.222289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.223313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.224315 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:54:04.227046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.234092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.235060 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:54:04.237092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.241092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.241092 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:54:04.244142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.262153 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:54:04.262153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.263153 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:54:04.267165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.278177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:04.279187 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:54:04.283153 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.284153 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:54:04.151313 => 20:54:04.284153
[0m20:54:04.285153 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:54:04.287155 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:54:04.289155 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:54:04.290155 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:04.291176 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:54:04.292153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:54:04.293155 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:04.296189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.304211 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:54:04.294152 => 20:54:04.303173
[0m20:54:04.305154 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:04.309774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.316376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.317365 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:54:04.318340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.339390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.340390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.340390 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:54:04.343947 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.347972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.347972 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:54:04.350937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.353963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.354963 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:54:04.357967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.360938 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:54:04.361938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.361938 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:54:04.366949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.369944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:04.370944 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:54:04.375875 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.377899 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:54:04.305154 => 20:54:04.377899
[0m20:54:04.378887 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:54:04.380885 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:54:04.381877 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:04.383886 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:04.384872 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:54:04.385900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:54:04.386872 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:04.388898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.395908 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:54:04.386872 => 20:54:04.395908
[0m20:54:04.396908 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:04.401909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.408889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.409872 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:54:04.409872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.431888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.432950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.432950 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:54:04.437506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.440537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.440537 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:54:04.444083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.447117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.448084 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:54:04.450082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.452118 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:54:04.453087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.454086 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:54:04.458085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.461109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:04.462083 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:54:04.466096 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.469083 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:54:04.397874 => 20:54:04.468085
[0m20:54:04.470090 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:54:04.472095 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.09s]
[0m20:54:04.474107 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:04.475099 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:04.476084 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:54:04.477087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:54:04.478087 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:04.481085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.497096 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:54:04.478087 => 20:54:04.496089
[0m20:54:04.498094 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:04.505479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.518413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.519392 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:54:04.520376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.540471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.542010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.543020 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:54:04.547048 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.552019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.553017 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:54:04.555017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.558042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.559043 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:54:04.561043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.564021 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:54:04.565020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.566034 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:54:04.569076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.572071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:04.573085 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:54:04.577075 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.579071 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:54:04.499927 => 20:54:04.579071
[0m20:54:04.580072 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:54:04.582073 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:54:04.584071 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:04.585074 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:54:04.587072 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:54:04.588071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:54:04.588071 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:54:04.591071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.598093 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:54:04.589071 => 20:54:04.598093
[0m20:54:04.599091 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:54:04.605093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.613068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.614067 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:54:04.614067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.639081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.640063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.641064 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:54:04.645086 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.648106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.649612 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:54:04.651620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.657622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.660621 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:54:04.664616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.667652 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:54:04.667652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.668652 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:54:04.672624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.675653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:04.676644 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:54:04.679929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.681909 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:54:04.600113 => 20:54:04.681909
[0m20:54:04.682891 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:54:04.684890 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:54:04.687902 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:54:04.688892 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:04.690925 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:54:04.691890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:54:04.692894 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:04.696892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.703896 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:54:04.693892 => 20:54:04.702894
[0m20:54:04.704895 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:04.709926 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.716297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.717298 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:54:04.718275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.741336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.742335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.742877 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:54:04.747597 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:04.750608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.751608 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:54:04.754608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.757644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.757644 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:54:04.760610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.763609 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:54:04.763609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.764607 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:54:04.767615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.771649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:04.772647 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:54:04.776620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:04.778622 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:54:04.705894 => 20:54:04.778622
[0m20:54:04.779650 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:54:04.781642 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:54:04.784621 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:04.785642 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:54:04.786624 [info ] [Thread-1 (]: 7 of 11 START sql table model public.fact_orders ............................... [RUN]
[0m20:54:04.787621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:54:04.788650 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:54:04.791646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:54:04.797637 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:54:04.788650 => 20:54:04.797637
[0m20:54:04.798647 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:54:04.824665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:54:04.830677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.831706 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:54:04.832701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.854222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.855233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.855233 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:54:04.861236 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:54:04.865232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.865232 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m20:54:04.868233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.871232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.872233 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:54:04.874402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.880002 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:54:04.880002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.881003 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:54:04.886224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.891221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:04.892245 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:54:04.896252 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:04.899225 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:54:04.800652 => 20:54:04.898224
[0m20:54:04.899225 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:54:04.901224 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.11s]
[0m20:54:04.903224 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:54:04.904248 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:54:04.905224 [info ] [Thread-1 (]: 8 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m20:54:04.906221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:54:04.907222 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:54:04.910219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:54:04.916494 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:54:04.908222 => 20:54:04.915532
[0m20:54:04.916494 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:54:04.922516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:54:04.928556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.929555 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:54:04.930553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:04.954373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:04.954373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.955374 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:54:04.959425 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:54:04.963372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.964371 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:54:04.966375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.970373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.970373 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:54:04.972372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:04.975373 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:54:04.976373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.976373 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:54:04.979937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:04.983969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:04.984936 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:54:04.989302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:04.991325 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:54:04.917527 => 20:54:04.990289
[0m20:54:04.991325 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:54:04.994292 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.09s]
[0m20:54:04.996287 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:54:04.997288 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:54:04.998295 [info ] [Thread-1 (]: 9 of 11 START sql table model public.fact_stocks ............................... [RUN]
[0m20:54:04.999287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:54:05.000298 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:54:05.004325 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.010484 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:54:05.001293 => 20:54:05.009483
[0m20:54:05.010484 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:54:05.017517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.024485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.025484 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:54:05.025484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:05.049766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:05.050774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.050774 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:54:05.120947 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:54:05.126561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.126561 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m20:54:05.129611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:05.132622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.133622 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:54:05.135623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:05.138623 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:54:05.139621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.139621 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:54:05.151625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:05.156625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:05.157649 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:54:05.164627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:05.166624 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:54:05.011481 => 20:54:05.166624
[0m20:54:05.168632 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:54:05.171630 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.17s]
[0m20:54:05.174654 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:54:05.176632 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:54:05.177626 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:54:05.180195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:54:05.181189 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:54:05.187233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.193973 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:54:05.182215 => 20:54:05.193973
[0m20:54:05.194968 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:54:05.199556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.206571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.207564 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:54:05.208529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:05.231460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:05.232441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.233438 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:54:05.237443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:05.240477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.241440 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:54:05.243518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:05.245518 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:54:05.246528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.247518 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:54:05.252141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:05.255176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:05.256155 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:54:05.258142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:05.260143 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:54:05.194968 => 20:54:05.259141
[0m20:54:05.260143 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:54:05.263143 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:54:05.264142 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:54:05.266142 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:54:05.266142 [info ] [Thread-1 (]: 11 of 11 START sql table model public.stock_update_status ...................... [RUN]
[0m20:54:05.268175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:54:05.268175 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:54:05.271176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.278488 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:54:05.269176 => 20:54:05.277459
[0m20:54:05.279480 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:54:05.284457 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.290231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.291194 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:54:05.292193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:05.317073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:05.317073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.318109 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  
    

  create  table "my_database"."public"."stock_update_status__dbt_tmp"
  
  
    as
  
  (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
  
[0m20:54:05.480320 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:54:05.483329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.484331 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:54:05.486799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:05.488842 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:54:05.489806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.489806 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:54:05.527439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:05.532504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:05.533479 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop table if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:54:05.536448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:05.538451 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:54:05.280460 => 20:54:05.538451
[0m20:54:05.539450 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:54:05.541453 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public.stock_update_status ................. [[32mSELECT 28036[0m in 0.27s]
[0m20:54:05.545974 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:54:05.548983 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:05.550394 [debug] [MainThread]: On master: BEGIN
[0m20:54:05.550982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:05.579117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:05.580106 [debug] [MainThread]: On master: COMMIT
[0m20:54:05.580106 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:05.581131 [debug] [MainThread]: On master: COMMIT
[0m20:54:05.583106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:05.584129 [debug] [MainThread]: On master: Close
[0m20:54:05.585107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:05.587107 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:54:05.587107 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:54:05.588128 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:54:05.589106 [info ] [MainThread]: 
[0m20:54:05.591106 [info ] [MainThread]: Finished running 7 view models, 4 table models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m20:54:05.594132 [debug] [MainThread]: Command end result
[0m20:54:05.618954 [info ] [MainThread]: 
[0m20:54:05.619920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:05.620918 [info ] [MainThread]: 
[0m20:54:05.622922 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:54:05.623919 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:05.623919 after 2.86 seconds
[0m20:54:05.624941 [debug] [MainThread]: Flushing usage events


============================== 20:54:44.008296 | 35bad32f-4bb9-4cb3-a397-18bc640adee3 ==============================
[0m20:54:44.008296 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:54:44.015297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:54:44.209643 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:54:44.230689 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:54:44.265473 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:54:46.031511 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:54:46.033545 [info ] [MainThread]: 
[0m20:54:46.035549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:46.038510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:54:46.055514 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:54:46.056513 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:54:46.056513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:46.099140 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:54:46.101127 [debug] [ThreadPool]: On list_my_database: Close
[0m20:54:46.106662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:54:46.116814 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:54:46.117813 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:54:46.118815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:46.149991 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.150986 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:54:46.151507 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:46.156581 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:54:46.158550 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:54:46.160513 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:54:46.163225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:54:46.169208 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:54:46.170209 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:54:46.171224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:46.195286 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.196286 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:54:46.196286 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:54:46.201284 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:54:46.203285 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:54:46.205284 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:54:46.212371 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:46.213372 [debug] [MainThread]: On master: BEGIN
[0m20:54:46.213372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:46.236867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.237848 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:46.237848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:46.245882 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m20:54:46.248883 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:46.251408 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:46.252450 [debug] [MainThread]: On master: BEGIN
[0m20:54:46.256429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.257398 [debug] [MainThread]: On master: COMMIT
[0m20:54:46.257398 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:46.258433 [debug] [MainThread]: On master: COMMIT
[0m20:54:46.260400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.261396 [debug] [MainThread]: On master: Close
[0m20:54:46.262406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:46.264399 [info ] [MainThread]: 
[0m20:54:46.269574 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:54:46.270573 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_eltool__company ........................ [RUN]
[0m20:54:46.272581 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:54:46.273572 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:54:46.281616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.288654 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:54:46.274611 => 20:54:46.288654
[0m20:54:46.289859 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:54:46.326628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.333719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.334684 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:54:46.334684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:46.358234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.359236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.359236 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  create view "my_database"."public"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m20:54:46.363270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.369853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.370850 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:54:46.372853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.376895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.377861 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:54:46.380868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.398063 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:54:46.399031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.399031 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:54:46.403509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.413542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:54:46.414518 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:54:46.418106 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.421111 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:54:46.289859 => 20:54:46.421111
[0m20:54:46.422121 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:54:46.424120 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_eltool__company ................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:54:46.426864 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:54:46.427898 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:46.427898 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_eltool__customers ...................... [RUN]
[0m20:54:46.430417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:54:46.431416 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:46.435414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.442278 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:54:46.432421 => 20:54:46.441334
[0m20:54:46.445278 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:46.449865 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.457830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.458924 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:54:46.459831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:46.483448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.484448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.485436 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  create view "my_database"."public"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m20:54:46.488449 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.492211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.493232 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:54:46.495252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.500244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.500244 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:54:46.504233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.506216 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:54:46.507217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.508233 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:54:46.511767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.515815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:54:46.516791 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:54:46.521776 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.524775 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:54:46.446281 => 20:54:46.523784
[0m20:54:46.524775 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:54:46.526781 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_eltool__customers ................. [[32mCREATE VIEW[0m in 0.10s]
[0m20:54:46.528779 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:54:46.530774 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:46.531776 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_eltool__customers_snapshots ............ [RUN]
[0m20:54:46.533311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:54:46.534327 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:46.539313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.547312 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:54:46.536318 => 20:54:46.546344
[0m20:54:46.548313 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:46.554859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.560829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.562158 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:54:46.562872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:46.587374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.588373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.589404 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  create view "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m20:54:46.592952 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.597931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.598919 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:54:46.601953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.604952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.605953 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:54:46.607920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.610957 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:54:46.612480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.613489 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:54:46.617493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.622500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:54:46.624489 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:54:46.629492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.632595 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:54:46.548313 => 20:54:46.631590
[0m20:54:46.633593 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:54:46.635593 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_eltool__customers_snapshots ....... [[32mCREATE VIEW[0m in 0.10s]
[0m20:54:46.637595 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:54:46.639593 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:46.641591 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_eltool__orders ......................... [RUN]
[0m20:54:46.643591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:54:46.644590 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:46.647591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.660172 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:54:46.644590 => 20:54:46.660172
[0m20:54:46.661193 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:46.669382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.684193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.685154 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:54:46.686150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:46.709833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.710859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.711830 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  create view "my_database"."public"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m20:54:46.714844 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.719876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.720851 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:54:46.723855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.726885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.727851 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:54:46.729452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.731497 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:54:46.732484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.733498 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:54:46.736545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.740590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:54:46.740590 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:54:46.744555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.746584 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:54:46.663175 => 20:54:46.746584
[0m20:54:46.747556 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:54:46.749555 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_eltool__orders .................... [[32mCREATE VIEW[0m in 0.11s]
[0m20:54:46.751557 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:54:46.753557 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:54:46.754557 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_eltool__state .......................... [RUN]
[0m20:54:46.755590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:54:46.756581 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:54:46.759580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.765966 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:54:46.757556 => 20:54:46.764988
[0m20:54:46.766973 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:54:46.772978 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.778952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.779973 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:54:46.779973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:46.802510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.803528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.804515 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  create view "my_database"."public"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m20:54:46.807485 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.811520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.812482 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:54:46.814518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.818520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.818520 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:54:46.820919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.823961 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:54:46.823961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.824966 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:54:46.827931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.831957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:54:46.832963 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:54:46.835932 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.838932 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:54:46.767944 => 20:54:46.837956
[0m20:54:46.838932 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:54:46.840943 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_eltool__state ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:54:46.842944 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:54:46.843948 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:46.844931 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_eltool__stock .......................... [RUN]
[0m20:54:46.846937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:54:46.847960 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:46.850956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.857963 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:54:46.848940 => 20:54:46.857963
[0m20:54:46.858933 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:46.866950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.873939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.874938 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:54:46.875946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:46.901794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:46.902815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.903796 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  create view "my_database"."public"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m20:54:46.907796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:46.911796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.912831 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:54:46.915790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.919795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.919795 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:54:46.922808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:46.925828 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:54:46.926371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.927379 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:54:46.931380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:46.937413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:54:46.938383 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:54:46.942391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:46.945378 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:54:46.859971 => 20:54:46.945378
[0m20:54:46.946376 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:54:46.948382 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_eltool__stock ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:54:46.950922 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:54:46.951919 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:54:46.952953 [info ] [Thread-1 (]: 7 of 11 START sql table model public.fact_orders ............................... [RUN]
[0m20:54:46.954917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:54:46.956917 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:54:46.962954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:54:46.971545 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:54:46.957967 => 20:54:46.970543
[0m20:54:46.972509 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:54:46.998674 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:54:47.005652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.006639 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:54:47.007642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:47.036301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.038292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.039289 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:54:47.045853 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:54:47.050849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.051946 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m20:54:47.053980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.057979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.058966 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:54:47.061945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.067980 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:54:47.068948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.069944 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:54:47.074966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.082979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:54:47.083954 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:54:47.088954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:47.090964 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:54:46.972509 => 20:54:47.090964
[0m20:54:47.090964 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:54:47.093491 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.14s]
[0m20:54:47.095487 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:54:47.096482 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:54:47.097519 [info ] [Thread-1 (]: 8 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m20:54:47.099487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:54:47.099487 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:54:47.103518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:54:47.109518 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:54:47.100521 => 20:54:47.108517
[0m20:54:47.109518 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:54:47.116516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:54:47.122483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.123488 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:54:47.124491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:47.147448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.147448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.148473 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:54:47.153169 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:54:47.157206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.158217 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:54:47.160179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.163218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.164215 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:54:47.166180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.169214 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:54:47.169214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.170217 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:54:47.174223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.179253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:54:47.180253 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:54:47.184207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:47.186242 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:54:47.110517 => 20:54:47.185207
[0m20:54:47.186242 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:54:47.189228 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.09s]
[0m20:54:47.191216 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:54:47.191216 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:54:47.192758 [info ] [Thread-1 (]: 9 of 11 START sql table model public.fact_stocks ............................... [RUN]
[0m20:54:47.194806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:54:47.194806 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:54:47.197801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.204968 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:54:47.195800 => 20:54:47.203984
[0m20:54:47.205955 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:54:47.210953 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.217894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.218889 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:54:47.219896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:47.242241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.243257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.243257 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:54:47.313394 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:54:47.318464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.319409 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m20:54:47.321399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.324997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.324997 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:54:47.327520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.330569 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:54:47.330569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.331565 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:54:47.343558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.348216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:54:47.349217 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:54:47.356791 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:47.359818 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:54:47.205955 => 20:54:47.359818
[0m20:54:47.360790 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:54:47.362938 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.17s]
[0m20:54:47.364464 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:54:47.365486 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:54:47.366468 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:54:47.368464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:54:47.368464 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:54:47.372459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.378665 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:54:47.369461 => 20:54:47.378665
[0m20:54:47.379505 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:54:47.384491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.390830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.391836 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:54:47.392798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:47.416120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.417123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.417123 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:54:47.421052 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:47.425087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.426060 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:54:47.428061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.430089 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:54:47.430089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.431087 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:54:47.435062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.438086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:54:47.439062 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:54:47.441077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:47.443088 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:54:47.380502 => 20:54:47.443088
[0m20:54:47.444063 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:54:47.446076 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.08s]
[0m20:54:47.447079 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:54:47.448067 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:54:47.449062 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:54:47.450063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:54:47.451063 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:54:47.456089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.462487 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:54:47.452061 => 20:54:47.462487
[0m20:54:47.463518 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:54:47.468523 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.474747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.475721 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:54:47.476714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:47.499974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.500974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.502022 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:54:47.505539 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:47.509573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.510560 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status" rename to "stock_update_status__dbt_backup"
[0m20:54:47.512550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.515574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.516541 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:54:47.519539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:47.521582 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:54:47.522540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.522540 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:54:47.525827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.529838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:54:47.530838 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop table if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:54:47.535325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:47.537360 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:54:47.464490 => 20:54:47.537360
[0m20:54:47.538324 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:54:47.541327 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:54:47.542325 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:54:47.545322 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:47.546323 [debug] [MainThread]: On master: BEGIN
[0m20:54:47.546323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:47.570215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:47.571231 [debug] [MainThread]: On master: COMMIT
[0m20:54:47.572252 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:47.573202 [debug] [MainThread]: On master: COMMIT
[0m20:54:47.575194 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:47.576195 [debug] [MainThread]: On master: Close
[0m20:54:47.577195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:47.578207 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:54:47.579204 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:54:47.581227 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:54:47.583203 [info ] [MainThread]: 
[0m20:54:47.584224 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m20:54:47.587229 [debug] [MainThread]: Command end result
[0m20:54:47.614721 [info ] [MainThread]: 
[0m20:54:47.615718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:47.616720 [info ] [MainThread]: 
[0m20:54:47.617719 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:54:47.618742 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:47.618742 after 3.66 seconds
[0m20:54:47.618742 [debug] [MainThread]: Flushing usage events


============================== 20:55:34.079841 | e258408a-ba1c-427b-960d-0605f555c761 ==============================
[0m20:55:34.079841 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:55:34.085849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m20:55:34.260533 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:55:34.279010 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:55:34.297599 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:55:35.703751 [info ] [MainThread]: Found 11 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:55:35.707777 [info ] [MainThread]: 
[0m20:55:35.708753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:35.712168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:55:35.724157 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:55:35.725158 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:55:35.726168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:35.761712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:55:35.763675 [debug] [ThreadPool]: On list_my_database: Close
[0m20:55:35.767697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:55:35.774714 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:55:35.775721 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:55:35.776678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:35.798481 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:35.799477 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:55:35.800477 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:55:35.805477 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:55:35.806477 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:55:35.809145 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:55:35.811148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:55:35.818190 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:55:35.818190 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:55:35.819176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:35.842128 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:35.843147 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:55:35.844171 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:55:35.849691 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:55:35.851723 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:55:35.854686 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:55:35.861689 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:35.862689 [debug] [MainThread]: On master: BEGIN
[0m20:55:35.863692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:35.885084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:35.886109 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:35.886109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:35.894081 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m20:55:35.897643 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:35.899616 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:35.900646 [debug] [MainThread]: On master: BEGIN
[0m20:55:35.903709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:35.904751 [debug] [MainThread]: On master: COMMIT
[0m20:55:35.905708 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:35.905708 [debug] [MainThread]: On master: COMMIT
[0m20:55:35.907710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:35.908730 [debug] [MainThread]: On master: Close
[0m20:55:35.909705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:35.911706 [info ] [MainThread]: 
[0m20:55:35.917705 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:55:35.918721 [info ] [Thread-1 (]: 1 of 11 START sql table model public.stg_eltool__company ....................... [RUN]
[0m20:55:35.920724 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:55:35.920724 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:55:35.928705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:35.936877 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:55:35.921734 => 20:55:35.936877
[0m20:55:35.937876 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:55:35.979033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:35.984990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:35.986025 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:55:35.986995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:36.017636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.018642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:36.019632 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m20:55:36.026631 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m20:55:36.033690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:36.034688 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:55:36.037653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.040690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:36.040690 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:55:36.043654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.063272 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:55:36.064274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:36.065277 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:55:36.068272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.077306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:55:36.077306 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop view if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:55:36.081288 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.083290 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:55:35.938874 => 20:55:36.083290
[0m20:55:36.084295 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:55:36.086277 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.stg_eltool__company .................. [[32mSELECT 82[0m in 0.17s]
[0m20:55:36.088272 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:55:36.089274 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers
[0m20:55:36.090284 [info ] [Thread-1 (]: 2 of 11 START sql table model public.stg_eltool__customers ..................... [RUN]
[0m20:55:36.091309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers)
[0m20:55:36.092277 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers
[0m20:55:36.096275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.103307 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (compile): 20:55:36.093277 => 20:55:36.102305
[0m20:55:36.103307 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers
[0m20:55:36.108305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.114065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.115067 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: BEGIN
[0m20:55:36.116039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.139048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.140065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.141043 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
  
[0m20:55:36.146175 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:36.150737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.150737 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:55:36.153732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.156740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.157714 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
alter table "my_database"."public"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:55:36.159713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.161737 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:55:36.162748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.163713 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: COMMIT
[0m20:55:36.166735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.170728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers"
[0m20:55:36.171716 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers"} */
drop view if exists "my_database"."public"."stg_eltool__customers__dbt_backup" cascade
[0m20:55:36.177713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.179743 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers (execute): 20:55:36.104308 => 20:55:36.178746
[0m20:55:36.179743 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers: Close
[0m20:55:36.182714 [info ] [Thread-1 (]: 2 of 11 OK created sql table model public.stg_eltool__customers ................ [[32mSELECT 0[0m in 0.09s]
[0m20:55:36.184718 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers
[0m20:55:36.185720 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:55:36.187741 [info ] [Thread-1 (]: 3 of 11 START sql table model public.stg_eltool__customers_snapshots ........... [RUN]
[0m20:55:36.189780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:55:36.190719 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:55:36.197749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.204713 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:55:36.191750 => 20:55:36.203749
[0m20:55:36.204713 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:55:36.209747 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.215715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.216715 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:55:36.216715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.239769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.240805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.241793 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m20:55:36.248598 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:55:36.253970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.253970 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:55:36.256967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.260004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.260967 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:55:36.262967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.265004 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:55:36.266003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.266987 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:55:36.270706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.273742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:55:36.273742 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop view if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:55:36.278710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.280711 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:55:36.205747 => 20:55:36.280711
[0m20:55:36.281712 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:55:36.283733 [info ] [Thread-1 (]: 3 of 11 OK created sql table model public.stg_eltool__customers_snapshots ...... [[32mSELECT 100[0m in 0.09s]
[0m20:55:36.284708 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:55:36.285711 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:55:36.286708 [info ] [Thread-1 (]: 4 of 11 START sql table model public.stg_eltool__orders ........................ [RUN]
[0m20:55:36.288708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:55:36.288708 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:55:36.291743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.301732 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:55:36.289708 => 20:55:36.301732
[0m20:55:36.302730 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:55:36.308731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.320715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.321696 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:55:36.321696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.344822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.345825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.346822 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m20:55:36.353402 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:55:36.357385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.358383 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:55:36.360437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.364472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.364472 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:55:36.367458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.369474 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:55:36.370471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.371479 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:55:36.375441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.379438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:55:36.380439 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop view if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:55:36.384942 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.387918 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:55:36.303700 => 20:55:36.387918
[0m20:55:36.388916 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:55:36.391904 [info ] [Thread-1 (]: 4 of 11 OK created sql table model public.stg_eltool__orders ................... [[32mSELECT 999[0m in 0.10s]
[0m20:55:36.392902 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:55:36.394915 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:55:36.395900 [info ] [Thread-1 (]: 5 of 11 START sql table model public.stg_eltool__state ......................... [RUN]
[0m20:55:36.397900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:55:36.398921 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:55:36.402901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.409905 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:55:36.399904 => 20:55:36.409905
[0m20:55:36.410907 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:55:36.419899 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.426901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.427920 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:55:36.428905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.455943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.456980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.457944 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m20:55:36.462962 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m20:55:36.469952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.471950 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:55:36.474948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.479942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.480987 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:55:36.483966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.487949 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:55:36.488968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.488968 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:55:36.493950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.497977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:55:36.498948 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop view if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:55:36.503949 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.505958 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:55:36.411907 => 20:55:36.505958
[0m20:55:36.507961 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:55:36.509955 [info ] [Thread-1 (]: 5 of 11 OK created sql table model public.stg_eltool__state .................... [[32mSELECT 27[0m in 0.11s]
[0m20:55:36.511969 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:55:36.513949 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:55:36.514966 [info ] [Thread-1 (]: 6 of 11 START sql table model public.stg_eltool__stock ......................... [RUN]
[0m20:55:36.516948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:55:36.517954 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:55:36.522949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.532030 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:55:36.518953 => 20:55:36.531524
[0m20:55:36.533120 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:55:36.542040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.551104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.552104 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:55:36.553990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.584549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.585566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.586551 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m20:55:36.665695 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m20:55:36.671689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.672700 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:55:36.675692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.681693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.682695 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:55:36.685695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.691692 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:55:36.692710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.693696 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:55:36.706348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.713340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:55:36.714344 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop view if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:55:36.719341 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:36.722342 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:55:36.534504 => 20:55:36.721341
[0m20:55:36.723344 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:55:36.725341 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public.stg_eltool__stock .................... [[32mSELECT 28003[0m in 0.21s]
[0m20:55:36.728354 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:55:36.730356 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:55:36.731338 [info ] [Thread-1 (]: 7 of 11 START sql table model public.fact_orders ............................... [RUN]
[0m20:55:36.733344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:55:36.734874 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:55:36.738906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:55:36.746917 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:55:36.735894 => 20:55:36.746917
[0m20:55:36.747918 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:55:36.756440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:55:36.764510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.766437 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:55:36.767440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.796453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.797440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.799440 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:55:36.804441 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:55:36.809437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.810440 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m20:55:36.813441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.818438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.819438 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:55:36.822440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.825439 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:55:36.826438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.827440 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:55:36.831437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.839494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:55:36.840472 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:55:36.846474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:36.849474 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:55:36.749430 => 20:55:36.849474
[0m20:55:36.850581 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:55:36.852566 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.12s]
[0m20:55:36.855571 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:55:36.856567 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:55:36.857567 [info ] [Thread-1 (]: 8 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m20:55:36.859565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:55:36.860591 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:55:36.865565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:55:36.872599 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:55:36.861590 => 20:55:36.872599
[0m20:55:36.873566 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:55:36.880638 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:55:36.888567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.889564 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:55:36.890567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:36.917563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:36.918579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.919566 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:55:36.925567 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:55:36.929565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.931565 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:55:36.934565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.938572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.939572 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:55:36.942586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:36.945572 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:55:36.946590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.947572 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:55:36.952680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:36.958687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:55:36.959683 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:55:36.965679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:36.968685 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:55:36.874599 => 20:55:36.968685
[0m20:55:36.970681 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:55:36.972680 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.11s]
[0m20:55:36.975794 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:55:36.976795 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:55:36.978789 [info ] [Thread-1 (]: 9 of 11 START sql table model public.fact_stocks ............................... [RUN]
[0m20:55:36.981805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:55:36.982791 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:55:36.986791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:55:36.995797 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:55:36.983803 => 20:55:36.994792
[0m20:55:36.996824 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:55:37.005825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.013796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.015796 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:55:37.016808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:37.048525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:37.049514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.051626 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:55:37.099724 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:55:37.108292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.109294 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m20:55:37.112274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:37.116268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.118288 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:55:37.121271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:37.124290 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:55:37.125273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.126298 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:55:37.168467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:37.174444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:55:37.175442 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:55:37.181329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:37.184330 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:55:36.997793 => 20:55:37.183331
[0m20:55:37.185329 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:55:37.187406 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.21s]
[0m20:55:37.190403 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:55:37.192419 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:55:37.194406 [info ] [Thread-1 (]: 10 of 11 START sql view model public.customer_orders_status .................... [RUN]
[0m20:55:37.196406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:55:37.198931 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:55:37.206225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.215242 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:55:37.199925 => 20:55:37.215242
[0m20:55:37.217233 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:55:37.250783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.258770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.259759 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:55:37.260758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:37.288769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:37.289756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.290759 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:55:37.295769 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:55:37.300758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.301772 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:55:37.304759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:37.306758 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:55:37.307758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.308758 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:55:37.312760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:37.317758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:55:37.318758 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:55:37.320758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:37.323766 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:55:37.218245 => 20:55:37.323766
[0m20:55:37.324761 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:55:37.326765 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.customer_orders_status ............... [[32mCREATE VIEW[0m in 0.13s]
[0m20:55:37.328783 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:55:37.330758 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:55:37.331773 [info ] [Thread-1 (]: 11 of 11 START sql view model public.stock_update_status ....................... [RUN]
[0m20:55:37.333757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:55:37.334771 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:55:37.339373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.346372 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:55:37.335765 => 20:55:37.346372
[0m20:55:37.347402 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:55:37.354923 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.361894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.362913 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:55:37.363897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:37.393894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:37.394892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.395893 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:55:37.400890 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:55:37.405905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.406890 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:55:37.409896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:37.412924 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:55:37.413924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.414923 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:55:37.418889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:37.423916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:55:37.424896 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:55:37.427919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:37.429921 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:55:37.349371 => 20:55:37.429921
[0m20:55:37.430929 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:55:37.432897 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.10s]
[0m20:55:37.434912 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:55:37.437905 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:37.438906 [debug] [MainThread]: On master: BEGIN
[0m20:55:37.439903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:37.466463 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:37.467443 [debug] [MainThread]: On master: COMMIT
[0m20:55:37.468454 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:37.469438 [debug] [MainThread]: On master: COMMIT
[0m20:55:37.471453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:37.472436 [debug] [MainThread]: On master: Close
[0m20:55:37.474439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:37.475442 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:55:37.476447 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:55:37.477438 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:55:37.478436 [info ] [MainThread]: 
[0m20:55:37.479443 [info ] [MainThread]: Finished running 9 table models, 2 view models in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m20:55:37.485437 [debug] [MainThread]: Command end result
[0m20:55:37.525440 [info ] [MainThread]: 
[0m20:55:37.526454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:37.527447 [info ] [MainThread]: 
[0m20:55:37.528438 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:55:37.530442 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:37.529437 after 3.51 seconds
[0m20:55:37.530442 [debug] [MainThread]: Flushing usage events


============================== 20:56:47.985392 | 5501f42c-b2ff-429e-aba3-66c43d7dc39b ==============================
[0m20:56:47.985392 [info ] [MainThread]: Running with dbt=1.6.1
[0m20:56:47.992406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m20:56:48.138050 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m20:56:48.159060 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m20:56:48.340019 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m20:56:48.342083 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_project://models\staging\stg_eltool.yml
[0m20:56:48.343012 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres_project://models\staging\stg_eltool__customers.sql
[0m20:56:48.428176 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:56:48.431727 [info ] [MainThread]: 
[0m20:56:48.433713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:48.436715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m20:56:48.449744 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m20:56:48.450734 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m20:56:48.451726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:48.497500 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:56:48.499501 [debug] [ThreadPool]: On list_my_database: Close
[0m20:56:48.505373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_public'
[0m20:56:48.515898 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:56:48.516902 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m20:56:48.517912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:48.548900 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.550903 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m20:56:48.551896 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:48.557927 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:56:48.560652 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m20:56:48.562920 [debug] [ThreadPool]: On list_my_database_public: Close
[0m20:56:48.564912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m20:56:48.574440 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:56:48.574440 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m20:56:48.575437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:48.605304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.606418 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m20:56:48.606975 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:56:48.614552 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:56:48.617339 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m20:56:48.620081 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m20:56:48.634018 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:48.635203 [debug] [MainThread]: On master: BEGIN
[0m20:56:48.636921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:48.667582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.668593 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:48.670012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:48.680484 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m20:56:48.683493 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:48.686500 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:48.688012 [debug] [MainThread]: On master: BEGIN
[0m20:56:48.692018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.693026 [debug] [MainThread]: On master: COMMIT
[0m20:56:48.694026 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:48.695047 [debug] [MainThread]: On master: COMMIT
[0m20:56:48.698039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:56:48.699026 [debug] [MainThread]: On master: Close
[0m20:56:48.701023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:48.703026 [info ] [MainThread]: 
[0m20:56:48.709586 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m20:56:48.710564 [info ] [Thread-1 (]: 1 of 10 START sql table model public.stg_eltool__company ....................... [RUN]
[0m20:56:48.713588 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m20:56:48.715589 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m20:56:48.730455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.740449 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 20:56:48.716593 => 20:56:48.739509
[0m20:56:48.741465 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m20:56:48.790451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.796744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.796744 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m20:56:48.797768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:48.823767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.823767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.824768 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m20:56:48.832318 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m20:56:48.839301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.840305 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m20:56:48.842472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:48.846485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.847485 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m20:56:48.849485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:48.871483 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:56:48.872511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.873502 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m20:56:48.876489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:48.886485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m20:56:48.887483 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m20:56:48.892158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:48.896154 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 20:56:48.742460 => 20:56:48.896154
[0m20:56:48.898170 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m20:56:48.901153 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.stg_eltool__company .................. [[32mSELECT 82[0m in 0.19s]
[0m20:56:48.905153 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m20:56:48.906162 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:56:48.908170 [info ] [Thread-1 (]: 2 of 10 START sql table model public.stg_eltool__customers_snapshots ........... [RUN]
[0m20:56:48.911174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m20:56:48.912169 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:56:48.920182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.930289 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 20:56:48.913171 => 20:56:48.929292
[0m20:56:48.931293 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:56:48.937293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.945285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.947286 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m20:56:48.948314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:48.975100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:48.976124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.977101 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m20:56:48.986318 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:56:48.990318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.990318 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m20:56:48.993270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:48.996324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:48.997283 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m20:56:48.999389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.002399 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:56:49.002399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:49.003399 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m20:56:49.007376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.011399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m20:56:49.012379 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m20:56:49.016401 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.018412 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 20:56:48.932290 => 20:56:49.018412
[0m20:56:49.019409 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m20:56:49.021402 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public.stg_eltool__customers_snapshots ...... [[32mSELECT 100[0m in 0.11s]
[0m20:56:49.023390 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m20:56:49.024396 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m20:56:49.025388 [info ] [Thread-1 (]: 3 of 10 START sql table model public.stg_eltool__orders ........................ [RUN]
[0m20:56:49.026384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m20:56:49.027413 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m20:56:49.029949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.040825 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 20:56:49.028386 => 20:56:49.040825
[0m20:56:49.041830 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m20:56:49.045860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.057810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.058822 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m20:56:49.059828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.083825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.084822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.085820 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m20:56:49.091853 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:56:49.094888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.095886 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:56:49.098065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.101075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.102113 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:56:49.105074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.107075 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:56:49.108101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.109075 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m20:56:49.114099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.118117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m20:56:49.118117 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m20:56:49.123105 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.126078 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 20:56:49.041830 => 20:56:49.126078
[0m20:56:49.127081 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m20:56:49.129605 [info ] [Thread-1 (]: 3 of 10 OK created sql table model public.stg_eltool__orders ................... [[32mSELECT 999[0m in 0.10s]
[0m20:56:49.131607 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m20:56:49.132605 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m20:56:49.133606 [info ] [Thread-1 (]: 4 of 10 START sql table model public.stg_eltool__state ......................... [RUN]
[0m20:56:49.134606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m20:56:49.135606 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m20:56:49.138606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.147607 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 20:56:49.136605 => 20:56:49.146671
[0m20:56:49.148606 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m20:56:49.156642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.163228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.164230 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m20:56:49.164230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.188571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.189577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.190568 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m20:56:49.193604 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m20:56:49.198595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.198595 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:56:49.202567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.205569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.206570 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:56:49.209398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.211408 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:56:49.213411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.214418 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m20:56:49.218423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.222419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m20:56:49.223422 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m20:56:49.227420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.230623 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 20:56:49.149611 => 20:56:49.229639
[0m20:56:49.231621 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m20:56:49.234638 [info ] [Thread-1 (]: 4 of 10 OK created sql table model public.stg_eltool__state .................... [[32mSELECT 27[0m in 0.10s]
[0m20:56:49.236621 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m20:56:49.237623 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m20:56:49.239619 [info ] [Thread-1 (]: 5 of 10 START sql table model public.stg_eltool__stock ......................... [RUN]
[0m20:56:49.240620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m20:56:49.240620 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m20:56:49.244657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.251620 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 20:56:49.241658 => 20:56:49.251620
[0m20:56:49.252658 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m20:56:49.257661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.266201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.267507 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m20:56:49.267507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.291932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.292954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.293936 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m20:56:49.361761 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m20:56:49.364793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.365799 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m20:56:49.368796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.371380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.372381 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m20:56:49.375401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.377436 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:56:49.378438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.379424 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m20:56:49.389151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.393183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m20:56:49.394150 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m20:56:49.400148 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.402155 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 20:56:49.252658 => 20:56:49.402155
[0m20:56:49.403165 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m20:56:49.405152 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.stg_eltool__stock .................... [[32mSELECT 28003[0m in 0.17s]
[0m20:56:49.407275 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m20:56:49.408184 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m20:56:49.409155 [info ] [Thread-1 (]: 6 of 10 START sql table model public.fact_orders ............................... [RUN]
[0m20:56:49.411151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m20:56:49.412185 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m20:56:49.415149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m20:56:49.424708 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 20:56:49.413182 => 20:56:49.423708
[0m20:56:49.425708 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m20:56:49.430218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m20:56:49.437253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.438256 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m20:56:49.439253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.463224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.463224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.464226 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m20:56:49.468223 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m20:56:49.472251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.473222 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m20:56:49.474759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.478771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.479771 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:56:49.481773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.485783 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:56:49.486789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.487771 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m20:56:49.491777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.496770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m20:56:49.497771 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m20:56:49.502773 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.505772 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 20:56:49.425708 => 20:56:49.504772
[0m20:56:49.505772 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m20:56:49.508776 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.fact_orders .......................... [[32mSELECT 999[0m in 0.10s]
[0m20:56:49.511772 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m20:56:49.512776 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m20:56:49.513801 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m20:56:49.514827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m20:56:49.515877 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m20:56:49.519887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m20:56:49.525850 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 20:56:49.516851 => 20:56:49.525850
[0m20:56:49.526854 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m20:56:49.535385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m20:56:49.544382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.546384 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m20:56:49.547382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.570925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.571920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.572921 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m20:56:49.576952 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m20:56:49.580920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.581920 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:56:49.584920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.587921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.588933 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:56:49.591917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.594919 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:56:49.595920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.596921 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m20:56:49.601924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.607578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m20:56:49.608585 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m20:56:49.614767 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.617762 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 20:56:49.527877 => 20:56:49.616766
[0m20:56:49.618778 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m20:56:49.620764 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.11s]
[0m20:56:49.622775 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m20:56:49.624764 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m20:56:49.625763 [info ] [Thread-1 (]: 8 of 10 START sql table model public.fact_stocks ............................... [RUN]
[0m20:56:49.627762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m20:56:49.628762 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m20:56:49.633295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.640669 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 20:56:49.629287 => 20:56:49.639671
[0m20:56:49.641665 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m20:56:49.647709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.656229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.657247 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m20:56:49.661223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.692630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.693627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.694628 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m20:56:49.737339 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m20:56:49.740336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.741444 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m20:56:49.744409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.748962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.748962 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m20:56:49.751941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.754980 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:56:49.755927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.756926 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m20:56:49.770604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:49.777397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m20:56:49.778393 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m20:56:49.789928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:56:49.794540 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 20:56:49.641665 => 20:56:49.794540
[0m20:56:49.796563 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m20:56:49.799613 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.17s]
[0m20:56:49.802681 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m20:56:49.804679 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m20:56:49.806697 [info ] [Thread-1 (]: 9 of 10 START sql view model public.customer_orders_status ..................... [RUN]
[0m20:56:49.809678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m20:56:49.811761 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m20:56:49.820006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.831870 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 20:56:49.813777 => 20:56:49.830930
[0m20:56:49.832931 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m20:56:49.886242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.896760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.898754 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m20:56:49.900265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:49.936977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:49.939975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.942963 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m20:56:49.951266 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:56:49.958256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.960807 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
alter table "my_database"."public"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m20:56:49.966805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:49.970815 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:56:49.972828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:56:49.974825 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: COMMIT
[0m20:56:49.979351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:50.090176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m20:56:50.091437 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */
drop view if exists "my_database"."public"."customer_orders_status__dbt_backup" cascade
[0m20:56:50.094370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:56:50.100864 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 20:56:49.832931 => 20:56:50.099838
[0m20:56:50.102925 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m20:56:50.107378 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.customer_orders_status ................ [[32mCREATE VIEW[0m in 0.30s]
[0m20:56:50.110450 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m20:56:50.112487 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m20:56:50.114522 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stock_update_status ....................... [RUN]
[0m20:56:50.118655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m20:56:50.120696 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m20:56:50.128850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.141893 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 20:56:50.122223 => 20:56:50.140880
[0m20:56:50.143116 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m20:56:50.162868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.176377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.178391 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m20:56:50.179390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:50.219830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:50.222831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.224844 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m20:56:50.234541 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:56:50.247120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.249113 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m20:56:50.253105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:56:50.259110 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:56:50.260110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.264362 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m20:56:50.270344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:56:50.278776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m20:56:50.282798 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m20:56:50.286280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:56:50.289340 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 20:56:50.146179 => 20:56:50.289340
[0m20:56:50.291376 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m20:56:50.294422 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:56:50.297425 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m20:56:50.301656 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:50.302669 [debug] [MainThread]: On master: BEGIN
[0m20:56:50.303683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:50.339000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:50.340986 [debug] [MainThread]: On master: COMMIT
[0m20:56:50.341982 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:50.343503 [debug] [MainThread]: On master: COMMIT
[0m20:56:50.347119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:56:50.349634 [debug] [MainThread]: On master: Close
[0m20:56:50.353283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:50.353796 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m20:56:50.355827 [debug] [MainThread]: Connection 'list_my_database_snapshots' was properly closed.
[0m20:56:50.356842 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m20:56:50.358839 [info ] [MainThread]: 
[0m20:56:50.359841 [info ] [MainThread]: Finished running 8 table models, 2 view models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m20:56:50.369783 [debug] [MainThread]: Command end result
[0m20:56:50.469256 [info ] [MainThread]: 
[0m20:56:50.473796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:50.474794 [info ] [MainThread]: 
[0m20:56:50.478321 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m20:56:50.490302 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:50.490302 after 2.55 seconds
[0m20:56:50.493304 [debug] [MainThread]: Flushing usage events


============================== 09:41:47.675723 | 8057dbbd-0c68-4925-89fd-3ac215f4efc0 ==============================
[0m09:41:47.675723 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:41:47.687289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m09:41:48.014340 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m09:41:48.034636 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m09:41:48.849645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:48.850671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:48.906149 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m09:41:48.909528 [info ] [MainThread]: 
[0m09:41:48.911527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:41:48.915019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m09:41:48.932565 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m09:41:48.933571 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m09:41:48.933571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:48.996927 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:41:48.998935 [debug] [ThreadPool]: On list_my_database: Close
[0m09:41:49.003832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m09:41:49.015381 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:41:49.016381 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m09:41:49.017381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:49.042578 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.044323 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:41:49.045634 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:41:49.062759 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:49.065808 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m09:41:49.070291 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m09:41:49.073840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m09:41:49.078855 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:41:49.080853 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m09:41:49.082366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:49.111003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.113078 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:41:49.114165 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:41:49.122486 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m09:41:49.126042 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m09:41:49.128056 [debug] [ThreadPool]: On list_my_database_public: Close
[0m09:41:49.147559 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:49.148594 [debug] [MainThread]: On master: BEGIN
[0m09:41:49.151124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:49.176132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.177746 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:49.178875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:41:49.199847 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:41:49.202394 [debug] [MainThread]: On master: ROLLBACK
[0m09:41:49.206403 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:49.208401 [debug] [MainThread]: On master: BEGIN
[0m09:41:49.212923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.214901 [debug] [MainThread]: On master: COMMIT
[0m09:41:49.215926 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:49.217010 [debug] [MainThread]: On master: COMMIT
[0m09:41:49.219224 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:49.221088 [debug] [MainThread]: On master: Close
[0m09:41:49.223847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:49.225368 [info ] [MainThread]: 
[0m09:41:49.240497 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m09:41:49.241521 [info ] [Thread-1 (]: 1 of 10 START sql table model public.stg_eltool__company ....................... [RUN]
[0m09:41:49.245119 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m09:41:49.248106 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m09:41:49.259957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.268039 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 09:41:49.249101 => 09:41:49.268039
[0m09:41:49.269082 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m09:41:49.341602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.349716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.350736 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m09:41:49.351691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:41:49.380372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.381906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.383133 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m09:41:49.409011 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m09:41:49.419676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.420676 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m09:41:49.423221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.428263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.428263 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m09:41:49.431722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.459233 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:41:49.460233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.461231 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:41:49.466752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:49.479912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:41:49.480889 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m09:41:49.497512 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:49.502508 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 09:41:49.270083 => 09:41:49.501508
[0m09:41:49.504051 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m09:41:49.507594 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.stg_eltool__company .................. [[32mSELECT 82[0m in 0.26s]
[0m09:41:49.510594 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m09:41:49.512596 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:41:49.514128 [info ] [Thread-1 (]: 2 of 10 START sql table model public.stg_eltool__customers_snapshots ........... [RUN]
[0m09:41:49.516130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m09:41:49.517173 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:41:49.523661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.531194 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 09:41:49.518131 => 09:41:49.531194
[0m09:41:49.533753 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:41:49.540825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.550932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.552462 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m09:41:49.553556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.584542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.586082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.587289 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m09:41:49.599214 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:41:49.605951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.607939 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m09:41:49.612584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.620021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.622610 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m09:41:49.626707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.630742 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:41:49.631704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.632700 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:41:49.639054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:49.645071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:41:49.647072 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m09:41:49.652629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:49.656778 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 09:41:49.533753 => 09:41:49.655772
[0m09:41:49.658767 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m09:41:49.661767 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public.stg_eltool__customers_snapshots ...... [[32mSELECT 100[0m in 0.15s]
[0m09:41:49.664309 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:41:49.665836 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m09:41:49.666893 [info ] [Thread-1 (]: 3 of 10 START sql table model public.stg_eltool__orders ........................ [RUN]
[0m09:41:49.668870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m09:41:49.669871 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m09:41:49.676428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:41:49.689830 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 09:41:49.670871 => 09:41:49.689830
[0m09:41:49.690826 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m09:41:49.701409 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:41:49.716338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:41:49.717350 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m09:41:49.718354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.745721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.748418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:41:49.749068 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m09:41:49.755509 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "cust_id" does not exist
LINE 15:                         cust_id AS customer_id,
                                 ^

[0m09:41:49.757466 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: ROLLBACK
[0m09:41:49.761818 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 09:41:49.692335 => 09:41:49.761258
[0m09:41:49.764862 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m09:41:49.818595 [debug] [Thread-1 (]: Database Error in model stg_eltool__orders (models\staging\stg_eltool__orders.sql)
  column "cust_id" does not exist
  LINE 15:                         cust_id AS customer_id,
                                   ^
  compiled Code at target\run\dbt_postgres_project\models\staging\stg_eltool__orders.sql
[0m09:41:49.820566 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model public.stg_eltool__orders ............... [[31mERROR[0m in 0.15s]
[0m09:41:49.821597 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m09:41:49.822596 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m09:41:49.823975 [info ] [Thread-1 (]: 4 of 10 START sql table model public.stg_eltool__state ......................... [RUN]
[0m09:41:49.824611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m09:41:49.825639 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m09:41:49.829646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.836371 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 09:41:49.826646 => 09:41:49.835395
[0m09:41:49.837361 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m09:41:49.842395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.849958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.851002 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m09:41:49.852525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.879752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:49.882052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.882643 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m09:41:49.889819 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m09:41:49.894781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.895796 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m09:41:49.900777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.907329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.908327 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m09:41:49.910363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:49.915638 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:41:49.916644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.916644 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:41:49.921189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:49.925750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:41:49.926707 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m09:41:49.931705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:49.934873 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 09:41:49.838367 => 09:41:49.934873
[0m09:41:49.935878 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m09:41:49.938883 [info ] [Thread-1 (]: 4 of 10 OK created sql table model public.stg_eltool__state .................... [[32mSELECT 27[0m in 0.11s]
[0m09:41:49.940871 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m09:41:49.942380 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m09:41:49.944392 [info ] [Thread-1 (]: 5 of 10 START sql table model public.stg_eltool__stock ......................... [RUN]
[0m09:41:49.947426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m09:41:49.948412 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m09:41:49.952984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:49.960015 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 09:41:49.949424 => 09:41:49.960015
[0m09:41:49.961037 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m09:41:49.967600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:49.975800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:49.976811 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m09:41:49.977803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:50.003978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:50.006641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:50.007424 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m09:41:50.104422 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m09:41:50.107424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:50.108422 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m09:41:50.111387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.115963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:50.116946 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m09:41:50.120933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.123486 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:41:50.125489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:50.126499 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:41:50.138589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:50.143101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:41:50.144109 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m09:41:50.151119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:50.152680 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 09:41:49.961037 => 09:41:50.152680
[0m09:41:50.153632 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m09:41:50.156175 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.stg_eltool__stock .................... [[32mSELECT 28003[0m in 0.21s]
[0m09:41:50.158687 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m09:41:50.159696 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m09:41:50.161704 [info ] [Thread-1 (]: 6 of 10 SKIP relation public.fact_orders ....................................... [[33mSKIP[0m]
[0m09:41:50.164214 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m09:41:50.166220 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m09:41:50.168238 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m09:41:50.172850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.dim_customers)
[0m09:41:50.174759 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m09:41:50.180779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m09:41:50.187822 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 09:41:50.175763 => 09:41:50.187822
[0m09:41:50.188858 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m09:41:50.195422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m09:41:50.206512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.207698 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m09:41:50.208966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:50.237977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:50.240247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.241354 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m09:41:50.250976 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:41:50.264649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.266649 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:41:50.269791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.275372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.276338 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:41:50.279340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.282370 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:41:50.282370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.282370 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:41:50.287624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:50.297927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:41:50.299947 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m09:41:50.306545 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:50.309521 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 09:41:50.189832 => 09:41:50.309521
[0m09:41:50.310529 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m09:41:50.314668 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.14s]
[0m09:41:50.317668 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m09:41:50.319668 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m09:41:50.321675 [info ] [Thread-1 (]: 8 of 10 START sql table model public.fact_stocks ............................... [RUN]
[0m09:41:50.324256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m09:41:50.325270 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m09:41:50.330871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.340993 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 09:41:50.327268 => 09:41:50.339995
[0m09:41:50.340993 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m09:41:50.357054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.365601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.366597 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m09:41:50.367593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:50.395582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:50.397145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.398218 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m09:41:50.455798 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m09:41:50.460204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.461206 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m09:41:50.463717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.467718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.468716 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m09:41:50.472720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.480033 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:41:50.481034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.483572 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:41:50.492682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:50.497727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:41:50.498761 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m09:41:50.507217 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:41:50.509733 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 09:41:50.343383 => 09:41:50.508725
[0m09:41:50.509733 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m09:41:50.512740 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.19s]
[0m09:41:50.515098 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m09:41:50.516695 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m09:41:50.517701 [info ] [Thread-1 (]: 9 of 10 SKIP relation public.customer_orders_status ............................ [[33mSKIP[0m]
[0m09:41:50.518741 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m09:41:50.519702 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m09:41:50.521706 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stock_update_status ....................... [RUN]
[0m09:41:50.522757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m09:41:50.525261 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m09:41:50.532372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.543053 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 09:41:50.526234 => 09:41:50.542519
[0m09:41:50.544064 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m09:41:50.587804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.595332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.596329 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m09:41:50.597331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:50.622678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:41:50.623414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.624467 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m09:41:50.639715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:41:50.648068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.649068 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m09:41:50.652650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:41:50.655484 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:41:50.656379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.657403 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:41:50.662363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:41:50.668573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:41:50.669572 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m09:41:50.672576 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:41:50.675770 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 09:41:50.546069 => 09:41:50.674770
[0m09:41:50.676781 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m09:41:50.679774 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.16s]
[0m09:41:50.682373 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m09:41:50.685318 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:50.686319 [debug] [MainThread]: On master: BEGIN
[0m09:41:50.687319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:50.713659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:41:50.715957 [debug] [MainThread]: On master: COMMIT
[0m09:41:50.717692 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:50.718371 [debug] [MainThread]: On master: COMMIT
[0m09:41:50.722328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:41:50.725140 [debug] [MainThread]: On master: Close
[0m09:41:50.727901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:50.730884 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m09:41:50.732418 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m09:41:50.734432 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m09:41:50.736439 [info ] [MainThread]: 
[0m09:41:50.739458 [info ] [MainThread]: Finished running 8 table models, 2 view models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m09:41:50.745488 [debug] [MainThread]: Command end result
[0m09:41:50.789583 [info ] [MainThread]: 
[0m09:41:50.790579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:41:50.791581 [info ] [MainThread]: 
[0m09:41:50.793663 [error] [MainThread]: [33mDatabase Error in model stg_eltool__orders (models\staging\stg_eltool__orders.sql)[0m
[0m09:41:50.794682 [error] [MainThread]:   column "cust_id" does not exist
[0m09:41:50.797664 [error] [MainThread]:   LINE 15:                         cust_id AS customer_id,
[0m09:41:50.798675 [error] [MainThread]:                                    ^
[0m09:41:50.800664 [error] [MainThread]:   compiled Code at target\run\dbt_postgres_project\models\staging\stg_eltool__orders.sql
[0m09:41:50.801686 [info ] [MainThread]: 
[0m09:41:50.802668 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=2 TOTAL=10
[0m09:41:50.804787 [debug] [MainThread]: Command `dbt run` failed at 09:41:50.804787 after 3.19 seconds
[0m09:41:50.806787 [debug] [MainThread]: Flushing usage events


============================== 09:42:34.126394 | 3b170686-1fc5-4c4f-9eec-ed27ab886d61 ==============================
[0m09:42:34.126394 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:42:34.130373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m09:42:34.268392 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m09:42:34.278451 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m09:42:34.442701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:34.444707 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_project://models\staging\stg_eltool__orders.sql
[0m09:42:34.599539 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m09:42:34.605113 [info ] [MainThread]: 
[0m09:42:34.608139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:34.611119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m09:42:34.629799 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m09:42:34.630819 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m09:42:34.632478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:34.675313 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:42:34.677265 [debug] [ThreadPool]: On list_my_database: Close
[0m09:42:34.682284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m09:42:34.690738 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:42:34.692228 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m09:42:34.692228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:34.720873 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:42:34.723016 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:42:34.724684 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:42:34.732229 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:34.735273 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m09:42:34.738270 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m09:42:34.743792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m09:42:34.750790 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:42:34.752263 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m09:42:34.752263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:34.782209 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:42:34.784447 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:42:34.786152 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:42:34.796868 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m09:42:34.801381 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m09:42:34.806036 [debug] [ThreadPool]: On list_my_database_public: Close
[0m09:42:34.828197 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:34.829188 [debug] [MainThread]: On master: BEGIN
[0m09:42:34.831189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:34.860630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:34.863250 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:34.865211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:34.878873 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:34.884398 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:34.888397 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:34.888941 [debug] [MainThread]: On master: BEGIN
[0m09:42:34.895500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:34.897463 [debug] [MainThread]: On master: COMMIT
[0m09:42:34.899110 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:34.900796 [debug] [MainThread]: On master: COMMIT
[0m09:42:34.906198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:34.908281 [debug] [MainThread]: On master: Close
[0m09:42:34.912645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:42:34.916384 [info ] [MainThread]: 
[0m09:42:34.925291 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m09:42:34.927292 [info ] [Thread-1 (]: 1 of 10 START sql table model public.stg_eltool__company ....................... [RUN]
[0m09:42:34.930327 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m09:42:34.931298 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m09:42:34.945957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:34.955495 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 09:42:34.932812 => 09:42:34.954493
[0m09:42:34.956496 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m09:42:35.049498 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.058042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.059040 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m09:42:35.060041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:42:35.084307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:35.086343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.087454 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m09:42:35.100386 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m09:42:35.112332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.114877 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m09:42:35.118411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.124538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.124538 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m09:42:35.127936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.159103 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:42:35.160109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.161103 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:42:35.164656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:35.178203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:42:35.179152 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m09:42:35.183688 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:35.187713 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 09:42:34.957495 => 09:42:35.186704
[0m09:42:35.188718 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m09:42:35.192793 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.stg_eltool__company .................. [[32mSELECT 82[0m in 0.26s]
[0m09:42:35.195844 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m09:42:35.195844 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:42:35.198398 [info ] [Thread-1 (]: 2 of 10 START sql table model public.stg_eltool__customers_snapshots ........... [RUN]
[0m09:42:35.199400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m09:42:35.200398 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:42:35.205970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.215048 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 09:42:35.201397 => 09:42:35.214442
[0m09:42:35.217051 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:42:35.227625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.236684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.238173 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m09:42:35.238686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:35.262298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:35.263920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.265087 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m09:42:35.272273 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:42:35.277958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.278992 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m09:42:35.280959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.286526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.287513 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m09:42:35.290499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.295618 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:42:35.296615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.297591 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:42:35.303102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:35.311113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:42:35.312110 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m09:42:35.317154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:35.320689 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 09:42:35.218080 => 09:42:35.319685
[0m09:42:35.322207 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m09:42:35.325219 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public.stg_eltool__customers_snapshots ...... [[32mSELECT 100[0m in 0.12s]
[0m09:42:35.327226 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:42:35.328221 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m09:42:35.330218 [info ] [Thread-1 (]: 3 of 10 START sql table model public.stg_eltool__orders ........................ [RUN]
[0m09:42:35.332224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m09:42:35.333671 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m09:42:35.342219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.356037 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 09:42:35.335213 => 09:42:35.355062
[0m09:42:35.357046 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m09:42:35.361061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.375216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.376249 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m09:42:35.376249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:35.402430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:35.404128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.405299 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m09:42:35.658254 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m09:42:35.660838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.663407 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m09:42:35.666385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.668419 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m09:42:35.669927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.670934 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m09:42:35.686519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:35.691050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:42:35.693759 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m09:42:35.696299 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:35.699886 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 09:42:35.358044 => 09:42:35.699886
[0m09:42:35.699886 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m09:42:35.702436 [info ] [Thread-1 (]: 3 of 10 OK created sql table model public.stg_eltool__orders ................... [[32mSELECT 99441[0m in 0.37s]
[0m09:42:35.705848 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m09:42:35.707857 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m09:42:35.710848 [info ] [Thread-1 (]: 4 of 10 START sql table model public.stg_eltool__state ......................... [RUN]
[0m09:42:35.713406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m09:42:35.715391 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m09:42:35.720372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.729937 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 09:42:35.716372 => 09:42:35.729937
[0m09:42:35.730935 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m09:42:35.744046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.753620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.754624 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m09:42:35.755924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:35.782547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:35.785139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.786140 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m09:42:35.793756 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m09:42:35.798790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.801416 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m09:42:35.805954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.813004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.814023 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m09:42:35.817518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:35.820580 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:42:35.822547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.823643 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:42:35.827645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:35.832701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:42:35.835233 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m09:42:35.840218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:35.843593 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 09:42:35.733451 => 09:42:35.843593
[0m09:42:35.844601 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m09:42:35.846622 [info ] [Thread-1 (]: 4 of 10 OK created sql table model public.stg_eltool__state .................... [[32mSELECT 27[0m in 0.13s]
[0m09:42:35.850600 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m09:42:35.851763 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m09:42:35.852320 [info ] [Thread-1 (]: 5 of 10 START sql table model public.stg_eltool__stock ......................... [RUN]
[0m09:42:35.854298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m09:42:35.855310 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m09:42:35.860310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:35.868793 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 09:42:35.856309 => 09:42:35.867793
[0m09:42:35.869799 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m09:42:35.879327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:35.889580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:35.891120 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m09:42:35.892183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:35.923396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:35.925083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:35.926270 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m09:42:36.010891 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m09:42:36.017508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:36.018020 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m09:42:36.021041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.027578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:36.029576 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m09:42:36.032577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.036472 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:42:36.037473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:36.038473 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:42:36.049754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:36.058808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:42:36.060805 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m09:42:36.067185 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:36.069185 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 09:42:35.870791 => 09:42:36.069185
[0m09:42:36.070184 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m09:42:36.073218 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.stg_eltool__stock .................... [[32mSELECT 28003[0m in 0.22s]
[0m09:42:36.076240 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m09:42:36.077241 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m09:42:36.078866 [info ] [Thread-1 (]: 6 of 10 START sql table model public.fact_orders ............................... [RUN]
[0m09:42:36.080776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m09:42:36.083297 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m09:42:36.090818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m09:42:36.100851 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 09:42:36.085304 => 09:42:36.100851
[0m09:42:36.102357 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m09:42:36.118994 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m09:42:36.133573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:42:36.134580 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m09:42:36.135579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:36.163272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:36.165374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:42:36.167502 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m09:42:36.276348 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m09:42:36.279347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:42:36.280358 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m09:42:36.283889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.286872 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m09:42:36.287872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:42:36.288871 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m09:42:36.309010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:36.319180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:42:36.320179 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m09:42:36.323730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:36.326235 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 09:42:36.103368 => 09:42:36.326235
[0m09:42:36.328258 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m09:42:36.332776 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.fact_orders .......................... [[32mSELECT 99441[0m in 0.25s]
[0m09:42:36.334841 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m09:42:36.336825 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m09:42:36.338337 [info ] [Thread-1 (]: 7 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m09:42:36.340392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m09:42:36.342914 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m09:42:36.351545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m09:42:36.363599 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 09:42:36.344922 => 09:42:36.362586
[0m09:42:36.365107 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m09:42:36.376202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m09:42:36.385973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.386981 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m09:42:36.389981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:36.417362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:36.419888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.421704 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m09:42:36.429214 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:42:36.439804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.442401 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:42:36.445354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.449894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.450906 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:42:36.454447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.458462 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:42:36.459459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.460460 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:42:36.464495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:36.469001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:42:36.470013 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m09:42:36.474526 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:36.477520 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 09:42:36.366115 => 09:42:36.476519
[0m09:42:36.477520 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m09:42:36.480036 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.dim_customers ........................ [[32mSELECT 100[0m in 0.14s]
[0m09:42:36.482639 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m09:42:36.483585 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m09:42:36.485601 [info ] [Thread-1 (]: 8 of 10 START sql table model public.fact_stocks ............................... [RUN]
[0m09:42:36.486587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m09:42:36.487587 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m09:42:36.492586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.499749 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 09:42:36.488585 => 09:42:36.499749
[0m09:42:36.500750 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m09:42:36.507264 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.515620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.516623 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m09:42:36.517620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:36.546356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:36.548445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.550786 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m09:42:36.613406 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m09:42:36.618698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.620187 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m09:42:36.622187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.628429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.629432 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m09:42:36.631431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.641050 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:42:36.642636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.643570 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:42:36.655625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:36.719953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:42:36.720953 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m09:42:36.727484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:36.731502 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 09:42:36.502255 => 09:42:36.731502
[0m09:42:36.733020 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m09:42:36.736066 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.fact_stocks .......................... [[32mSELECT 28036[0m in 0.25s]
[0m09:42:36.738043 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m09:42:36.739547 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.customer_orders_status
[0m09:42:36.740556 [info ] [Thread-1 (]: 9 of 10 START sql view model public.customer_orders_status ..................... [RUN]
[0m09:42:36.743064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.customer_orders_status)
[0m09:42:36.744074 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.customer_orders_status
[0m09:42:36.750094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.customer_orders_status"
[0m09:42:36.758633 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (compile): 09:42:36.745094 => 09:42:36.758633
[0m09:42:36.759631 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.customer_orders_status
[0m09:42:36.800728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.customer_orders_status"
[0m09:42:36.808211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m09:42:36.809210 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: BEGIN
[0m09:42:36.809210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:36.834417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:36.836927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.customer_orders_status"
[0m09:42:36.837551 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.customer_orders_status"} */

  create view "my_database"."public"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "my_database"."public"."fact_orders"),
     customers as (select *
                   from "my_database"."public"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m09:42:36.842730 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text = integer
LINE 24:     join customers c on o.customer_id = c.customer_id
                                               ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m09:42:36.844373 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: ROLLBACK
[0m09:42:36.847885 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.customer_orders_status (execute): 09:42:36.761004 => 09:42:36.847289
[0m09:42:36.849063 [debug] [Thread-1 (]: On model.dbt_postgres_project.customer_orders_status: Close
[0m09:42:36.872508 [debug] [Thread-1 (]: Database Error in model customer_orders_status (models\marts\marketing\customer_orders_status.sql)
  operator does not exist: text = integer
  LINE 24:     join customers c on o.customer_id = c.customer_id
                                                 ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_postgres_project\models\marts\marketing\customer_orders_status.sql
[0m09:42:36.875100 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model public.customer_orders_status ............ [[31mERROR[0m in 0.13s]
[0m09:42:36.877615 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.customer_orders_status
[0m09:42:36.879614 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m09:42:36.880619 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stock_update_status ....................... [RUN]
[0m09:42:36.884154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.customer_orders_status, now model.dbt_postgres_project.stock_update_status)
[0m09:42:36.885340 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m09:42:36.892352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.901651 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 09:42:36.886317 => 09:42:36.900512
[0m09:42:36.902626 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m09:42:36.909668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.917766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.918768 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m09:42:36.919766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:36.945436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:42:36.946850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.948860 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m09:42:36.956419 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:42:36.963520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.966492 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m09:42:36.971484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:36.976734 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:42:36.979258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.980307 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:42:36.985328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:42:36.992823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:42:36.993846 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m09:42:36.996968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:42:36.998968 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 09:42:36.903672 => 09:42:36.998968
[0m09:42:36.999969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m09:42:37.002646 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.stock_update_status .................. [[32mCREATE VIEW[0m in 0.12s]
[0m09:42:37.005659 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m09:42:37.009654 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:37.010667 [debug] [MainThread]: On master: BEGIN
[0m09:42:37.010667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:37.038433 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:37.040421 [debug] [MainThread]: On master: COMMIT
[0m09:42:37.042094 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:37.043774 [debug] [MainThread]: On master: COMMIT
[0m09:42:37.047973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:37.049678 [debug] [MainThread]: On master: Close
[0m09:42:37.052387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:37.054401 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m09:42:37.055403 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m09:42:37.058421 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m09:42:37.060952 [info ] [MainThread]: 
[0m09:42:37.062463 [info ] [MainThread]: Finished running 8 table models, 2 view models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m09:42:37.069592 [debug] [MainThread]: Command end result
[0m09:42:37.108296 [info ] [MainThread]: 
[0m09:42:37.110277 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:42:37.111277 [info ] [MainThread]: 
[0m09:42:37.113534 [error] [MainThread]: [33mDatabase Error in model customer_orders_status (models\marts\marketing\customer_orders_status.sql)[0m
[0m09:42:37.115534 [error] [MainThread]:   operator does not exist: text = integer
[0m09:42:37.117547 [error] [MainThread]:   LINE 24:     join customers c on o.customer_id = c.customer_id
[0m09:42:37.118531 [error] [MainThread]:                                                  ^
[0m09:42:37.119038 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m09:42:37.120046 [error] [MainThread]:   compiled Code at target\run\dbt_postgres_project\models\marts\marketing\customer_orders_status.sql
[0m09:42:37.121052 [info ] [MainThread]: 
[0m09:42:37.124581 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m09:42:37.126595 [debug] [MainThread]: Command `dbt run` failed at 09:42:37.125590 after 3.04 seconds
[0m09:42:37.127590 [debug] [MainThread]: Flushing usage events


============================== 09:44:28.876867 | 8501cb64-7551-4700-aaea-8c23e51323c6 ==============================
[0m09:44:28.876867 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:44:28.883100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m09:44:29.106020 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m09:44:29.126660 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m09:44:29.417421 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:44:29.418434 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres_project://models\marts\marketing\customer_orders_status.sql
[0m09:44:29.445062 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customer_orders_status' in the 'models' section of file 'models\marts\marketing\marketing.yml'
[0m09:44:29.510514 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_postgres_project.not_null_customer_orders_status_customer_id.3915c814eb' (models\marts\marketing\marketing.yml) depends on a node named 'customer_orders_status' in package '' which was not found
[0m09:44:29.512027 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_postgres_project.unique_customer_orders_status_order_id.b7a45e83ee' (models\marts\marketing\marketing.yml) depends on a node named 'customer_orders_status' in package '' which was not found
[0m09:44:29.513036 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_postgres_project.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27' (models\marts\marketing\marketing.yml) depends on a node named 'customer_orders_status' in package '' which was not found
[0m09:44:29.535269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres_project.marts.marketing
[0m09:44:29.602152 [info ] [MainThread]: Found 9 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m09:44:29.606274 [info ] [MainThread]: 
[0m09:44:29.608794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:29.613369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m09:44:29.628423 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m09:44:29.630425 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m09:44:29.630425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:29.673796 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:44:29.676304 [debug] [ThreadPool]: On list_my_database: Close
[0m09:44:29.681824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m09:44:29.688876 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:44:29.690879 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m09:44:29.691881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:29.720124 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:29.721803 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m09:44:29.723611 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:44:29.731046 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:29.733203 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m09:44:29.736200 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m09:44:29.740727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m09:44:29.751010 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:44:29.753069 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m09:44:29.755031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:29.781844 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:29.783488 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m09:44:29.784617 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:44:29.793637 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m09:44:29.796232 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m09:44:29.800692 [debug] [ThreadPool]: On list_my_database_public: Close
[0m09:44:29.817178 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:29.819192 [debug] [MainThread]: On master: BEGIN
[0m09:44:29.820193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:29.848494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:29.850251 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:29.851267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:29.866894 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:44:29.870429 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:29.872939 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:29.874947 [debug] [MainThread]: On master: BEGIN
[0m09:44:29.879491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:29.881120 [debug] [MainThread]: On master: COMMIT
[0m09:44:29.882778 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:29.883864 [debug] [MainThread]: On master: COMMIT
[0m09:44:29.887870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:29.889027 [debug] [MainThread]: On master: Close
[0m09:44:29.891368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:29.892890 [info ] [MainThread]: 
[0m09:44:29.900944 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m09:44:29.903519 [info ] [Thread-1 (]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m09:44:29.905530 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m09:44:29.908052 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m09:44:29.921093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:29.931944 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 09:44:29.909054 => 09:44:29.930426
[0m09:44:29.932998 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m09:44:30.013536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.023120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.024118 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m09:44:30.025114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:44:30.050818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:30.052880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.054593 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m09:44:30.067249 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m09:44:30.079285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.079796 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m09:44:30.083906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.088968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.090481 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m09:44:30.094027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.124439 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:44:30.125452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.127433 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m09:44:30.132026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:30.147096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m09:44:30.149102 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m09:44:30.154151 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:30.158131 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 09:44:29.934526 => 09:44:30.158131
[0m09:44:30.159159 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m09:44:30.162171 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.26s]
[0m09:44:30.164190 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m09:44:30.165209 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:44:30.166723 [info ] [Thread-1 (]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m09:44:30.168739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m09:44:30.169754 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:44:30.174266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.182293 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 09:44:30.170735 => 09:44:30.180780
[0m09:44:30.182831 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:44:30.197407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.205964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.206958 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m09:44:30.208966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:30.238336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:30.239620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.241326 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m09:44:30.254540 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:44:30.263187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.264183 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m09:44:30.269221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.274772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.275773 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m09:44:30.278773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.284303 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:44:30.287159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.288159 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m09:44:30.292197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:30.298211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m09:44:30.299223 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m09:44:30.303301 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:30.306293 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 09:44:30.183839 => 09:44:30.305292
[0m09:44:30.308297 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m09:44:30.310296 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.14s]
[0m09:44:30.312840 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m09:44:30.314358 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m09:44:30.316373 [info ] [Thread-1 (]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m09:44:30.318375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m09:44:30.319373 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m09:44:30.325894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.340645 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 09:44:30.320370 => 09:44:30.339641
[0m09:44:30.341641 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m09:44:30.351177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.367194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.368193 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m09:44:30.369199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:30.397036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:30.398099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.399776 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m09:44:30.516865 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m09:44:30.521853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.522870 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m09:44:30.526323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.532836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.533833 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m09:44:30.536845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.540874 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m09:44:30.541843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.542386 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m09:44:30.593630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:30.600212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m09:44:30.601259 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m09:44:30.607750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:30.610757 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 09:44:30.342205 => 09:44:30.609752
[0m09:44:30.610757 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m09:44:30.614795 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.30s]
[0m09:44:30.616811 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m09:44:30.617813 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m09:44:30.619325 [info ] [Thread-1 (]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m09:44:30.621850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m09:44:30.623861 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m09:44:30.628865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.636929 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 09:44:30.624861 => 09:44:30.636929
[0m09:44:30.638525 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m09:44:30.653162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.663238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.664235 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m09:44:30.666248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:30.702290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:30.703548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.705233 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m09:44:30.712002 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m09:44:30.719608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.720629 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m09:44:30.724163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.729755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.730719 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m09:44:30.733247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.737499 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:44:30.738469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.739464 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m09:44:30.743322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:30.748296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m09:44:30.749299 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m09:44:30.753823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:30.757336 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 09:44:30.641069 => 09:44:30.757336
[0m09:44:30.758349 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m09:44:30.760369 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.14s]
[0m09:44:30.762934 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m09:44:30.764934 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m09:44:30.765937 [info ] [Thread-1 (]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m09:44:30.768493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m09:44:30.769459 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m09:44:30.773008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.782106 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 09:44:30.769459 => 09:44:30.780595
[0m09:44:30.783121 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m09:44:30.793833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.801878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.804144 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m09:44:30.804144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:30.833972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:30.836323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.837997 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m09:44:30.905862 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m09:44:30.910905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.911873 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m09:44:30.914442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.918475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.920430 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m09:44:30.923988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:30.929102 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:44:30.930129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.931149 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m09:44:30.943683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:30.955199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m09:44:30.957233 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m09:44:30.962749 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:30.966793 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 09:44:30.783121 => 09:44:30.965758
[0m09:44:30.967781 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m09:44:30.969773 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.20s]
[0m09:44:30.972279 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m09:44:30.973291 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m09:44:30.975426 [info ] [Thread-1 (]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m09:44:30.978397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m09:44:30.979397 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m09:44:30.983913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m09:44:30.993038 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 09:44:30.979397 => 09:44:30.993038
[0m09:44:30.994063 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m09:44:31.004167 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m09:44:31.014236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.015715 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m09:44:31.016775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:31.045382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:31.047486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.048814 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m09:44:31.193660 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m09:44:31.199674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.200656 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m09:44:31.204208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.208738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.208738 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m09:44:31.212270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.218409 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m09:44:31.220429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.220429 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m09:44:31.235074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:31.244137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m09:44:31.246135 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m09:44:31.264644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:31.267649 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 09:44:30.995043 => 09:44:31.267649
[0m09:44:31.269650 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m09:44:31.272181 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.29s]
[0m09:44:31.275231 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m09:44:31.277215 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m09:44:31.279206 [info ] [Thread-1 (]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m09:44:31.282207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m09:44:31.283231 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m09:44:31.290280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m09:44:31.301348 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 09:44:31.284265 => 09:44:31.299819
[0m09:44:31.303414 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m09:44:31.317947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m09:44:31.327588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.328582 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m09:44:31.329579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:31.358611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:31.359694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.361887 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m09:44:31.370338 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m09:44:31.378411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.379423 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:44:31.383993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.388527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.390530 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:44:31.393094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.397088 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:44:31.399094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.399094 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m09:44:31.404322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:31.409327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m09:44:31.410350 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m09:44:31.414866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:31.418386 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 09:44:31.304423 => 09:44:31.417379
[0m09:44:31.419408 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m09:44:31.422443 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.14s]
[0m09:44:31.425462 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m09:44:31.426460 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m09:44:31.428462 [info ] [Thread-1 (]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m09:44:31.430464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m09:44:31.430464 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m09:44:31.437986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.448553 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 09:44:31.432985 => 09:44:31.447542
[0m09:44:31.450541 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m09:44:31.460594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.469634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.470637 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m09:44:31.472208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:31.502392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:31.504099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.505200 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m09:44:31.568935 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m09:44:31.575187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.576178 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m09:44:31.579172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.586222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.587935 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m09:44:31.590786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.594325 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:44:31.595341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.596850 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m09:44:31.609022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:31.679815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m09:44:31.681866 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m09:44:31.687883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:31.692077 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 09:44:31.450541 => 09:44:31.691058
[0m09:44:31.693091 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m09:44:31.696121 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.27s]
[0m09:44:31.699119 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m09:44:31.700636 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m09:44:31.702163 [info ] [Thread-1 (]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m09:44:31.704177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m09:44:31.705669 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m09:44:31.709706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.718303 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 09:44:31.705669 => 09:44:31.717333
[0m09:44:31.719296 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m09:44:31.755252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.763892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.764873 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m09:44:31.765876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:31.792995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:44:31.794433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.795473 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m09:44:31.807508 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:31.812614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.813669 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m09:44:31.817689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:31.820704 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:44:31.822219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.823234 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m09:44:31.827237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:31.836480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m09:44:31.837513 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m09:44:31.840478 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:31.843050 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 09:44:31.720297 => 09:44:31.843050
[0m09:44:31.844016 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m09:44:31.847013 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.14s]
[0m09:44:31.850017 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m09:44:31.853554 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:31.854570 [debug] [MainThread]: On master: BEGIN
[0m09:44:31.856578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:31.887008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:31.888650 [debug] [MainThread]: On master: COMMIT
[0m09:44:31.890009 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:31.891109 [debug] [MainThread]: On master: COMMIT
[0m09:44:31.893880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:31.895016 [debug] [MainThread]: On master: Close
[0m09:44:31.896686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:31.898571 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m09:44:31.899594 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m09:44:31.901581 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m09:44:31.903137 [info ] [MainThread]: 
[0m09:44:31.904138 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m09:44:31.909136 [debug] [MainThread]: Command end result
[0m09:44:31.956246 [info ] [MainThread]: 
[0m09:44:31.958248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:31.959534 [info ] [MainThread]: 
[0m09:44:31.962080 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:44:31.963090 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:31.963090 after 3.13 seconds
[0m09:44:31.964097 [debug] [MainThread]: Flushing usage events


============================== 10:04:16.795484 | bac0a139-2858-4168-97d8-35652c6c902a ==============================
[0m10:04:16.795484 [info ] [MainThread]: Running with dbt=1.6.1
[0m10:04:16.800998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:04:16.938701 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m10:04:16.949729 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m10:04:17.142861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:17.143893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:17.145869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres_project.marts.marketing
[0m10:04:17.203741 [info ] [MainThread]: Found 9 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m10:04:17.209781 [info ] [MainThread]: 
[0m10:04:17.211795 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:04:17.212784 [debug] [MainThread]: Command end result
[0m10:04:17.254732 [info ] [MainThread]: 
[0m10:04:17.257250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:17.259790 [info ] [MainThread]: 
[0m10:04:17.261785 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m10:04:17.263786 [debug] [MainThread]: Command `dbt seed` succeeded at 10:04:17.263786 after 0.51 seconds
[0m10:04:17.265790 [debug] [MainThread]: Flushing usage events


============================== 10:04:26.588837 | 3bb7560a-00d7-4f72-9f40-8e6248b6b406 ==============================
[0m10:04:26.588837 [info ] [MainThread]: Running with dbt=1.6.1
[0m10:04:26.596378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:04:26.800481 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m10:04:26.817642 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m10:04:27.029554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:27.031175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:27.033093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_postgres_project.marts.marketing
[0m10:04:27.090422 [info ] [MainThread]: Found 9 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m10:04:27.094418 [info ] [MainThread]: 
[0m10:04:27.096469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:27.099995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m10:04:27.121636 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m10:04:27.121636 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m10:04:27.123152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:27.167932 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:04:27.169457 [debug] [ThreadPool]: On list_my_database: Close
[0m10:04:27.174457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m10:04:27.187289 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m10:04:27.188619 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m10:04:27.189964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:27.216120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.217134 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m10:04:27.218645 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m10:04:27.225179 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m10:04:27.227179 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m10:04:27.229721 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m10:04:27.232108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m10:04:27.236633 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m10:04:27.237632 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m10:04:27.238633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:27.265399 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.266434 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m10:04:27.267429 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:27.273516 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m10:04:27.275524 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m10:04:27.277529 [debug] [ThreadPool]: On list_my_database_public: Close
[0m10:04:27.291751 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:27.292739 [debug] [MainThread]: On master: BEGIN
[0m10:04:27.293251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:27.321735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.322736 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:27.323760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:04:27.335824 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:04:27.337826 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:27.340276 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:27.341274 [debug] [MainThread]: On master: BEGIN
[0m10:04:27.346711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.347710 [debug] [MainThread]: On master: COMMIT
[0m10:04:27.349232 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:27.350242 [debug] [MainThread]: On master: COMMIT
[0m10:04:27.353243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:27.354766 [debug] [MainThread]: On master: Close
[0m10:04:27.356786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:27.359310 [info ] [MainThread]: 
[0m10:04:27.364379 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m10:04:27.365888 [info ] [Thread-1 (]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m10:04:27.366902 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m10:04:27.368414 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m10:04:27.379504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.388507 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 10:04:27.369438 => 10:04:27.387501
[0m10:04:27.391041 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m10:04:27.456064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.475732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.479242 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m10:04:27.481272 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:27.521095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.522624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.523671 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m10:04:27.533173 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m10:04:27.552008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.553990 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m10:04:27.560583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:27.571604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.573892 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m10:04:27.577870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:27.612969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m10:04:27.614969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.616969 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m10:04:27.621050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:27.637215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:27.639739 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m10:04:27.649981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:27.655427 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 10:04:27.391041 => 10:04:27.654887
[0m10:04:27.657097 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m10:04:27.660410 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.29s]
[0m10:04:27.663357 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m10:04:27.664443 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:27.666072 [info ] [Thread-1 (]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m10:04:27.667160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m10:04:27.668252 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:27.673138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.682110 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 10:04:27.669421 => 10:04:27.681096
[0m10:04:27.683107 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:27.691109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.699631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.700635 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m10:04:27.701147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:27.725795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.726791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.728300 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m10:04:27.735903 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:04:27.741430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.742437 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m10:04:27.744467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:27.750842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.751853 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m10:04:27.754375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:27.757389 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m10:04:27.758900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.759917 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m10:04:27.762447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:27.768494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:27.769511 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m10:04:27.774526 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:27.778573 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 10:04:27.684103 => 10:04:27.777561
[0m10:04:27.779885 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m10:04:27.782884 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.12s]
[0m10:04:27.785415 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:27.786412 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:27.787624 [info ] [Thread-1 (]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m10:04:27.789137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m10:04:27.790648 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:27.796708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:27.812615 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 10:04:27.791662 => 10:04:27.811614
[0m10:04:27.813612 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:27.821172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:27.835266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:27.836280 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m10:04:27.837282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:27.865397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:27.866399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:27.867912 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m10:04:28.027084 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m10:04:28.033152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:28.033666 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m10:04:28.036690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.040211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:28.042210 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m10:04:28.044729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.047733 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m10:04:28.048731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:28.048731 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m10:04:28.068378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.077082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:28.078597 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m10:04:28.090276 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:28.092289 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 10:04:27.814615 => 10:04:28.092289
[0m10:04:28.093286 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m10:04:28.095584 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.31s]
[0m10:04:28.096587 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:28.098634 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m10:04:28.100648 [info ] [Thread-1 (]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m10:04:28.102649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m10:04:28.105240 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m10:04:28.109202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.116746 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 10:04:28.106165 => 10:04:28.116746
[0m10:04:28.118741 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m10:04:28.126812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.133402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.134912 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m10:04:28.135923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:28.162688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:28.163687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.165688 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m10:04:28.171259 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m10:04:28.177271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.178782 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m10:04:28.181346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.186338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.187346 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m10:04:28.190390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.193712 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m10:04:28.194714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.195713 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m10:04:28.198716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.203648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:28.204647 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m10:04:28.208825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:28.211839 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 10:04:28.119265 => 10:04:28.211839
[0m10:04:28.212838 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m10:04:28.214837 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.11s]
[0m10:04:28.216840 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m10:04:28.217838 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:28.218840 [info ] [Thread-1 (]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m10:04:28.221131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m10:04:28.221644 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:28.226185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.233238 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 10:04:28.222660 => 10:04:28.233238
[0m10:04:28.234769 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:28.241333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.249388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.251393 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m10:04:28.252394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:28.280146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:28.281166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.283181 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m10:04:28.372819 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m10:04:28.381393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.382390 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m10:04:28.385395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.389931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.392465 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m10:04:28.395000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.399535 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m10:04:28.400532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.402550 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m10:04:28.413101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.423613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:28.425121 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m10:04:28.432196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:28.434812 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 10:04:28.235799 => 10:04:28.434812
[0m10:04:28.435722 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m10:04:28.437724 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.22s]
[0m10:04:28.441253 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:28.443250 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m10:04:28.444276 [info ] [Thread-1 (]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m10:04:28.446287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m10:04:28.447285 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m10:04:28.452343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m10:04:28.460884 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 10:04:28.448799 => 10:04:28.460884
[0m10:04:28.461885 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m10:04:28.470979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m10:04:28.478523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.479552 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m10:04:28.480566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:28.508351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:28.509366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.510367 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m10:04:28.633237 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m10:04:28.637376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.638876 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m10:04:28.641888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.645925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.646889 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m10:04:28.650462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.653477 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m10:04:28.655016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.655016 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m10:04:28.674384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.679919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:28.681922 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m10:04:28.693129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:28.696184 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 10:04:28.462882 => 10:04:28.696184
[0m10:04:28.697160 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m10:04:28.700682 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.25s]
[0m10:04:28.702682 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m10:04:28.703680 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m10:04:28.704691 [info ] [Thread-1 (]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m10:04:28.706928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m10:04:28.708456 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m10:04:28.713018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m10:04:28.721754 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 10:04:28.709501 => 10:04:28.720753
[0m10:04:28.722712 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m10:04:28.728698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m10:04:28.735657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.736657 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m10:04:28.738188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:28.768831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:28.770028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.771026 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m10:04:28.778555 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:04:28.783595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.784608 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m10:04:28.787622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.792143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.794144 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:04:28.796676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.800266 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m10:04:28.801277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.801277 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m10:04:28.805287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.809844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:04:28.810841 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m10:04:28.816359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:28.819893 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 10:04:28.723724 => 10:04:28.818878
[0m10:04:28.821887 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m10:04:28.823902 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.12s]
[0m10:04:28.825888 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m10:04:28.826918 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m10:04:28.828496 [info ] [Thread-1 (]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m10:04:28.830470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m10:04:28.831444 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m10:04:28.836960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.845488 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 10:04:28.832439 => 10:04:28.844490
[0m10:04:28.847484 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m10:04:28.858829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.868423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.869433 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m10:04:28.870480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:28.897163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:28.898677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.900690 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m10:04:28.948460 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m10:04:28.954485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.955477 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m10:04:28.958474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.969943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.970957 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m10:04:28.973960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:28.976953 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m10:04:28.978519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.979471 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m10:04:28.986490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:28.991502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:04:28.992479 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m10:04:28.999043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:29.001053 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 10:04:28.848484 => 10:04:29.001053
[0m10:04:29.002561 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m10:04:29.005591 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.18s]
[0m10:04:29.007585 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m10:04:29.009087 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m10:04:29.010099 [info ] [Thread-1 (]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m10:04:29.012604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m10:04:29.014613 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m10:04:29.022252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.031733 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 10:04:29.015615 => 10:04:29.030733
[0m10:04:29.031733 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m10:04:29.054488 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.061714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.062685 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m10:04:29.063702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:29.090570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:29.091585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.092568 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m10:04:29.099191 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:04:29.107209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.108719 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m10:04:29.112287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:29.114276 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m10:04:29.116252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.116252 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m10:04:29.120840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:29.128409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:04:29.129460 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m10:04:29.131993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:04:29.134029 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 10:04:29.033273 => 10:04:29.134029
[0m10:04:29.135538 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m10:04:29.137546 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:04:29.140764 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m10:04:29.142742 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:29.143737 [debug] [MainThread]: On master: BEGIN
[0m10:04:29.144741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:29.171952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:29.173934 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.173934 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:29.174929 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.176925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:29.176925 [debug] [MainThread]: On master: Close
[0m10:04:29.179477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:29.180480 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m10:04:29.182475 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m10:04:29.183509 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m10:04:29.185473 [info ] [MainThread]: 
[0m10:04:29.186497 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m10:04:29.189588 [debug] [MainThread]: Command end result
[0m10:04:29.217663 [info ] [MainThread]: 
[0m10:04:29.218664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:29.219175 [info ] [MainThread]: 
[0m10:04:29.221187 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:04:29.222183 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:29.222183 after 2.68 seconds
[0m10:04:29.222183 [debug] [MainThread]: Flushing usage events


============================== 10:04:56.737185 | 913a3c44-44c8-4d9d-87b4-508646032e09 ==============================
[0m10:04:56.737185 [info ] [MainThread]: Running with dbt=1.6.1
[0m10:04:56.744754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:04:56.966051 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m10:04:56.984700 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m10:04:57.002894 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:04:58.707578 [info ] [MainThread]: Found 9 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m10:04:58.712027 [info ] [MainThread]: 
[0m10:04:58.714063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:58.719557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m10:04:58.742138 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m10:04:58.743137 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m10:04:58.744665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:58.783205 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:04:58.785220 [debug] [ThreadPool]: On list_my_database: Close
[0m10:04:58.789733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database_snapshots'
[0m10:04:58.797763 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m10:04:58.798728 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m10:04:58.799242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:58.825867 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:58.826868 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m10:04:58.826868 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m10:04:58.832385 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m10:04:58.834388 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m10:04:58.837386 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m10:04:58.839953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m10:04:58.845093 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m10:04:58.846079 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m10:04:58.847134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:58.875534 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:58.876543 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m10:04:58.878534 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:58.886663 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m10:04:58.889782 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m10:04:58.892788 [debug] [ThreadPool]: On list_my_database_public: Close
[0m10:04:58.912122 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:58.913124 [debug] [MainThread]: On master: BEGIN
[0m10:04:58.915118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:58.948393 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:58.949935 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:58.950918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:04:58.962880 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:04:58.965881 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:58.968519 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:58.969406 [debug] [MainThread]: On master: BEGIN
[0m10:04:58.974927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:58.976927 [debug] [MainThread]: On master: COMMIT
[0m10:04:58.978443 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:58.980469 [debug] [MainThread]: On master: COMMIT
[0m10:04:58.983483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:58.985467 [debug] [MainThread]: On master: Close
[0m10:04:58.988468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:58.989956 [info ] [MainThread]: 
[0m10:04:58.997434 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m10:04:58.999544 [info ] [Thread-1 (]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m10:04:59.003526 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_postgres_project.stg_eltool__company'
[0m10:04:59.004522 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m10:04:59.018746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.026794 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 10:04:59.005524 => 10:04:59.026794
[0m10:04:59.028310 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m10:04:59.099034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.108667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.110605 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m10:04:59.111643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:59.137104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:59.138613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.139623 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m10:04:59.147744 [debug] [Thread-1 (]: SQL status: SELECT 82 in 0.0 seconds
[0m10:04:59.156574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.157563 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m10:04:59.160083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.165118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.166120 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m10:04:59.169177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.200580 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m10:04:59.202578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.203583 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m10:04:59.206583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:59.218715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m10:04:59.219723 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m10:04:59.223722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:59.226744 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 10:04:59.029318 => 10:04:59.226744
[0m10:04:59.228745 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m10:04:59.231015 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.23s]
[0m10:04:59.233022 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m10:04:59.235016 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:59.237023 [info ] [Thread-1 (]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m10:04:59.238530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m10:04:59.239536 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:59.244539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.253083 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 10:04:59.240538 => 10:04:59.253083
[0m10:04:59.254090 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:59.263197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.277367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.279677 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m10:04:59.281310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:59.305082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:59.305082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.306082 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m10:04:59.313601 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:04:59.317601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.318600 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m10:04:59.321115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.324111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.326114 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m10:04:59.327114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.330625 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m10:04:59.331627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.332627 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m10:04:59.335627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:59.339230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m10:04:59.340235 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m10:04:59.344242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:59.347236 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 10:04:59.255084 => 10:04:59.347236
[0m10:04:59.348819 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m10:04:59.350753 [info ] [Thread-1 (]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.11s]
[0m10:04:59.352763 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m10:04:59.353758 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:59.354756 [info ] [Thread-1 (]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m10:04:59.357750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m10:04:59.358751 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:59.366362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.383398 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 10:04:59.361365 => 10:04:59.382353
[0m10:04:59.384356 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:59.395308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.410180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.411197 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m10:04:59.412166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:59.435778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:59.436778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.436778 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m10:04:59.531512 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m10:04:59.537512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.539019 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m10:04:59.542031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.546611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.547610 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m10:04:59.549834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.553864 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m10:04:59.554888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.555869 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m10:04:59.569476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:59.575504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m10:04:59.576503 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m10:04:59.582322 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:59.585836 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 10:04:59.386355 => 10:04:59.585836
[0m10:04:59.586846 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m10:04:59.590362 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.23s]
[0m10:04:59.592373 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m10:04:59.593375 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m10:04:59.596374 [info ] [Thread-1 (]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m10:04:59.598376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m10:04:59.598376 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m10:04:59.603156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.612716 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 10:04:59.599639 => 10:04:59.612716
[0m10:04:59.613701 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m10:04:59.627173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.636700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.637700 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m10:04:59.638731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:59.670598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:59.671595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.672625 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m10:04:59.677591 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0.0 seconds
[0m10:04:59.681375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.682416 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m10:04:59.686386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.690911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.691912 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m10:04:59.695914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.698949 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m10:04:59.699963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.699963 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m10:04:59.705488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:59.713043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m10:04:59.715022 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m10:04:59.720161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:59.723460 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 10:04:59.614705 => 10:04:59.723460
[0m10:04:59.724442 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m10:04:59.727455 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.13s]
[0m10:04:59.730574 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m10:04:59.731574 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:59.732590 [info ] [Thread-1 (]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m10:04:59.735576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m10:04:59.736580 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:59.742689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.753345 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 10:04:59.737582 => 10:04:59.752378
[0m10:04:59.754345 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:59.761347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.770404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.771381 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m10:04:59.772380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:59.816720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:59.818294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.819317 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m10:04:59.883075 [debug] [Thread-1 (]: SQL status: SELECT 28003 in 0.0 seconds
[0m10:04:59.892141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.894138 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m10:04:59.898686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.907282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.908823 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m10:04:59.911832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:04:59.914830 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m10:04:59.917348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.918350 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m10:04:59.929677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:04:59.934672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m10:04:59.935684 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m10:04:59.942421 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:04:59.944423 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 10:04:59.755346 => 10:04:59.944423
[0m10:04:59.946420 [debug] [Thread-1 (]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m10:04:59.948429 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.21s]
[0m10:04:59.950997 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m10:04:59.952970 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_orders
[0m10:04:59.953968 [info ] [Thread-1 (]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m10:04:59.956544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m10:04:59.957598 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_orders
[0m10:04:59.962237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m10:04:59.972779 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (compile): 10:04:59.958551 => 10:04:59.972779
[0m10:04:59.974776 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_orders
[0m10:04:59.984858 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m10:04:59.994379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:04:59.995413 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m10:04:59.997381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:00.035792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:05:00.036791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:05:00.038303 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m10:05:00.141368 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m10:05:00.146924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:05:00.146924 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m10:05:00.150450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.155830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:05:00.156829 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m10:05:00.159361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.162933 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m10:05:00.163932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:05:00.164899 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m10:05:00.180016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:05:00.186576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m10:05:00.187612 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m10:05:00.193957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:05:00.197472 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_orders (execute): 10:04:59.975775 => 10:05:00.197472
[0m10:05:00.199004 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_orders: Close
[0m10:05:00.202528 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.24s]
[0m10:05:00.204530 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_orders
[0m10:05:00.206527 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.dim_customers
[0m10:05:00.207524 [info ] [Thread-1 (]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m10:05:00.210114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m10:05:00.211124 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.dim_customers
[0m10:05:00.220710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m10:05:00.229785 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (compile): 10:05:00.212120 => 10:05:00.228777
[0m10:05:00.231296 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.dim_customers
[0m10:05:00.241352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m10:05:00.249865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.251880 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m10:05:00.252877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:00.282040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:05:00.283039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.283039 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m10:05:00.288572 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:05:00.296105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.297107 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m10:05:00.299141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.304171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.305181 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:05:00.307161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.312717 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m10:05:00.313708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.315721 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m10:05:00.318760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:05:00.322749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m10:05:00.323729 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m10:05:00.328730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:05:00.331954 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.dim_customers (execute): 10:05:00.232305 => 10:05:00.330947
[0m10:05:00.332995 [debug] [Thread-1 (]: On model.dbt_postgres_project.dim_customers: Close
[0m10:05:00.334997 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.13s]
[0m10:05:00.336993 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.dim_customers
[0m10:05:00.339513 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.fact_stocks
[0m10:05:00.340511 [info ] [Thread-1 (]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m10:05:00.342511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m10:05:00.344523 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m10:05:00.352137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.361672 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 10:05:00.346512 => 10:05:00.361672
[0m10:05:00.362855 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.fact_stocks
[0m10:05:00.369422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.376943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.378468 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m10:05:00.379482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:00.403725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:05:00.404689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.405724 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m10:05:00.446753 [debug] [Thread-1 (]: SQL status: SELECT 28036 in 0.0 seconds
[0m10:05:00.450324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.452849 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m10:05:00.454874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.458499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.459454 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m10:05:00.461932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.465973 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m10:05:00.466938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.466938 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m10:05:00.477047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:05:00.483610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m10:05:00.484575 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m10:05:00.490630 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:05:00.493638 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 10:05:00.362855 => 10:05:00.493638
[0m10:05:00.495672 [debug] [Thread-1 (]: On model.dbt_postgres_project.fact_stocks: Close
[0m10:05:00.497656 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.15s]
[0m10:05:00.499809 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.fact_stocks
[0m10:05:00.501823 [debug] [Thread-1 (]: Began running node model.dbt_postgres_project.stock_update_status
[0m10:05:00.502819 [info ] [Thread-1 (]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m10:05:00.504819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m10:05:00.505850 [debug] [Thread-1 (]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m10:05:00.508431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.516911 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 10:05:00.505850 => 10:05:00.515901
[0m10:05:00.518419 [debug] [Thread-1 (]: Began executing node model.dbt_postgres_project.stock_update_status
[0m10:05:00.542558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.553828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.556054 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m10:05:00.557799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:00.586783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:05:00.589293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.590308 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m10:05:00.595319 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:05:00.599531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.600531 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m10:05:00.604584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:05:00.606588 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m10:05:00.607587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.608586 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m10:05:00.615298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:05:00.622540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m10:05:00.622540 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m10:05:00.625562 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:05:00.627543 [debug] [Thread-1 (]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 10:05:00.519429 => 10:05:00.627543
[0m10:05:00.629113 [debug] [Thread-1 (]: On model.dbt_postgres_project.stock_update_status: Close
[0m10:05:00.631140 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:05:00.634137 [debug] [Thread-1 (]: Finished running node model.dbt_postgres_project.stock_update_status
[0m10:05:00.637139 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:00.638648 [debug] [MainThread]: On master: BEGIN
[0m10:05:00.639654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:00.666360 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:05:00.668353 [debug] [MainThread]: On master: COMMIT
[0m10:05:00.668869 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:00.669890 [debug] [MainThread]: On master: COMMIT
[0m10:05:00.672920 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:05:00.673905 [debug] [MainThread]: On master: Close
[0m10:05:00.675901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:00.676907 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m10:05:00.678940 [debug] [MainThread]: Connection 'list_my_database_public' was properly closed.
[0m10:05:00.679952 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m10:05:00.681949 [info ] [MainThread]: 
[0m10:05:00.683080 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m10:05:00.687395 [debug] [MainThread]: Command end result
[0m10:05:00.718385 [info ] [MainThread]: 
[0m10:05:00.722058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:00.724381 [info ] [MainThread]: 
[0m10:05:00.726585 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:05:00.729407 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:00.728800 after 4.06 seconds
[0m10:05:00.731164 [debug] [MainThread]: Flushing usage events


============================== 03:05:39.519600 | 75d47581-abdd-40b0-a759-a1ada5521e17 ==============================
[0m03:05:39.519600 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:05:39.535055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:05:39.858238 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:05:39.913086 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:05:39.971720 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m03:05:42.468531 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m03:05:42.494714 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m03:05:42.507628 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_stocks.sql
[0m03:05:42.519665 [debug] [MainThread]: 1699: static parser successfully parsed marts/stock/stock_update_status.sql
[0m03:05:42.530366 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__company.sql
[0m03:05:42.543015 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers_snapshots.sql
[0m03:05:42.556116 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m03:05:42.571962 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m03:05:42.583816 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__stock.sql
[0m03:05:43.177432 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:05:43.182137 [info ] [MainThread]: 
[0m03:05:43.185056 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:05:43.186678 [debug] [MainThread]: Command end result
[0m03:05:43.248959 [info ] [MainThread]: 
[0m03:05:43.251314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:43.253418 [info ] [MainThread]: 
[0m03:05:43.256507 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m03:05:43.259846 [debug] [MainThread]: Command `dbt seed` succeeded at 03:05:43.259497 after 3.79 seconds
[0m03:05:43.261913 [debug] [MainThread]: Flushing usage events


============================== 03:05:50.717621 | 70958fb7-a399-4269-bad9-75bea803f25c ==============================
[0m03:05:50.717621 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:05:50.726222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:05:50.977045 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:05:51.031033 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:05:52.084190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:52.085506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:52.165087 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:05:52.169150 [info ] [MainThread]: 
[0m03:05:52.173038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:52.179024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:05:52.213857 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:05:52.215896 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:05:52.217289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:52.220217 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

[0m03:05:52.223178 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:05:52.224770 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m03:05:52.226227 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m03:05:52.228040 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m03:05:52.230305 [debug] [ThreadPool]: On list_my_database: No close available on handle
[0m03:05:52.234309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:52.235603 [debug] [MainThread]: Connection 'list_my_database' was properly closed.
[0m03:05:52.237331 [info ] [MainThread]: 
[0m03:05:52.239573 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m03:05:52.241523 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m03:05:52.243492 [debug] [MainThread]: Command `dbt run` failed at 03:05:52.243254 after 1.57 seconds
[0m03:05:52.245655 [debug] [MainThread]: Flushing usage events


============================== 03:06:59.240607 | d97824f5-479a-4858-85d4-9ff617928287 ==============================
[0m03:06:59.240607 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:06:59.250317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:06:59.545587 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:06:59.595528 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:06:59.640391 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:07:02.026869 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m03:07:02.063924 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m03:07:02.082087 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_stocks.sql
[0m03:07:02.094150 [debug] [MainThread]: 1699: static parser successfully parsed marts/stock/stock_update_status.sql
[0m03:07:02.106796 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__company.sql
[0m03:07:02.118137 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers_snapshots.sql
[0m03:07:02.129896 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m03:07:02.142073 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m03:07:02.161389 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__stock.sql
[0m03:07:02.779337 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:07:02.786600 [info ] [MainThread]: 
[0m03:07:02.789825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:07:02.793733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:07:02.822644 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:07:02.824114 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:07:02.825249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:02.844290 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m03:07:02.848167 [debug] [ThreadPool]: On list_my_database: Close
[0m03:07:02.855816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_snapshots)
[0m03:07:02.872230 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:07:02.873614 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:07:02.874943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:02.889040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:07:02.890696 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:07:02.892013 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:07:02.899250 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:07:02.902429 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:07:02.904979 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:07:02.907430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m03:07:02.913784 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:07:02.915161 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:07:02.916209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:02.928313 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:07:02.930378 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:07:02.931626 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:07:02.935966 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:07:02.939638 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:07:02.941268 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:07:02.956646 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:02.958053 [debug] [MainThread]: On master: BEGIN
[0m03:07:02.959327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:07:02.972243 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:07:02.973548 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:02.976304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:07:02.993643 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:07:02.997789 [debug] [MainThread]: On master: ROLLBACK
[0m03:07:02.999456 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:03.001084 [debug] [MainThread]: On master: BEGIN
[0m03:07:03.004093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:07:03.006385 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.008329 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:03.009836 [debug] [MainThread]: On master: COMMIT
[0m03:07:03.012117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:07:03.013919 [debug] [MainThread]: On master: Close
[0m03:07:03.015931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:03.017392 [info ] [MainThread]: 
[0m03:07:03.056167 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m03:07:03.058747 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m03:07:03.063600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_public, now model.dbt_postgres_project.stg_eltool__company)
[0m03:07:03.065671 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m03:07:03.081753 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.108376 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 03:07:03.066727 => 03:07:03.107841
[0m03:07:03.110063 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m03:07:03.221212 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.244794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.246425 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m03:07:03.247603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:03.258468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:03.259912 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.261514 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m03:07:03.267526 [debug] [Thread-1  ]: SQL status: SELECT 82 in 0.0 seconds
[0m03:07:03.282112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.283445 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m03:07:03.286964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.292307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.293764 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m03:07:03.295759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.334256 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:07:03.335901 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.337861 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:07:03.341224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:03.350579 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:07:03.352596 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m03:07:03.357508 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:03.360955 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 03:07:03.112129 => 03:07:03.360614
[0m03:07:03.363287 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m03:07:03.365232 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.30s]
[0m03:07:03.366811 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m03:07:03.368098 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:07:03.370115 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m03:07:03.372502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m03:07:03.373685 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:07:03.379875 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.406314 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 03:07:03.374475 => 03:07:03.405840
[0m03:07:03.407505 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:07:03.417012 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.444999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.447733 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m03:07:03.448934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:03.460919 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:03.462534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.464090 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m03:07:03.471729 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:07:03.477761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.479913 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m03:07:03.481611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.488888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.490122 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m03:07:03.491689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.497033 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:07:03.498287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.499281 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:07:03.503508 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:03.509172 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:07:03.513090 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m03:07:03.518157 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:03.523178 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 03:07:03.408910 => 03:07:03.522614
[0m03:07:03.525100 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m03:07:03.527678 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.15s]
[0m03:07:03.530404 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:07:03.531959 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m03:07:03.533530 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m03:07:03.535637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m03:07:03.537582 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m03:07:03.542125 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.571639 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 03:07:03.538585 => 03:07:03.571044
[0m03:07:03.572796 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m03:07:03.582590 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.617395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.619181 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m03:07:03.621148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:03.633454 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:03.634952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.636790 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m03:07:03.861429 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:07:03.869363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.871630 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m03:07:03.873827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.880396 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.881623 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m03:07:03.883177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:03.891472 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:07:03.893748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.897275 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:07:03.977501 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:03.988717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:07:03.990220 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m03:07:04.014926 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:04.019061 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 03:07:03.573897 => 03:07:04.018529
[0m03:07:04.021226 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m03:07:04.023791 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.49s]
[0m03:07:04.026788 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m03:07:04.029459 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m03:07:04.031975 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m03:07:04.034971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m03:07:04.037223 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m03:07:04.047668 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.073374 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 03:07:04.038847 => 03:07:04.072809
[0m03:07:04.074589 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m03:07:04.084764 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.107176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.108293 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m03:07:04.109139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:04.120084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:04.121494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.122558 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m03:07:04.125222 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m03:07:04.133572 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.135450 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m03:07:04.138280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.146680 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.147854 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m03:07:04.149309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.154525 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:07:04.155748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.156762 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:07:04.159041 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:04.166423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:07:04.168074 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m03:07:04.172129 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:04.175142 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 03:07:04.075917 => 03:07:04.174830
[0m03:07:04.176865 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m03:07:04.180185 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.15s]
[0m03:07:04.182025 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m03:07:04.183374 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m03:07:04.184870 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m03:07:04.187434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m03:07:04.188722 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m03:07:04.193528 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.220680 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 03:07:04.189559 => 03:07:04.219867
[0m03:07:04.222084 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m03:07:04.231639 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.257596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.258866 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m03:07:04.260671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:04.274279 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:04.275589 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.277639 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m03:07:04.335036 [debug] [Thread-1  ]: SQL status: SELECT 28003 in 0.0 seconds
[0m03:07:04.341654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.342679 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m03:07:04.345118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.350320 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.351603 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m03:07:04.353808 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.358685 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:07:04.360126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.361759 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:07:04.371658 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:04.376781 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:07:04.379123 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m03:07:04.383562 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:04.387952 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 03:07:04.223135 => 03:07:04.387684
[0m03:07:04.389441 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m03:07:04.391550 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.20s]
[0m03:07:04.394201 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m03:07:04.396730 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_orders
[0m03:07:04.399120 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m03:07:04.403467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m03:07:04.405690 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_orders
[0m03:07:04.410556 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m03:07:04.441893 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (compile): 03:07:04.406693 => 03:07:04.441488
[0m03:07:04.443288 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_orders
[0m03:07:04.452055 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m03:07:04.484808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.487396 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m03:07:04.489793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:04.501067 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:04.502703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.504880 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m03:07:04.634288 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:07:04.642279 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.644032 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:07:04.647384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.657878 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.659679 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:07:04.662778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.668384 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:07:04.670545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.672663 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:07:04.679652 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:04.685974 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:07:04.688359 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m03:07:04.693352 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:04.697537 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (execute): 03:07:04.444449 => 03:07:04.697278
[0m03:07:04.698648 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: Close
[0m03:07:04.700558 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.30s]
[0m03:07:04.703422 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_orders
[0m03:07:04.705887 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.dim_customers
[0m03:07:04.707441 [info ] [Thread-1  ]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m03:07:04.710590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m03:07:04.712585 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.dim_customers
[0m03:07:04.719730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m03:07:04.749257 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (compile): 03:07:04.714358 => 03:07:04.748848
[0m03:07:04.750351 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.dim_customers
[0m03:07:04.759061 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m03:07:04.786324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.787896 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m03:07:04.788887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:04.799306 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:04.800493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.801856 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m03:07:04.806976 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:07:04.813473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.814639 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:07:04.816164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.822441 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.823774 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:07:04.825193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:04.831091 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:07:04.832258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.833506 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:07:04.836813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:04.842397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:07:04.844012 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m03:07:04.848061 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:04.852996 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (execute): 03:07:04.751267 => 03:07:04.852370
[0m03:07:04.854581 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: Close
[0m03:07:04.856980 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.15s]
[0m03:07:04.858740 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.dim_customers
[0m03:07:04.860275 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_stocks
[0m03:07:04.862133 [info ] [Thread-1  ]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m03:07:04.864302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m03:07:04.865595 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m03:07:04.872401 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m03:07:04.908018 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 03:07:04.866571 => 03:07:04.907537
[0m03:07:04.909514 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_stocks
[0m03:07:04.923892 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m03:07:04.957258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:04.958533 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m03:07:04.959812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:04.972083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:04.973921 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:04.975304 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m03:07:05.024881 [debug] [Thread-1  ]: SQL status: SELECT 28036 in 0.0 seconds
[0m03:07:05.034975 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:05.037397 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m03:07:05.039814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:05.046120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:05.047724 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m03:07:05.050017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:05.054929 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:07:05.056432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:05.057476 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:07:05.065564 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:05.072626 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:07:05.074035 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m03:07:05.079461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:07:05.082766 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 03:07:04.911360 => 03:07:05.082506
[0m03:07:05.084178 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: Close
[0m03:07:05.087928 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.22s]
[0m03:07:05.090686 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_stocks
[0m03:07:05.092538 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stock_update_status
[0m03:07:05.094988 [info ] [Thread-1  ]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m03:07:05.097225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m03:07:05.098690 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m03:07:05.105418 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.138103 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 03:07:05.099716 => 03:07:05.137551
[0m03:07:05.139568 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stock_update_status
[0m03:07:05.181927 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.213232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.214469 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m03:07:05.215704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:05.227303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:07:05.229079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.230327 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m03:07:05.233906 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:07:05.241338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.242711 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m03:07:05.245796 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:07:05.249471 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:07:05.250624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.252273 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:07:05.256887 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:07:05.261888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:07:05.263154 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m03:07:05.264596 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:07:05.267026 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 03:07:05.140572 => 03:07:05.266785
[0m03:07:05.268857 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: Close
[0m03:07:05.272739 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:07:05.275220 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stock_update_status
[0m03:07:05.281022 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:05.282123 [debug] [MainThread]: On master: BEGIN
[0m03:07:05.283158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:07:05.297573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:07:05.299205 [debug] [MainThread]: On master: COMMIT
[0m03:07:05.301252 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:05.303428 [debug] [MainThread]: On master: COMMIT
[0m03:07:05.306190 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:07:05.308539 [debug] [MainThread]: On master: Close
[0m03:07:05.311702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:05.313819 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m03:07:05.316194 [info ] [MainThread]: 
[0m03:07:05.318639 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m03:07:05.324629 [debug] [MainThread]: Command end result
[0m03:07:05.381071 [info ] [MainThread]: 
[0m03:07:05.383054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:07:05.384778 [info ] [MainThread]: 
[0m03:07:05.386596 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:07:05.388407 [debug] [MainThread]: Command `dbt run` succeeded at 03:07:05.388248 after 6.20 seconds
[0m03:07:05.389598 [debug] [MainThread]: Flushing usage events


============================== 03:09:34.722719 | fbbf3f38-f974-4b77-a33a-293deafec197 ==============================
[0m03:09:34.722719 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:09:34.731890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:09:35.011601 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:09:35.052740 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:09:35.923914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:35.925246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:36.007925 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:09:36.011708 [info ] [MainThread]: 
[0m03:09:36.013588 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:09:36.016063 [debug] [MainThread]: Command end result
[0m03:09:36.061379 [info ] [MainThread]: 
[0m03:09:36.063012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:36.064619 [info ] [MainThread]: 
[0m03:09:36.066307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m03:09:36.068138 [debug] [MainThread]: Command `dbt seed` succeeded at 03:09:36.067918 after 1.39 seconds
[0m03:09:36.069288 [debug] [MainThread]: Flushing usage events


============================== 03:09:43.500245 | 0af05ca4-fb3a-46bb-89ea-25369e1a0b56 ==============================
[0m03:09:43.500245 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:09:43.508263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:09:43.715067 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:09:43.750977 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:09:44.619424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:44.621258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:44.686076 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:09:44.690796 [info ] [MainThread]: 
[0m03:09:44.693278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:09:44.696688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:09:44.715913 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:09:44.717114 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:09:44.718068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:44.733453 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m03:09:44.735972 [debug] [ThreadPool]: On list_my_database: Close
[0m03:09:44.740660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_public)
[0m03:09:44.751703 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:09:44.753016 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:09:44.754135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:44.766958 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.768592 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:09:44.769747 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:44.774409 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:09:44.777349 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:09:44.778956 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:09:44.781696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m03:09:44.792920 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:09:44.794426 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:09:44.796082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:44.810982 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.812691 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:09:44.814196 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:09:44.818213 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:09:44.821855 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:09:44.823684 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:09:44.833571 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:44.834816 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.836583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:44.849997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.851484 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:44.852695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:44.860121 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:09:44.863423 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:44.865370 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:44.866934 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.869987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.872222 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.874481 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:44.875881 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.877389 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:44.878446 [debug] [MainThread]: On master: Close
[0m03:09:44.880431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:44.882345 [info ] [MainThread]: 
[0m03:09:44.893932 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m03:09:44.896025 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m03:09:44.899639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now model.dbt_postgres_project.stg_eltool__company)
[0m03:09:44.901946 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m03:09:44.919044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:44.946760 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 03:09:44.903574 => 03:09:44.945482
[0m03:09:44.948939 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m03:09:45.032900 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.056936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.058066 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m03:09:45.059010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:45.069527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.071404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.073050 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m03:09:45.079710 [debug] [Thread-1  ]: SQL status: SELECT 82 in 0.0 seconds
[0m03:09:45.094324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.095481 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m03:09:45.097761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.103897 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.105436 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m03:09:45.107019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.144980 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:09:45.146466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.148212 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:09:45.151854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.162408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:09:45.164517 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m03:09:45.169879 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:45.175047 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 03:09:44.950482 => 03:09:45.174491
[0m03:09:45.176641 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m03:09:45.179964 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.28s]
[0m03:09:45.183026 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m03:09:45.184977 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:09:45.186754 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m03:09:45.189448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m03:09:45.190702 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:09:45.198835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.224170 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 03:09:45.191575 => 03:09:45.223658
[0m03:09:45.225317 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:09:45.234215 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.262066 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.264231 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m03:09:45.266726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:45.278124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.279489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.280830 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m03:09:45.287881 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:09:45.293963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.295125 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m03:09:45.297255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.304078 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.306095 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m03:09:45.308168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.312429 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:09:45.314116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.315211 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:09:45.318044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.323529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:09:45.324741 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m03:09:45.328200 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:45.332192 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 03:09:45.226243 => 03:09:45.331914
[0m03:09:45.333871 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m03:09:45.336596 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.15s]
[0m03:09:45.339013 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:09:45.340193 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m03:09:45.341435 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m03:09:45.343784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m03:09:45.345018 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m03:09:45.349952 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.381159 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 03:09:45.346234 => 03:09:45.380581
[0m03:09:45.382664 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m03:09:45.390954 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.425035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.426129 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m03:09:45.427470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:45.440222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.441505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.442868 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m03:09:45.555831 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:09:45.562254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.563906 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m03:09:45.565699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.570844 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.572161 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m03:09:45.573680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.577456 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:09:45.578533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.579795 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:09:45.596528 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.604139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:09:45.605662 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m03:09:45.610443 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:45.614283 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 03:09:45.383695 => 03:09:45.614013
[0m03:09:45.615681 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m03:09:45.618544 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.27s]
[0m03:09:45.620945 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m03:09:45.623204 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m03:09:45.625082 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m03:09:45.627513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m03:09:45.629797 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m03:09:45.695682 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.718215 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 03:09:45.632273 => 03:09:45.717815
[0m03:09:45.719354 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m03:09:45.727473 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.750936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.752038 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m03:09:45.753216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:45.763478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.764694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.765740 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m03:09:45.768690 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m03:09:45.774769 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.775920 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m03:09:45.777420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.782195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.783469 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m03:09:45.785016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.790159 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:09:45.791442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.792508 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:09:45.795470 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.800230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:09:45.801395 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m03:09:45.805262 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:45.808283 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 03:09:45.720205 => 03:09:45.807984
[0m03:09:45.809814 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m03:09:45.811742 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.18s]
[0m03:09:45.813907 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m03:09:45.815147 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m03:09:45.816354 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m03:09:45.817959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m03:09:45.818967 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m03:09:45.825415 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.849514 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 03:09:45.820483 => 03:09:45.848815
[0m03:09:45.850872 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m03:09:45.858923 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.880842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.882442 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m03:09:45.884070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:45.894139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.895364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.896522 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m03:09:45.949256 [debug] [Thread-1  ]: SQL status: SELECT 28003 in 0.0 seconds
[0m03:09:45.955254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.956462 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m03:09:45.958283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.964997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.966146 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m03:09:45.967578 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:45.972071 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:09:45.973416 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:45.974427 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:09:45.990122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.998547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:09:46.000921 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m03:09:46.010697 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:46.017621 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 03:09:45.851892 => 03:09:46.016968
[0m03:09:46.019823 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m03:09:46.024490 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.21s]
[0m03:09:46.029475 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m03:09:46.032105 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_orders
[0m03:09:46.034468 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m03:09:46.037556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m03:09:46.040711 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_orders
[0m03:09:46.051966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m03:09:46.105222 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (compile): 03:09:46.043459 => 03:09:46.104289
[0m03:09:46.108259 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_orders
[0m03:09:46.140868 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m03:09:46.169941 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.171587 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m03:09:46.173077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:46.268152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:46.270137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.272475 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m03:09:46.420243 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:09:46.429717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.431415 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:09:46.433386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.440144 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.441801 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:09:46.443883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.450221 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:09:46.451801 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.453627 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:09:46.515649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:46.523627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:09:46.525817 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m03:09:46.531376 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:46.534824 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (execute): 03:09:46.111239 => 03:09:46.534480
[0m03:09:46.536293 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: Close
[0m03:09:46.539510 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.50s]
[0m03:09:46.542707 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_orders
[0m03:09:46.545215 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.dim_customers
[0m03:09:46.547826 [info ] [Thread-1  ]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m03:09:46.550751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m03:09:46.552186 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.dim_customers
[0m03:09:46.562238 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m03:09:46.595198 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (compile): 03:09:46.554602 => 03:09:46.594472
[0m03:09:46.597128 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.dim_customers
[0m03:09:46.610048 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m03:09:46.641998 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.643471 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m03:09:46.644878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:46.659994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:46.661824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.664591 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m03:09:46.670065 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:09:46.682555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.684429 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:09:46.686662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.699080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.700547 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:09:46.702426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.709452 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:09:46.710876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.712615 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:09:46.715965 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:46.723205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:09:46.724693 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m03:09:46.728702 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:46.733435 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (execute): 03:09:46.598467 => 03:09:46.732868
[0m03:09:46.735049 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: Close
[0m03:09:46.737561 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.19s]
[0m03:09:46.741009 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.dim_customers
[0m03:09:46.742951 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_stocks
[0m03:09:46.744750 [info ] [Thread-1  ]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m03:09:46.748134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m03:09:46.750063 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m03:09:46.756969 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.786443 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 03:09:46.751185 => 03:09:46.785896
[0m03:09:46.788651 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_stocks
[0m03:09:46.801720 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.833638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.835093 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m03:09:46.836532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:46.851161 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:46.852559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.854199 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m03:09:46.929767 [debug] [Thread-1  ]: SQL status: SELECT 28036 in 0.0 seconds
[0m03:09:46.942130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.943639 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m03:09:46.945941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.953221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.955592 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m03:09:46.958700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:46.964790 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:09:46.966224 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.967753 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:09:46.976059 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:46.985576 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:09:46.987795 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m03:09:46.995037 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:09:47.000893 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 03:09:46.790088 => 03:09:47.000243
[0m03:09:47.002627 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: Close
[0m03:09:47.008708 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.26s]
[0m03:09:47.012080 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_stocks
[0m03:09:47.016223 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stock_update_status
[0m03:09:47.018478 [info ] [Thread-1  ]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m03:09:47.022601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m03:09:47.025238 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m03:09:47.034697 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.071880 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 03:09:47.027155 => 03:09:47.070919
[0m03:09:47.074867 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stock_update_status
[0m03:09:47.159106 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.195184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.197053 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m03:09:47.199024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:47.214225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:47.216646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.219207 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m03:09:47.226156 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:09:47.235104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.237037 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m03:09:47.240235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:47.245304 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:09:47.247610 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.249848 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:09:47.253250 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:47.263352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:09:47.266264 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m03:09:47.268437 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:09:47.274249 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 03:09:47.076611 => 03:09:47.273864
[0m03:09:47.276317 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: Close
[0m03:09:47.280118 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.26s]
[0m03:09:47.283145 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stock_update_status
[0m03:09:47.338715 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:47.342162 [debug] [MainThread]: On master: BEGIN
[0m03:09:47.344279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:47.361640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:47.364219 [debug] [MainThread]: On master: COMMIT
[0m03:09:47.366221 [debug] [MainThread]: Using postgres connection "master"
[0m03:09:47.368214 [debug] [MainThread]: On master: COMMIT
[0m03:09:47.371019 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:47.373297 [debug] [MainThread]: On master: Close
[0m03:09:47.376530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:47.378410 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m03:09:47.380666 [info ] [MainThread]: 
[0m03:09:47.384690 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m03:09:47.392206 [debug] [MainThread]: Command end result
[0m03:09:47.467974 [info ] [MainThread]: 
[0m03:09:47.470006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:47.472036 [info ] [MainThread]: 
[0m03:09:47.474328 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:09:47.477027 [debug] [MainThread]: Command `dbt run` succeeded at 03:09:47.476761 after 4.02 seconds
[0m03:09:47.478466 [debug] [MainThread]: Flushing usage events


============================== 03:10:59.430255 | 72681980-429d-49c7-ab5f-321b888fb8d7 ==============================
[0m03:10:59.430255 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:10:59.446648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:10:59.718780 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:10:59.769501 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:11:00.821421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:11:00.822702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:11:00.904795 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:11:00.909567 [info ] [MainThread]: 
[0m03:11:00.911949 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:11:00.914590 [debug] [MainThread]: Command end result
[0m03:11:00.963374 [info ] [MainThread]: 
[0m03:11:00.965700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:00.967983 [info ] [MainThread]: 
[0m03:11:00.970603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m03:11:00.973368 [debug] [MainThread]: Command `dbt seed` succeeded at 03:11:00.973108 after 1.60 seconds
[0m03:11:00.974706 [debug] [MainThread]: Flushing usage events


============================== 03:11:08.914282 | d545e28d-9b9d-4849-80ea-f77d7529fe0b ==============================
[0m03:11:08.914282 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:11:08.926205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:11:09.260023 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:11:09.308026 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:11:10.330877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:11:10.332300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:11:10.401581 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:11:10.406505 [info ] [MainThread]: 
[0m03:11:10.408956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:11:10.412731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:11:10.433595 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:11:10.435989 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:11:10.437403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:10.462523 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m03:11:10.465906 [debug] [ThreadPool]: On list_my_database: Close
[0m03:11:10.472070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_snapshots)
[0m03:11:10.487159 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:11:10.488664 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:11:10.490036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:10.504372 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:11:10.506152 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:11:10.507596 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:11:10.514529 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:11:10.518207 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:11:10.520676 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:11:10.523824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m03:11:10.530996 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:11:10.532442 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:11:10.534060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:10.549187 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:11:10.550989 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:11:10.552945 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:11:10.557051 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:11:10.561458 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:11:10.563099 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:11:10.586552 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:10.587928 [debug] [MainThread]: On master: BEGIN
[0m03:11:10.589095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:11:10.605802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:11:10.607481 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:10.609448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:11:10.620591 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:11:10.624530 [debug] [MainThread]: On master: ROLLBACK
[0m03:11:10.626870 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:10.628550 [debug] [MainThread]: On master: BEGIN
[0m03:11:10.630609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:11:10.632393 [debug] [MainThread]: On master: COMMIT
[0m03:11:10.634178 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:10.636591 [debug] [MainThread]: On master: COMMIT
[0m03:11:10.638291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:11:10.639575 [debug] [MainThread]: On master: Close
[0m03:11:10.641890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:10.644573 [info ] [MainThread]: 
[0m03:11:10.657194 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m03:11:10.659880 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m03:11:10.663284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_public, now model.dbt_postgres_project.stg_eltool__company)
[0m03:11:10.665087 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m03:11:10.687068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.712341 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 03:11:10.666331 => 03:11:10.711743
[0m03:11:10.713637 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m03:11:10.808395 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.840255 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.842121 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m03:11:10.844930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:10.858021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:10.859891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.861455 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m03:11:10.868052 [debug] [Thread-1  ]: SQL status: SELECT 82 in 0.0 seconds
[0m03:11:10.888463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.889808 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m03:11:10.892594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:10.901179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.903546 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m03:11:10.905289 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:10.949815 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:11:10.952244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.953839 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:11:10.956290 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:10.971479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:11:10.973001 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m03:11:10.978842 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:10.983610 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 03:11:10.714680 => 03:11:10.983000
[0m03:11:10.986259 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m03:11:10.989432 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.33s]
[0m03:11:10.993342 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m03:11:10.995886 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:11:10.997744 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m03:11:11.000319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m03:11:11.002906 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:11:11.015015 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.041488 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 03:11:11.004232 => 03:11:11.040965
[0m03:11:11.043732 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:11:11.056121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.082194 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.084161 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m03:11:11.086791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:11.099754 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:11.102963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.104746 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m03:11:11.112550 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:11:11.121031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.122539 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m03:11:11.124285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.132329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.134260 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m03:11:11.136939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.144912 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:11:11.146487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.147657 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:11:11.151020 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:11.164367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:11:11.166364 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m03:11:11.172764 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:11.178703 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 03:11:11.044946 => 03:11:11.177935
[0m03:11:11.180927 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m03:11:11.184732 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.18s]
[0m03:11:11.187108 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:11:11.188516 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m03:11:11.190108 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m03:11:11.192409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m03:11:11.194213 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m03:11:11.201264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.245919 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 03:11:11.195826 => 03:11:11.245201
[0m03:11:11.247980 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m03:11:11.263873 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.299466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.301945 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m03:11:11.303825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:11.317105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:11.319151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.320999 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m03:11:11.455196 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:11:11.463695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.464990 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m03:11:11.467283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.475830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.477858 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m03:11:11.480203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.494703 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:11:11.496183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.497772 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:11:11.527740 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:11.547938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:11:11.550590 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m03:11:11.556767 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:11.565188 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 03:11:11.249756 => 03:11:11.564347
[0m03:11:11.567642 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m03:11:11.571648 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.38s]
[0m03:11:11.574497 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m03:11:11.577559 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m03:11:11.580051 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m03:11:11.582823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m03:11:11.585795 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m03:11:11.669306 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.714184 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 03:11:11.587481 => 03:11:11.713342
[0m03:11:11.715841 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m03:11:11.733512 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.765100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.766810 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m03:11:11.769206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:11.785555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:11.787270 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.788623 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m03:11:11.792099 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m03:11:11.799177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.801158 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m03:11:11.803645 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.811251 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.813036 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m03:11:11.815542 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:11.821116 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:11:11.822545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.823736 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:11:11.826877 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:11.836314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:11:11.837676 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m03:11:11.841137 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:11.845708 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 03:11:11.717859 => 03:11:11.845223
[0m03:11:11.847120 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m03:11:11.849886 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.27s]
[0m03:11:11.853377 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m03:11:11.854880 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m03:11:11.856450 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m03:11:11.859527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m03:11:11.861657 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m03:11:11.869042 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:11.897222 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 03:11:11.863086 => 03:11:11.896684
[0m03:11:11.898550 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m03:11:11.914370 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:11.943536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:11.945285 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m03:11:11.946757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:11.960235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:11.961863 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:11.963275 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m03:11:12.074941 [debug] [Thread-1  ]: SQL status: SELECT 28003 in 0.0 seconds
[0m03:11:12.088639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:12.097523 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m03:11:12.102309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.117621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:12.120648 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m03:11:12.123381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.129728 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:11:12.131099 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:12.132380 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:11:12.146433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:12.155128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:11:12.156658 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m03:11:12.162840 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:12.166435 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 03:11:11.899695 => 03:11:12.166109
[0m03:11:12.168690 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m03:11:12.171343 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.31s]
[0m03:11:12.174398 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m03:11:12.177546 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_orders
[0m03:11:12.180221 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m03:11:12.183608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m03:11:12.186775 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_orders
[0m03:11:12.196655 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m03:11:12.230418 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (compile): 03:11:12.188457 => 03:11:12.229700
[0m03:11:12.231953 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_orders
[0m03:11:12.245149 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m03:11:12.275919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.278005 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m03:11:12.279883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:12.296419 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:12.297726 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.298942 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m03:11:12.435958 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:11:12.442522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.444726 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:11:12.446720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.456707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.458755 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:11:12.461756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.466165 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:11:12.468053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.469828 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:11:12.494408 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:12.505645 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:11:12.507687 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m03:11:12.515710 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:12.520717 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (execute): 03:11:12.233268 => 03:11:12.520159
[0m03:11:12.522321 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: Close
[0m03:11:12.525211 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.34s]
[0m03:11:12.528467 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_orders
[0m03:11:12.530562 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.dim_customers
[0m03:11:12.533338 [info ] [Thread-1  ]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m03:11:12.537229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m03:11:12.539320 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.dim_customers
[0m03:11:12.547618 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m03:11:12.575088 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (compile): 03:11:12.540716 => 03:11:12.574224
[0m03:11:12.577670 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.dim_customers
[0m03:11:12.592115 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m03:11:12.620325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.621525 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m03:11:12.622758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:12.636383 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:12.638097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.639856 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m03:11:12.647528 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:11:12.655733 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.656998 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:11:12.659999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.669763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.671118 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:11:12.672884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.682480 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:11:12.684724 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.686479 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:11:12.689418 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:12.697675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:11:12.699370 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m03:11:12.704025 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:12.707885 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (execute): 03:11:12.579168 => 03:11:12.707361
[0m03:11:12.710143 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: Close
[0m03:11:12.713098 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.18s]
[0m03:11:12.715440 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.dim_customers
[0m03:11:12.717867 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_stocks
[0m03:11:12.720316 [info ] [Thread-1  ]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m03:11:12.722538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m03:11:12.723829 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m03:11:12.731270 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.759765 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 03:11:12.724937 => 03:11:12.759189
[0m03:11:12.761283 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_stocks
[0m03:11:12.770409 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.795365 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.796547 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m03:11:12.797539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:12.809496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:12.811505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.812793 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m03:11:12.869372 [debug] [Thread-1  ]: SQL status: SELECT 28036 in 0.0 seconds
[0m03:11:12.877013 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.878790 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m03:11:12.880436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.887279 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.888732 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m03:11:12.890229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:12.897002 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:11:12.898485 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.900699 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:11:12.906975 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:12.917448 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:11:12.919976 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m03:11:12.926586 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:12.930294 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 03:11:12.762297 => 03:11:12.929961
[0m03:11:12.931905 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: Close
[0m03:11:12.936316 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.21s]
[0m03:11:12.939488 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_stocks
[0m03:11:12.942497 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stock_update_status
[0m03:11:12.945277 [info ] [Thread-1  ]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m03:11:12.947978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m03:11:12.950143 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m03:11:12.960090 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m03:11:12.990196 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 03:11:12.952383 => 03:11:12.989702
[0m03:11:12.991662 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stock_update_status
[0m03:11:13.049431 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.085717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.087255 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m03:11:13.088727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:11:13.104797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:11:13.106323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.108495 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m03:11:13.114773 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:11:13.122675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.124234 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m03:11:13.128078 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:13.136711 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:11:13.138568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.141314 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:11:13.145608 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:11:13.152357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:11:13.153734 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m03:11:13.155439 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:11:13.160630 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 03:11:12.993508 => 03:11:13.159703
[0m03:11:13.162615 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: Close
[0m03:11:13.165612 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.22s]
[0m03:11:13.168835 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stock_update_status
[0m03:11:13.180892 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:13.182991 [debug] [MainThread]: On master: BEGIN
[0m03:11:13.184899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:11:13.196496 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:11:13.197692 [debug] [MainThread]: On master: COMMIT
[0m03:11:13.198769 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:13.200011 [debug] [MainThread]: On master: COMMIT
[0m03:11:13.202343 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:11:13.203518 [debug] [MainThread]: On master: Close
[0m03:11:13.205773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:13.207170 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m03:11:13.209150 [info ] [MainThread]: 
[0m03:11:13.211643 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m03:11:13.217265 [debug] [MainThread]: Command end result
[0m03:11:13.282547 [info ] [MainThread]: 
[0m03:11:13.285851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:13.288021 [info ] [MainThread]: 
[0m03:11:13.289853 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:11:13.293319 [debug] [MainThread]: Command `dbt run` succeeded at 03:11:13.292829 after 4.43 seconds
[0m03:11:13.295240 [debug] [MainThread]: Flushing usage events


============================== 03:11:51.436533 | 45ee5d60-ecdd-460c-8574-e55e507fd0a2 ==============================
[0m03:11:51.436533 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:11:51.453704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:11:51.779506 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:11:51.842584 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:11:53.046553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:11:53.049625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:11:53.198944 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:11:53.213673 [info ] [MainThread]: 
[0m03:11:53.216685 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:11:53.219810 [debug] [MainThread]: Command end result
[0m03:11:53.301575 [info ] [MainThread]: 
[0m03:11:53.313144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:53.318556 [info ] [MainThread]: 
[0m03:11:53.322220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m03:11:53.332904 [debug] [MainThread]: Command `dbt seed` succeeded at 03:11:53.332311 after 1.96 seconds
[0m03:11:53.340005 [debug] [MainThread]: Flushing usage events


============================== 03:12:02.479739 | 86b5ef02-f592-4180-b1a6-8ae208bd2df5 ==============================
[0m03:12:02.479739 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:12:02.488815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:12:02.779180 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:12:02.823709 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7


============================== 03:12:03.324415 | c5720444-fd6c-4da8-9937-f90fcd43871b ==============================
[0m03:12:03.324415 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:12:03.341130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:12:03.569493 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:12:03.607078 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:12:03.688970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:03.690432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:03.759525 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:12:03.763725 [info ] [MainThread]: 
[0m03:12:03.765807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:03.768311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:12:03.786225 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:12:03.787505 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:12:03.788646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:03.804941 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m03:12:03.809667 [debug] [ThreadPool]: On list_my_database: Close
[0m03:12:03.817225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_public)
[0m03:12:03.831389 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:03.832656 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:12:03.833845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:03.845246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:03.846663 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:03.847778 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:12:03.851698 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:12:03.854823 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:12:03.856282 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:12:03.858536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_public, now list_my_database_snapshots)
[0m03:12:03.867337 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:03.868441 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:12:03.869782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:03.881417 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:03.882694 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:03.884056 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:12:03.888404 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:03.890755 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:12:03.892132 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:12:03.902572 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:03.903974 [debug] [MainThread]: On master: BEGIN
[0m03:12:03.905021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:03.915950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:03.917404 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:03.918875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:12:03.926017 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:03.929128 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:03.930744 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:03.931785 [debug] [MainThread]: On master: BEGIN
[0m03:12:03.933820 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:03.935056 [debug] [MainThread]: On master: COMMIT
[0m03:12:03.936068 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:03.937154 [debug] [MainThread]: On master: COMMIT
[0m03:12:03.938564 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:03.939737 [debug] [MainThread]: On master: Close
[0m03:12:03.941397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:03.943202 [info ] [MainThread]: 
[0m03:12:03.952385 [debug] [Thread-1  ]: Began running node snapshot.dbt_postgres_project.customers_snapshot
[0m03:12:03.954932 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m03:12:03.958044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now snapshot.dbt_postgres_project.customers_snapshot)
[0m03:12:03.960150 [debug] [Thread-1  ]: Began compiling node snapshot.dbt_postgres_project.customers_snapshot
[0m03:12:03.978720 [debug] [Thread-1  ]: Timing info for snapshot.dbt_postgres_project.customers_snapshot (compile): 03:12:03.961600 => 03:12:03.978316
[0m03:12:03.980642 [debug] [Thread-1  ]: Began executing node snapshot.dbt_postgres_project.customers_snapshot
[0m03:12:04.063276 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.064469 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: BEGIN
[0m03:12:04.065597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:04.076934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.078206 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.079440 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "my_database".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:04.090651 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:12:04.140179 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.141429 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp031204115058"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "my_database"."public"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "my_database"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m03:12:04.147808 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m03:12:04.153484 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.154787 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp031204115058'
        
      order by ordinal_position

  
[0m03:12:04.159450 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m03:12:04.165927 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.167808 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "my_database".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:04.172056 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:12:04.179431 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.181123 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp031204115058'
        
      order by ordinal_position

  
[0m03:12:04.184876 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m03:12:04.191010 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.192208 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "my_database".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m03:12:04.196624 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:12:04.207701 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.209035 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp031204115058'
        
      order by ordinal_position

  
[0m03:12:04.213768 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m03:12:04.223548 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.271625 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.272978 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "snapshot.dbt_postgres_project.customers_snapshot"} */

      update "my_database"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp031204115058" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "my_database"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "my_database"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "my_database"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp031204115058" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m03:12:04.277945 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m03:12:04.308898 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: COMMIT
[0m03:12:04.310678 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_postgres_project.customers_snapshot"
[0m03:12:04.312382 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: COMMIT
[0m03:12:04.315655 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:04.323550 [debug] [Thread-1  ]: Timing info for snapshot.dbt_postgres_project.customers_snapshot (execute): 03:12:03.981880 => 03:12:04.322927
[0m03:12:04.325112 [debug] [Thread-1  ]: On snapshot.dbt_postgres_project.customers_snapshot: Close
[0m03:12:04.328258 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mINSERT 0 0[0m in 0.37s]
[0m03:12:04.331557 [debug] [Thread-1  ]: Finished running node snapshot.dbt_postgres_project.customers_snapshot
[0m03:12:04.358857 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.360495 [debug] [MainThread]: On master: BEGIN
[0m03:12:04.361817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:04.375774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.377581 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.379585 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.381547 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.385497 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:04.387890 [debug] [MainThread]: On master: Close
[0m03:12:04.391233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:04.393492 [debug] [MainThread]: Connection 'snapshot.dbt_postgres_project.customers_snapshot' was properly closed.
[0m03:12:04.395424 [info ] [MainThread]: 
[0m03:12:04.398479 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m03:12:04.403347 [debug] [MainThread]: Command end result
[0m03:12:04.473923 [info ] [MainThread]: 
[0m03:12:04.477465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:04.480725 [info ] [MainThread]: 
[0m03:12:04.483928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:12:04.486668 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:12:04.486235 after 2.04 seconds
[0m03:12:04.488194 [debug] [MainThread]: Flushing usage events
[0m03:12:04.536461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:04.537621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:04.596603 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:12:04.603702 [info ] [MainThread]: 
[0m03:12:04.607599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:04.612568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:12:04.634739 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:12:04.635967 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:12:04.637070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:04.650937 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m03:12:04.655241 [debug] [ThreadPool]: On list_my_database: Close
[0m03:12:04.660470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_snapshots)
[0m03:12:04.675189 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:04.676715 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:12:04.677965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.688633 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.690096 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:04.691310 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:12:04.697774 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:04.702138 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:12:04.705952 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:12:04.710721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m03:12:04.720401 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:04.722431 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:12:04.723984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:04.736249 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.738075 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:04.740804 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:12:04.744724 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:12:04.747510 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:12:04.748879 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:12:04.760920 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.762185 [debug] [MainThread]: On master: BEGIN
[0m03:12:04.763335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:04.774336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.775527 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.776746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:12:04.783930 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:04.786883 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:04.788263 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.789300 [debug] [MainThread]: On master: BEGIN
[0m03:12:04.790716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.791783 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.792802 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:04.794035 [debug] [MainThread]: On master: COMMIT
[0m03:12:04.795265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:04.796293 [debug] [MainThread]: On master: Close
[0m03:12:04.797904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:04.799292 [info ] [MainThread]: 
[0m03:12:04.807587 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m03:12:04.808931 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m03:12:04.810617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_public, now model.dbt_postgres_project.stg_eltool__company)
[0m03:12:04.811699 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m03:12:04.824347 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.848121 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 03:12:04.812581 => 03:12:04.847495
[0m03:12:04.849390 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m03:12:04.931226 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.954132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.955320 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m03:12:04.956344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:04.966380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:04.967594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.968637 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m03:12:04.974822 [debug] [Thread-1  ]: SQL status: SELECT 82 in 0.0 seconds
[0m03:12:04.985411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.986801 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m03:12:04.988904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:04.997076 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:04.999035 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m03:12:05.000722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.038925 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:12:05.040380 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:05.041423 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:12:05.044216 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:05.052497 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:05.053754 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m03:12:05.057291 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:05.060088 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 03:12:04.850691 => 03:12:05.059829
[0m03:12:05.061377 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m03:12:05.063437 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.25s]
[0m03:12:05.065332 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m03:12:05.066746 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:05.068170 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m03:12:05.069897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m03:12:05.071294 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:05.076835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.098998 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 03:12:05.072201 => 03:12:05.098583
[0m03:12:05.100076 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:05.107217 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.141702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.146819 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m03:12:05.151733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:05.176844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:05.181371 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.185260 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m03:12:05.203147 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:12:05.222453 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.226117 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m03:12:05.232555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.247811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.250313 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m03:12:05.257642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.267922 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:12:05.271303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.275016 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:12:05.280767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:05.291763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:05.295208 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m03:12:05.301628 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:05.314950 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 03:12:05.100925 => 03:12:05.311304
[0m03:12:05.317459 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m03:12:05.324011 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.25s]
[0m03:12:05.328240 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:05.332472 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:05.335393 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m03:12:05.339638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m03:12:05.343724 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:05.357568 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.397701 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 03:12:05.346988 => 03:12:05.396840
[0m03:12:05.399912 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:05.414306 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.450406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.453199 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m03:12:05.455163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:05.468033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:05.469938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.471922 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m03:12:05.640823 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:12:05.654385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.656196 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m03:12:05.658800 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.673872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.675875 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m03:12:05.680396 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.696485 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:12:05.698637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.700286 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:12:05.723003 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:05.740006 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:05.742504 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m03:12:05.748897 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:05.753974 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 03:12:05.401584 => 03:12:05.753400
[0m03:12:05.755822 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m03:12:05.760055 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.42s]
[0m03:12:05.763947 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:05.766235 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m03:12:05.769124 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m03:12:05.772510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m03:12:05.774168 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m03:12:05.842737 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.874866 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 03:12:05.775320 => 03:12:05.874225
[0m03:12:05.876835 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m03:12:05.886660 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.907764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.908985 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m03:12:05.910401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:05.921674 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:05.922992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.924075 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m03:12:05.926932 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m03:12:05.933068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.934271 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m03:12:05.936034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.942294 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.943814 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m03:12:05.945804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:05.950212 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:12:05.951463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.953119 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:12:05.955558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:05.961108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:05.962392 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m03:12:05.965216 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:05.968856 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 03:12:05.878234 => 03:12:05.968331
[0m03:12:05.970125 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m03:12:05.972032 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.20s]
[0m03:12:05.973772 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m03:12:05.974904 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:05.976071 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m03:12:05.978102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m03:12:05.979326 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:05.984644 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.005692 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 03:12:05.980141 => 03:12:06.005249
[0m03:12:06.006994 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:06.019014 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.046424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.047641 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m03:12:06.048715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:06.059302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:06.061153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.063370 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m03:12:06.114304 [debug] [Thread-1  ]: SQL status: SELECT 28003 in 0.0 seconds
[0m03:12:06.119978 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.121186 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m03:12:06.122753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.130409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.131734 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m03:12:06.133472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.137696 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:12:06.138838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.140363 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:12:06.148787 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:06.154258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:06.155964 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m03:12:06.161732 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:06.164504 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 03:12:06.008056 => 03:12:06.164250
[0m03:12:06.165641 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m03:12:06.167678 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.19s]
[0m03:12:06.170544 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:06.173379 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_orders
[0m03:12:06.174820 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m03:12:06.177153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m03:12:06.179060 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_orders
[0m03:12:06.184511 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m03:12:06.212536 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (compile): 03:12:06.180393 => 03:12:06.211888
[0m03:12:06.213934 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_orders
[0m03:12:06.222779 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m03:12:06.254071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.255492 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m03:12:06.257017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:06.272766 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:06.274835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.276457 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m03:12:06.400677 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:12:06.410604 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.412516 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:12:06.415268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.422264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.423754 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:12:06.425396 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.430071 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:12:06.431345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.432627 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:12:06.447053 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:06.456091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:06.458037 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m03:12:06.464670 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:06.470782 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (execute): 03:12:06.214870 => 03:12:06.470127
[0m03:12:06.473068 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: Close
[0m03:12:06.476848 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.30s]
[0m03:12:06.482162 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_orders
[0m03:12:06.485169 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.dim_customers
[0m03:12:06.487929 [info ] [Thread-1  ]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m03:12:06.491999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m03:12:06.494596 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.dim_customers
[0m03:12:06.507024 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m03:12:06.545750 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (compile): 03:12:06.496534 => 03:12:06.545119
[0m03:12:06.547371 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.dim_customers
[0m03:12:06.566778 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m03:12:06.599684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.602222 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m03:12:06.604065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:06.618378 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:06.620840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.623818 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m03:12:06.630018 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:12:06.641252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.644520 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:12:06.647336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.665928 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.668484 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:12:06.672185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.684965 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:12:06.688896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.691759 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:12:06.695935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:06.705592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:06.707694 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m03:12:06.712451 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:06.718485 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (execute): 03:12:06.548734 => 03:12:06.717819
[0m03:12:06.720196 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: Close
[0m03:12:06.722564 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.23s]
[0m03:12:06.724754 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.dim_customers
[0m03:12:06.726158 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_stocks
[0m03:12:06.727751 [info ] [Thread-1  ]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m03:12:06.730720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m03:12:06.732213 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m03:12:06.738700 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.764307 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 03:12:06.733249 => 03:12:06.763430
[0m03:12:06.765933 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_stocks
[0m03:12:06.775845 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.798350 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.799991 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m03:12:06.801865 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:06.815607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:06.817090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.818588 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m03:12:06.866794 [debug] [Thread-1  ]: SQL status: SELECT 28036 in 0.0 seconds
[0m03:12:06.876880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.878830 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m03:12:06.881301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.891850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.893847 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m03:12:06.896557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:06.904398 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:12:06.906128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.908031 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:12:06.920711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:06.929620 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:06.932680 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m03:12:06.939203 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:06.944047 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 03:12:06.767031 => 03:12:06.943369
[0m03:12:06.946574 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: Close
[0m03:12:06.949698 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.22s]
[0m03:12:06.952293 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_stocks
[0m03:12:06.955231 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stock_update_status
[0m03:12:06.957947 [info ] [Thread-1  ]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m03:12:06.960959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m03:12:06.964073 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m03:12:06.971757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.000711 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 03:12:06.965529 => 03:12:07.000066
[0m03:12:07.002480 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stock_update_status
[0m03:12:07.054322 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.082610 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.083942 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m03:12:07.085236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:07.096785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:07.098147 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.099586 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m03:12:07.104292 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:12:07.111938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.113318 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m03:12:07.115479 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:07.119740 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:12:07.121313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.122652 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:12:07.125446 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:07.131845 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:07.133775 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m03:12:07.137220 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:12:07.140673 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 03:12:07.004263 => 03:12:07.140318
[0m03:12:07.141872 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: Close
[0m03:12:07.144246 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:12:07.147135 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stock_update_status
[0m03:12:07.154933 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:07.156070 [debug] [MainThread]: On master: BEGIN
[0m03:12:07.157132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:07.167350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:07.168873 [debug] [MainThread]: On master: COMMIT
[0m03:12:07.170222 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:07.171385 [debug] [MainThread]: On master: COMMIT
[0m03:12:07.173025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:07.174430 [debug] [MainThread]: On master: Close
[0m03:12:07.176520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:07.178409 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m03:12:07.180015 [info ] [MainThread]: 
[0m03:12:07.182675 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m03:12:07.187643 [debug] [MainThread]: Command end result
[0m03:12:07.230770 [info ] [MainThread]: 
[0m03:12:07.232678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:07.234384 [info ] [MainThread]: 
[0m03:12:07.236521 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:12:07.238637 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:07.238386 after 3.97 seconds
[0m03:12:07.239942 [debug] [MainThread]: Flushing usage events


============================== 03:12:23.778443 | becc251c-bd7b-4330-a6ca-fd04efdbb1f8 ==============================
[0m03:12:23.778443 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:12:23.791937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:12:24.113875 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:12:24.155482 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:12:25.070520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:25.071653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:25.133426 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:12:25.138374 [info ] [MainThread]: 
[0m03:12:25.140428 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:12:25.142892 [debug] [MainThread]: Command end result
[0m03:12:25.189294 [info ] [MainThread]: 
[0m03:12:25.191629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:25.194166 [info ] [MainThread]: 
[0m03:12:25.196528 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m03:12:25.199616 [debug] [MainThread]: Command `dbt seed` succeeded at 03:12:25.199247 after 1.47 seconds
[0m03:12:25.202318 [debug] [MainThread]: Flushing usage events


============================== 03:12:33.640034 | dc24cdb2-1174-4a1a-a3b3-7c7d0b7212f2 ==============================
[0m03:12:33.640034 [info ] [MainThread]: Running with dbt=1.5.7
[0m03:12:33.648280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m03:12:33.925877 [info ] [MainThread]: Registered adapter: postgres=1.5.7
[0m03:12:33.965717 [debug] [MainThread]: checksum: 44b8b5a9d2eaf7949279d1035184f95e7b9fe5352959954be3a97da5bf024fba, vars: {}, profile: , target: , version: 1.5.7
[0m03:12:35.262114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:35.265201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:35.395857 [info ] [MainThread]: Found 9 models, 14 tests, 1 snapshot, 0 analyses, 310 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m03:12:35.405357 [info ] [MainThread]: 
[0m03:12:35.414180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:35.423312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_database'
[0m03:12:35.471458 [debug] [ThreadPool]: Using postgres connection "list_my_database"
[0m03:12:35.473990 [debug] [ThreadPool]: On list_my_database: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database"} */

    select distinct nspname from pg_namespace
  
[0m03:12:35.476746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:35.503050 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m03:12:35.508102 [debug] [ThreadPool]: On list_my_database: Close
[0m03:12:35.516026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database, now list_my_database_snapshots)
[0m03:12:35.538277 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:35.540305 [debug] [ThreadPool]: On list_my_database_snapshots: BEGIN
[0m03:12:35.542738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:35.559726 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:35.561526 [debug] [ThreadPool]: Using postgres connection "list_my_database_snapshots"
[0m03:12:35.563031 [debug] [ThreadPool]: On list_my_database_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_snapshots"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m03:12:35.570860 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:35.577646 [debug] [ThreadPool]: On list_my_database_snapshots: ROLLBACK
[0m03:12:35.580137 [debug] [ThreadPool]: On list_my_database_snapshots: Close
[0m03:12:35.584518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_database_snapshots, now list_my_database_public)
[0m03:12:35.603159 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:35.605542 [debug] [ThreadPool]: On list_my_database_public: BEGIN
[0m03:12:35.608203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:35.631249 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:12:35.634154 [debug] [ThreadPool]: Using postgres connection "list_my_database_public"
[0m03:12:35.637169 [debug] [ThreadPool]: On list_my_database_public: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_my_database_public"} */
select
      'my_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:12:35.647402 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m03:12:35.653819 [debug] [ThreadPool]: On list_my_database_public: ROLLBACK
[0m03:12:35.656256 [debug] [ThreadPool]: On list_my_database_public: Close
[0m03:12:35.697691 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:35.700871 [debug] [MainThread]: On master: BEGIN
[0m03:12:35.703028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:35.721634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:35.723312 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:35.726040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:12:35.743825 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m03:12:35.751060 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:35.753720 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:35.756816 [debug] [MainThread]: On master: BEGIN
[0m03:12:35.761002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:35.763254 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.765943 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:35.768289 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.771240 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:35.774592 [debug] [MainThread]: On master: Close
[0m03:12:35.779107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:35.782954 [info ] [MainThread]: 
[0m03:12:35.801771 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__company
[0m03:12:35.804311 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_eltool__company ........................ [RUN]
[0m03:12:35.808141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_my_database_public, now model.dbt_postgres_project.stg_eltool__company)
[0m03:12:35.812700 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__company
[0m03:12:35.833440 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:35.880664 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (compile): 03:12:35.814709 => 03:12:35.879506
[0m03:12:35.883534 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__company
[0m03:12:36.034236 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.067759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.070098 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: BEGIN
[0m03:12:36.073031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:36.092178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:36.095794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.099661 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */

  
    

  create  table "my_database"."public"."stg_eltool__company__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
  
[0m03:12:36.113831 [debug] [Thread-1  ]: SQL status: SELECT 82 in 0.0 seconds
[0m03:12:36.148502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.150631 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m03:12:36.153600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.165690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.167845 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
alter table "my_database"."public"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m03:12:36.170754 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.244223 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:12:36.246888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.249621 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: COMMIT
[0m03:12:36.253673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:36.269188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__company"
[0m03:12:36.270676 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__company"} */
drop table if exists "my_database"."public"."stg_eltool__company__dbt_backup" cascade
[0m03:12:36.275711 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:36.281787 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__company (execute): 03:12:35.885392 => 03:12:36.280788
[0m03:12:36.284555 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__company: Close
[0m03:12:36.287645 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_eltool__company ................... [[32mSELECT 82[0m in 0.48s]
[0m03:12:36.290958 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__company
[0m03:12:36.292818 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:36.294704 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_eltool__customers_snapshots ............ [RUN]
[0m03:12:36.297882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__company, now model.dbt_postgres_project.stg_eltool__customers_snapshots)
[0m03:12:36.300226 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:36.312710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.350147 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (compile): 03:12:36.301672 => 03:12:36.349584
[0m03:12:36.352105 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:36.380199 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.420557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.423265 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: BEGIN
[0m03:12:36.425561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:36.441122 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:36.444235 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.447182 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */

  
    

  create  table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
  
[0m03:12:36.456389 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:12:36.468406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.470554 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m03:12:36.474075 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.488138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.490441 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
alter table "my_database"."public"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m03:12:36.493235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.501660 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:12:36.502880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.503976 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: COMMIT
[0m03:12:36.506897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:36.513331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__customers_snapshots"
[0m03:12:36.514769 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__customers_snapshots"} */
drop table if exists "my_database"."public"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m03:12:36.518647 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:36.522027 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__customers_snapshots (execute): 03:12:36.355788 => 03:12:36.521638
[0m03:12:36.525012 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__customers_snapshots: Close
[0m03:12:36.527935 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_eltool__customers_snapshots ....... [[32mSELECT 100[0m in 0.23s]
[0m03:12:36.530538 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__customers_snapshots
[0m03:12:36.532297 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:36.534332 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_eltool__orders ......................... [RUN]
[0m03:12:36.536627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__customers_snapshots, now model.dbt_postgres_project.stg_eltool__orders)
[0m03:12:36.537954 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:36.550181 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.579521 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (compile): 03:12:36.540894 => 03:12:36.579028
[0m03:12:36.581047 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:36.596658 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.631295 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.633097 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: BEGIN
[0m03:12:36.635235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:36.649049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:36.650681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.652018 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */

  
    

  create  table "my_database"."public"."stg_eltool__orders__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."orders"),
     renamed as (select order_id,
                        customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
  
[0m03:12:36.786069 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:12:36.794318 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.795601 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m03:12:36.797444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.805381 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.807708 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
alter table "my_database"."public"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m03:12:36.811435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:36.818178 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:12:36.819867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.821098 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: COMMIT
[0m03:12:36.859303 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:36.872494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__orders"
[0m03:12:36.874407 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__orders"} */
drop table if exists "my_database"."public"."stg_eltool__orders__dbt_backup" cascade
[0m03:12:36.880495 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:36.885594 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__orders (execute): 03:12:36.582277 => 03:12:36.885086
[0m03:12:36.887461 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__orders: Close
[0m03:12:36.891047 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_eltool__orders .................... [[32mSELECT 99441[0m in 0.35s]
[0m03:12:36.893405 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__orders
[0m03:12:36.894888 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__state
[0m03:12:36.896654 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_eltool__state .......................... [RUN]
[0m03:12:36.899099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__orders, now model.dbt_postgres_project.stg_eltool__state)
[0m03:12:36.900503 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__state
[0m03:12:36.969419 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:36.997816 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (compile): 03:12:36.901455 => 03:12:36.996928
[0m03:12:37.000214 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__state
[0m03:12:37.011344 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.035347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.036744 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: BEGIN
[0m03:12:37.037977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:37.051315 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:37.052999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.054823 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */

  
    

  create  table "my_database"."public"."stg_eltool__state__dbt_tmp"
  
  
    as
  
  (
    with source as (select *
                from "my_database"."public"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
  
[0m03:12:37.058291 [debug] [Thread-1  ]: SQL status: SELECT 27 in 0.0 seconds
[0m03:12:37.065175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.066659 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m03:12:37.068778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.077619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.079203 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
alter table "my_database"."public"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m03:12:37.082461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.087587 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:12:37.089237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.090948 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: COMMIT
[0m03:12:37.093542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:37.099723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__state"
[0m03:12:37.101206 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__state"} */
drop table if exists "my_database"."public"."stg_eltool__state__dbt_backup" cascade
[0m03:12:37.104683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:37.109269 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__state (execute): 03:12:37.001791 => 03:12:37.108899
[0m03:12:37.110593 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__state: Close
[0m03:12:37.112928 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_eltool__state ..................... [[32mSELECT 27[0m in 0.21s]
[0m03:12:37.115275 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__state
[0m03:12:37.117179 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:37.118999 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_eltool__stock .......................... [RUN]
[0m03:12:37.121102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__state, now model.dbt_postgres_project.stg_eltool__stock)
[0m03:12:37.122706 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:37.128611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.158159 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (compile): 03:12:37.124008 => 03:12:37.157177
[0m03:12:37.159654 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:37.169367 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.197937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.200101 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: BEGIN
[0m03:12:37.201703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:37.215085 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:37.216738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.218471 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */

  
    

  create  table "my_database"."public"."stg_eltool__stock__dbt_tmp"
  
  
    as
  
  (
    with source as (select DISTINCT *
                from "my_database"."public"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
  
[0m03:12:37.279834 [debug] [Thread-1  ]: SQL status: SELECT 28003 in 0.0 seconds
[0m03:12:37.287069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.288786 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m03:12:37.291273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.300041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.301443 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
alter table "my_database"."public"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m03:12:37.303191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.308798 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:12:37.310112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.311363 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: COMMIT
[0m03:12:37.327399 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:37.336234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stg_eltool__stock"
[0m03:12:37.337722 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stg_eltool__stock"} */
drop table if exists "my_database"."public"."stg_eltool__stock__dbt_backup" cascade
[0m03:12:37.343524 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:37.349469 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stg_eltool__stock (execute): 03:12:37.160727 => 03:12:37.348672
[0m03:12:37.350980 [debug] [Thread-1  ]: On model.dbt_postgres_project.stg_eltool__stock: Close
[0m03:12:37.353731 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_eltool__stock ..................... [[32mSELECT 28003[0m in 0.23s]
[0m03:12:37.356788 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stg_eltool__stock
[0m03:12:37.358998 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_orders
[0m03:12:37.360872 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fact_orders ................................ [RUN]
[0m03:12:37.363607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.stg_eltool__stock, now model.dbt_postgres_project.fact_orders)
[0m03:12:37.365360 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_orders
[0m03:12:37.371598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_orders"
[0m03:12:37.399515 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (compile): 03:12:37.366617 => 03:12:37.399031
[0m03:12:37.400804 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_orders
[0m03:12:37.414344 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_orders"
[0m03:12:37.439456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.441428 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: BEGIN
[0m03:12:37.442776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:37.453752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:37.455594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.457575 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */

  
    

  create  table "my_database"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "my_database"."public"."stg_eltool__orders"
)
select * from orders
  );
  
[0m03:12:37.569959 [debug] [Thread-1  ]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:12:37.577311 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.578563 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:12:37.580310 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.590693 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.592120 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
alter table "my_database"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:12:37.593716 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.599919 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:12:37.601132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.602111 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: COMMIT
[0m03:12:37.619265 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:37.627262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_orders"
[0m03:12:37.629031 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_orders"} */
drop table if exists "my_database"."public"."fact_orders__dbt_backup" cascade
[0m03:12:37.640038 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:37.644577 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_orders (execute): 03:12:37.401808 => 03:12:37.644134
[0m03:12:37.646242 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_orders: Close
[0m03:12:37.649695 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 0.29s]
[0m03:12:37.651947 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_orders
[0m03:12:37.653601 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.dim_customers
[0m03:12:37.655750 [info ] [Thread-1  ]: 7 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m03:12:37.659630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_orders, now model.dbt_postgres_project.dim_customers)
[0m03:12:37.661148 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.dim_customers
[0m03:12:37.667322 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.dim_customers"
[0m03:12:37.693943 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (compile): 03:12:37.662218 => 03:12:37.693439
[0m03:12:37.695375 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.dim_customers
[0m03:12:37.704625 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.dim_customers"
[0m03:12:37.730967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.732338 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: BEGIN
[0m03:12:37.733670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:37.744361 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:37.745775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.747080 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */

  
    

  create  table "my_database"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "my_database"."public"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "my_database"."public"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m03:12:37.751323 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m03:12:37.758021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.759282 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:12:37.760839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.768258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.770056 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
alter table "my_database"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:12:37.772249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.777620 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:12:37.778865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.780125 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: COMMIT
[0m03:12:37.783304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:37.788585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.dim_customers"
[0m03:12:37.790393 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.dim_customers"} */
drop table if exists "my_database"."public"."dim_customers__dbt_backup" cascade
[0m03:12:37.794088 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:37.798301 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.dim_customers (execute): 03:12:37.696453 => 03:12:37.797464
[0m03:12:37.800357 [debug] [Thread-1  ]: On model.dbt_postgres_project.dim_customers: Close
[0m03:12:37.802606 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 100[0m in 0.14s]
[0m03:12:37.804639 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.dim_customers
[0m03:12:37.806914 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.fact_stocks
[0m03:12:37.809220 [info ] [Thread-1  ]: 8 of 9 START sql table model public.fact_stocks ................................ [RUN]
[0m03:12:37.811177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.dim_customers, now model.dbt_postgres_project.fact_stocks)
[0m03:12:37.812563 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.fact_stocks
[0m03:12:37.819423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.849355 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (compile): 03:12:37.813728 => 03:12:37.848770
[0m03:12:37.850896 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.fact_stocks
[0m03:12:37.861036 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.890134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.891861 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: BEGIN
[0m03:12:37.893271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:37.903589 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:37.905104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.906754 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */

  
    

  create  table "my_database"."public"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "my_database"."public"."stg_eltool__stock"
    ),
     company as (
         select *
         from "my_database"."public"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m03:12:37.961132 [debug] [Thread-1  ]: SQL status: SELECT 28036 in 0.0 seconds
[0m03:12:37.968306 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.969647 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m03:12:37.971729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.978048 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.979795 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
alter table "my_database"."public"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m03:12:37.982347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:37.987653 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:12:37.989400 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:37.991241 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: COMMIT
[0m03:12:37.998649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:38.005845 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.fact_stocks"
[0m03:12:38.008117 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.fact_stocks"} */
drop table if exists "my_database"."public"."fact_stocks__dbt_backup" cascade
[0m03:12:38.014161 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:38.021190 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.fact_stocks (execute): 03:12:37.851896 => 03:12:38.020715
[0m03:12:38.023788 [debug] [Thread-1  ]: On model.dbt_postgres_project.fact_stocks: Close
[0m03:12:38.027446 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.fact_stocks ........................... [[32mSELECT 28036[0m in 0.22s]
[0m03:12:38.030884 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.fact_stocks
[0m03:12:38.034432 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.stock_update_status
[0m03:12:38.036130 [info ] [Thread-1  ]: 9 of 9 START sql view model public.stock_update_status ......................... [RUN]
[0m03:12:38.038716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_project.fact_stocks, now model.dbt_postgres_project.stock_update_status)
[0m03:12:38.040851 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.stock_update_status
[0m03:12:38.047424 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.075971 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (compile): 03:12:38.042269 => 03:12:38.075336
[0m03:12:38.077334 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.stock_update_status
[0m03:12:38.133192 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.156493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.157758 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: BEGIN
[0m03:12:38.158879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:38.170577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:12:38.172450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.174602 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */

  create view "my_database"."public"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      ROW_NUMBER() OVER (PARTITION BY ticker ORDER BY date desc) AS rownum
               from "my_database"."public"."fact_stocks")
select * from (
    select a.id,
          a.ticker,
          a.name,
          a.date,
          a.open,
          a.high,
          a.low,
          a.close,
          a.volume,
          a.rownum,
          DENSE_RANK() OVER (PARTITION BY a.ticker ORDER BY a.rownum desc) AS ranking
   from stock a
   ) b
   order by b.ranking asc, b.ticker asc
  );
[0m03:12:38.179687 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:12:38.187080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.188665 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
alter table "my_database"."public"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m03:12:38.191684 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:38.196122 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:12:38.198001 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.199753 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: COMMIT
[0m03:12:38.202752 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:12:38.209457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.stock_update_status"
[0m03:12:38.210774 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.7", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.stock_update_status"} */
drop view if exists "my_database"."public"."stock_update_status__dbt_backup" cascade
[0m03:12:38.212292 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:12:38.215666 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_project.stock_update_status (execute): 03:12:38.078332 => 03:12:38.215358
[0m03:12:38.217013 [debug] [Thread-1  ]: On model.dbt_postgres_project.stock_update_status: Close
[0m03:12:38.219158 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.stock_update_status .................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:12:38.220945 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.stock_update_status
[0m03:12:38.289908 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:38.291531 [debug] [MainThread]: On master: BEGIN
[0m03:12:38.292618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:38.303131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:38.304435 [debug] [MainThread]: On master: COMMIT
[0m03:12:38.305853 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:38.308072 [debug] [MainThread]: On master: COMMIT
[0m03:12:38.309635 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:38.310810 [debug] [MainThread]: On master: Close
[0m03:12:38.312427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:38.313935 [debug] [MainThread]: Connection 'model.dbt_postgres_project.stock_update_status' was properly closed.
[0m03:12:38.316023 [info ] [MainThread]: 
[0m03:12:38.317900 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m03:12:38.321782 [debug] [MainThread]: Command end result
[0m03:12:38.365225 [info ] [MainThread]: 
[0m03:12:38.368205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:38.370082 [info ] [MainThread]: 
[0m03:12:38.372828 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:12:38.375848 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:38.375599 after 4.78 seconds
[0m03:12:38.377140 [debug] [MainThread]: Flushing usage events
